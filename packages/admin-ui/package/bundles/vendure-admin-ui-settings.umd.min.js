!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@vendure/admin-ui/core"),require("rxjs/operators"),require("@angular/forms"),require("@angular/router"),require("@biesbjerg/ngx-translate-extract-marker"),require("@vendure/common/lib/shared-constants"),require("rxjs"),require("@vendure/common/lib/normalize-string"),require("@vendure/common/lib/unique")):"function"==typeof define&&define.amd?define("@vendure/admin-ui/settings",["exports","@angular/core","@vendure/admin-ui/core","rxjs/operators","@angular/forms","@angular/router","@biesbjerg/ngx-translate-extract-marker","@vendure/common/lib/shared-constants","rxjs","@vendure/common/lib/normalize-string","@vendure/common/lib/unique"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).vendure=e.vendure||{},e.vendure["admin-ui"]=e.vendure["admin-ui"]||{},e.vendure["admin-ui"].settings={}),e.ng.core,e.vendure["admin-ui"].core,e.rxjs.operators,e.ng.forms,e.ng.router,e.ngxTranslateExtractMarker,e.sharedConstants,e.rxjs,e.normalizeString,e.unique)}(this,(function(e,t,n,r,a,o,i,s,l,c,d){"use strict";var m=function(){function e(e){this.dataService=e,this.currentMembers=[],this.selectedMemberIds=[]}return e.prototype.ngOnInit=function(){var e=this.currentMembers.map((function(e){return e.id}));this.availableCountries$=this.dataService.settings.getCountries(999).mapStream((function(e){return e.countries.items})).pipe(r.map((function(t){return t.filter((function(t){return!e.includes(t.id)}))})))},e.prototype.cancel=function(){this.resolveWith()},e.prototype.add=function(){this.resolveWith(this.selectedMemberIds)},e}();m.decorators=[{type:t.Component,args:[{selector:"vdr-add-country-to-zone-dialog",template:'<ng-template vdrDialogTitle>{{ \'settings.add-countries-to-zone\' | translate: { zoneName: zoneName } }}</ng-template>\n\n<vdr-zone-member-list\n    [members]="availableCountries$ | async"\n    [selectedMemberIds]="selectedMemberIds"\n    (selectionChange)="selectedMemberIds = $event"\n>\n</vdr-zone-member-list>\n\n<ng-template vdrDialogButtons>\n    <button type="button" class="btn" (click)="cancel()">{{ \'common.cancel\' | translate }}</button>\n    <button type="submit" (click)="add()" [disabled]="!selectedMemberIds.length" class="btn btn-primary">\n        {{ \'settings.add-countries-to-zone\' | translate: { zoneName: zoneName } }}\n    </button>\n</ng-template>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],m.ctorParameters=function(){return[{type:n.DataService}]};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}Object.create;function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}Object.create;var h=function(e){function t(t,n,r,o,i,s,l){var c=e.call(this,n,t,r,i)||this;return c.changeDetector=o,c.dataService=i,c.formBuilder=s,c.notificationService=l,c.selectedRoles=[],c.selectedRolePermissions={},c.selectedChannelId=null,c.customFields=c.getCustomFieldConfig("Administrator"),c.detailForm=c.formBuilder.group({emailAddress:["",a.Validators.required],firstName:["",a.Validators.required],lastName:["",a.Validators.required],password:[""],roles:[[]],customFields:c.formBuilder.group(c.customFields.reduce((function(e,t){var n;return Object.assign(Object.assign({},e),((n={})[t.name]="",n))}),{}))}),c}return p(t,e),t.prototype.getAvailableChannels=function(){return Object.values(this.selectedRolePermissions)},t.prototype.ngOnInit=function(){var e=this;this.init(),this.administrator$=this.entity$,this.allRoles$=this.dataService.administrator.getRoles(999).mapStream((function(e){return e.roles.items.filter((function(e){return e.code!==s.CUSTOMER_ROLE_CODE}))})),this.dataService.client.userStatus().single$.subscribe((function(t){if(!t.userStatus.permissions.includes(n.Permission.UpdateAdministrator)){var r=e.detailForm.get("roles");r&&r.disable()}})),this.permissionDefinitions=this.serverConfigService.getPermissionDefinitions()},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.customFieldIsSet=function(e){return!!this.detailForm.get(["customFields",e])},t.prototype.rolesChanged=function(e){this.buildPermissionsMap()},t.prototype.getPermissionsForSelectedChannel=function(){function e(e){return Object.entries(e).filter((function(e){var t=f(e,2);t[0];return t[1]})).map((function(e){var t=f(e,2),n=t[0];t[1];return n}))}if(this.selectedChannelId&&this.selectedRolePermissions[this.selectedChannelId])return e(this.selectedRolePermissions[this.selectedChannelId].permissions);var t=Object.values(this.selectedRolePermissions);return 0<t.length?(this.selectedChannelId=t[0].channelId,e(t[0].permissions)):[]},t.prototype.create=function(){var e=this,t=this.detailForm.value,n={emailAddress:t.emailAddress,firstName:t.firstName,lastName:t.lastName,password:t.password,customFields:t.customFields,roleIds:t.roles.map((function(e){return e.id}))};this.dataService.administrator.createAdministrator(n).subscribe((function(t){e.notificationService.success(i.marker("common.notify-create-success"),{entity:"Administrator"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createAdministrator.id],{relativeTo:e.route})}),(function(t){e.notificationService.error(i.marker("common.notify-create-error"),{entity:"Administrator"})}))},t.prototype.save=function(){var e=this;this.administrator$.pipe(r.take(1),r.mergeMap((function(t){var n=t.id,r=e.detailForm.value,a={id:n,emailAddress:r.emailAddress,firstName:r.firstName,lastName:r.lastName,password:r.password,customFields:r.customFields,roleIds:r.roles.map((function(e){return e.id}))};return e.dataService.administrator.updateAdministrator(a)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-update-success"),{entity:"Administrator"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck()}),(function(t){e.notificationService.error(i.marker("common.notify-update-error"),{entity:"Administrator"})}))},t.prototype.setFormValues=function(e,t){var n,r;if(this.detailForm.patchValue({emailAddress:e.emailAddress,firstName:e.firstName,lastName:e.lastName,roles:e.user.roles}),this.customFields.length){var o=this.detailForm.get("customFields");try{for(var i=v(this.customFields),s=i.next();!s.done;s=i.next()){var l=s.value.name,c=e.customFields[l],d=o.get(l);d&&d.patchValue(c)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}var m=this.detailForm.get("password");m&&(e.id?m.setValidators([]):m.setValidators([a.Validators.required])),this.buildPermissionsMap()},t.prototype.buildPermissionsMap=function(){var e,t,n,r,a,o,i,s,l=this.detailForm.get("roles");if(l){var c=l.value,d=new Map,m=new Map;try{for(var u=v(c),p=u.next();!p.done;p=u.next()){var f=p.value,g=function(e){var t=d.get(e.id)||new Set;f.permissions.forEach((function(e){return t.add(e)})),d.set(e.id,t),m.set(e.id,e.code)};try{for(var h=(n=void 0,v(f.channels)),b=h.next();!b.done;b=h.next()){g(b.value)}}catch(e){n={error:e}}finally{try{b&&!b.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{p&&!p.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}this.selectedRolePermissions={};try{for(var y=v(Array.from(d.keys())),C=y.next();!C.done;C=y.next()){var S=C.value,k=d.get(S),D={};try{for(var P=(i=void 0,v(this.serverConfigService.getPermissionDefinitions())),F=P.next();!F.done;F=P.next()){var I=F.value;D[I.name]=k.has(I.name)}}catch(e){i={error:e}}finally{try{F&&!F.done&&(s=P.return)&&s.call(P)}finally{if(i)throw i.error}}this.selectedRolePermissions[S]={channelId:S,channelCode:m.get(S),permissions:D}}}catch(e){a={error:e}}finally{try{C&&!C.done&&(o=y.return)&&o.call(y)}finally{if(a)throw a.error}}}},t}(n.BaseDetailComponent);h.decorators=[{type:t.Component,args:[{selector:"vdr-admin-detail",template:'<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]="entity$ | async"></vdr-entity-info>\n    </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="administrator-detail"></vdr-action-bar-items>\n        <button\n            class="btn btn-primary"\n            *ngIf="isNew$ | async; else updateButton"\n            (click)="create()"\n            [disabled]="detailForm.invalid || detailForm.pristine"\n        >\n            {{ \'common.create\' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class="btn btn-primary"\n                (click)="save()"\n                *vdrIfPermissions="\'UpdateAdministrator\'"\n                [disabled]="detailForm.invalid || detailForm.pristine"\n            >\n                {{ \'common.update\' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class="form" [formGroup]="detailForm">\n    <vdr-form-field [label]="\'settings.email-address\' | translate" for="emailAddress">\n        <input\n            id="emailAddress"\n            type="text"\n            formControlName="emailAddress"\n            [readonly]="!(\'UpdateAdministrator\' | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.first-name\' | translate" for="firstName">\n        <input\n            id="firstName"\n            type="text"\n            formControlName="firstName"\n            [readonly]="!(\'UpdateAdministrator\' | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.last-name\' | translate" for="lastName">\n        <input\n            id="lastName"\n            type="text"\n            formControlName="lastName"\n            [readonly]="!(\'UpdateAdministrator\' | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-form-field *ngIf="isNew$ | async" [label]="\'settings.password\' | translate" for="password">\n        <input id="password" type="password" formControlName="password" />\n    </vdr-form-field>\n    <vdr-form-field\n        *ngIf="!(isNew$ | async) && (\'UpdateAdministrator\' | hasPermission)"\n        [label]="\'settings.password\' | translate"\n        for="password"\n        [readOnlyToggle]="true"\n    >\n        <input id="password" type="password" formControlName="password" />\n    </vdr-form-field>\n    <section formGroupName="customFields" *ngIf="customFields.length">\n        <label>{{ \'common.custom-fields\' | translate }}</label>\n        <ng-container *ngFor="let customField of customFields">\n            <vdr-custom-field-control\n                *ngIf="customFieldIsSet(customField.name)"\n                entityName="Administrator"\n                [customFieldsFormGroup]="detailForm.get(\'customFields\')"\n                [customField]="customField"\n            ></vdr-custom-field-control>\n        </ng-container>\n    </section>\n    <label class="clr-control-label">{{ \'settings.roles\' | translate }}</label>\n    <ng-select\n        [items]="allRoles$ | async"\n        [multiple]="true"\n        [hideSelected]="true"\n        formControlName="roles"\n        (change)="rolesChanged($event)"\n        bindLabel="description"\n    ></ng-select>\n\n    <ul class="nav" role="tablist">\n        <li role="presentation" class="nav-item" *ngFor="let channel of getAvailableChannels()">\n            <button\n                [id]="channel.channelId"\n                (click)="selectedChannelId = channel.channelId"\n                class="btn btn-link nav-link"\n                [class.active]="selectedChannelId === channel.channelId"\n                [attr.aria-selected]="selectedChannelId === channel.channelId"\n                type="button"\n            >\n                {{ channel.channelCode | channelCodeToLabel | translate }}\n            </button>\n        </li>\n    </ul>\n    <vdr-permission-grid\n        [activePermissions]="getPermissionsForSelectedChannel()"\n        [permissionDefinitions]="permissionDefinitions"\n        [readonly]="true"\n    ></vdr-permission-grid>\n</form>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],h.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute},{type:n.ServerConfigService},{type:t.ChangeDetectorRef},{type:n.DataService},{type:a.FormBuilder},{type:n.NotificationService}]};var b=function(e){function t(t,n,r,a,o){var i=e.call(this,n,r)||this;return i.dataService=t,i.modalService=a,i.notificationService=o,e.prototype.setQueryFn.call(i,(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=i.dataService.administrator).getAdministrators.apply(e,g(t))}),(function(e){return e.administrators})),i}return p(t,e),t.prototype.deleteAdministrator=function(e){var t=this;return this.modalService.dialog({title:i.marker("catalog.confirm-delete-administrator"),body:e.firstName+" "+e.lastName,buttons:[{type:"secondary",label:i.marker("common.cancel")},{type:"danger",label:i.marker("common.delete"),returnValue:!0}]}).pipe(r.switchMap((function(n){return n?t.dataService.administrator.deleteAdministrator(e.id):l.EMPTY}))).subscribe((function(){t.notificationService.success(i.marker("common.notify-delete-success"),{entity:"Administrator"}),t.refresh()}),(function(e){t.notificationService.error(i.marker("common.notify-delete-error"),{entity:"Administrator"})}))},t}(n.BaseListComponent);b.decorators=[{type:t.Component,args:[{selector:"vdr-administrator-list",template:'<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="administrator-list"></vdr-action-bar-items>\n        <a class="btn btn-primary" [routerLink]="[\'./create\']" *vdrIfPermissions="\'CreateAdministrator\'">\n            <clr-icon shape="plus"></clr-icon>\n            {{ \'admin.create-new-administrator\' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]="items$ | async"\n    [itemsPerPage]="itemsPerPage$ | async"\n    [totalItems]="totalItems$ | async"\n    [currentPage]="currentPage$ | async"\n    (pageChange)="setPageNumber($event)"\n    (itemsPerPageChange)="setItemsPerPage($event)"\n>\n    <vdr-dt-column>{{ \'settings.first-name\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'settings.last-name\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'settings.email-address\' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-administrator="item">\n        <td class="left align-middle">{{ administrator.firstName }}</td>\n        <td class="left align-middle">{{ administrator.lastName }}</td>\n        <td class="left align-middle">{{ administrator.emailAddress }}</td>\n        <td class="right align-middle">\n            <vdr-table-row-action\n                iconShape="edit"\n                [label]="\'common.edit\' | translate"\n                [linkTo]="[\'./\', administrator.id]"\n            ></vdr-table-row-action>\n        </td>\n        <td>\n            <vdr-dropdown>\n                <button type="button" class="btn btn-link btn-sm" vdrDropdownTrigger>\n                    {{ \'common.actions\' | translate }}\n                    <clr-icon shape="caret down"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition="bottom-right">\n                    <button\n                        type="button"\n                        class="delete-button"\n                        (click)="deleteAdministrator(administrator)"\n                        [disabled]="!(\'DeleteAdministrator\' | hasPermission)"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape="trash" class="is-danger"></clr-icon>\n                        {{ \'common.delete\' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n',styles:[""]}]}],b.ctorParameters=function(){return[{type:n.DataService},{type:o.Router},{type:o.ActivatedRoute},{type:n.ModalService},{type:n.NotificationService}]};var y=function(e){function t(t,r,o,i,s,l,c){var d=e.call(this,r,t,o,s)||this;return d.serverConfigService=o,d.changeDetector=i,d.dataService=s,d.formBuilder=l,d.notificationService=c,d.currencyCodes=Object.values(n.CurrencyCode),d.updatePermission=[n.Permission.SuperAdmin,n.Permission.UpdateChannel,n.Permission.CreateChannel],d.customFields=d.getCustomFieldConfig("Channel"),d.detailForm=d.formBuilder.group({code:["",a.Validators.required],token:["",a.Validators.required],pricesIncludeTax:[!1],currencyCode:[""],defaultShippingZoneId:["",a.Validators.required],defaultLanguageCode:[],defaultTaxZoneId:["",a.Validators.required],customFields:d.formBuilder.group(d.customFields.reduce((function(e,t){var n;return Object.assign(Object.assign({},e),((n={})[t.name]="",n))}),{}))}),d}return p(t,e),t.prototype.ngOnInit=function(){this.init(),this.zones$=this.dataService.settings.getZones().mapSingle((function(e){return e.zones})),this.availableLanguageCodes$=this.serverConfigService.getAvailableLanguages()},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.customFieldIsSet=function(e){return!!this.detailForm.get(["customFields",e])},t.prototype.saveButtonEnabled=function(){return this.detailForm.dirty&&this.detailForm.valid},t.prototype.create=function(){var e=this;if(this.detailForm.dirty){var t=this.detailForm.value,n={code:t.code,token:t.token,defaultLanguageCode:t.defaultLanguageCode,pricesIncludeTax:t.pricesIncludeTax,currencyCode:t.currencyCode,defaultShippingZoneId:t.defaultShippingZoneId,defaultTaxZoneId:t.defaultTaxZoneId,customFields:t.customFields};this.dataService.settings.createChannel(n).pipe(r.mergeMap((function(t){var n=t.createChannel;return e.dataService.auth.currentUser().single$.pipe(r.map((function(e){return{me:e.me,createChannel:n}})))})),r.mergeMap((function(t){var n=t.me,a=t.createChannel;return e.dataService.client.updateUserChannels(n.channels).pipe(r.map((function(){return a})))}))).subscribe((function(t){switch(t.__typename){case"Channel":e.notificationService.success(i.marker("common.notify-create-success"),{entity:"Channel"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.id],{relativeTo:e.route});break;case"LanguageNotAvailableError":e.notificationService.error(t.message)}}))}},t.prototype.save=function(){var e=this;if(this.detailForm.dirty){var t=this.detailForm.value;this.entity$.pipe(r.take(1),r.mergeMap((function(n){var r={id:n.id,code:t.code,pricesIncludeTax:t.pricesIncludeTax,currencyCode:t.currencyCode,defaultShippingZoneId:t.defaultShippingZoneId,defaultLanguageCode:t.defaultLanguageCode,defaultTaxZoneId:t.defaultTaxZoneId,customFields:t.customFields};return e.dataService.settings.updateChannel(r)}))).subscribe((function(t){var n=t.updateChannel;switch(n.__typename){case"Channel":e.notificationService.success(i.marker("common.notify-update-success"),{entity:"Channel"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck();break;case"LanguageNotAvailableError":e.notificationService.error(n.message)}}))}},t.prototype.setFormValues=function(e,t){var n,r;if(this.detailForm.patchValue({code:e.code,token:e.token||this.generateToken(),pricesIncludeTax:e.pricesIncludeTax,currencyCode:e.currencyCode,defaultShippingZoneId:e.defaultShippingZone?e.defaultShippingZone.id:"",defaultLanguageCode:e.defaultLanguageCode,defaultTaxZoneId:e.defaultTaxZone?e.defaultTaxZone.id:""}),this.customFields.length){var a=this.detailForm.get("customFields");try{for(var o=v(this.customFields),i=o.next();!i.done;i=o.next()){var l=i.value.name,c=e.customFields[l],d=a.get(l);d&&d.patchValue(c)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}if(e.code===s.DEFAULT_CHANNEL_CODE){var m=this.detailForm.get("code");m&&m.disable()}},t.prototype.generateToken=function(){var e=function(){return Math.random().toString(36).substr(3,10)};return""+e()+e()},t}(n.BaseDetailComponent);y.decorators=[{type:t.Component,args:[{selector:"vdr-channel-detail",template:'<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]="entity$ | async"></vdr-entity-info>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="channel-detail"></vdr-action-bar-items>\n        <button\n            class="btn btn-primary"\n            *ngIf="isNew$ | async; else updateButton"\n            (click)="create()"\n            [disabled]="!saveButtonEnabled()"\n        >\n            {{ \'common.create\' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class="btn btn-primary"\n                (click)="save()"\n                *vdrIfPermissions="[\'SuperAdmin\', \'UpdateChannel\']"\n                [disabled]="!saveButtonEnabled()"\n            >\n                {{ \'common.update\' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class="form" [formGroup]="detailForm">\n    <vdr-form-field [label]="\'common.code\' | translate" for="code">\n        <input id="code" type="text" [readonly]="!(updatePermission | hasPermission)" formControlName="code" />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.channel-token\' | translate" for="token">\n        <input id="token" type="text" [readonly]="!(updatePermission | hasPermission)" formControlName="token" />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.currency\' | translate" for="defaultTaxZoneId">\n        <select\n            clrSelect\n            name="currencyCode"\n            formControlName="currencyCode"\n            [vdrDisabled]="!(updatePermission | hasPermission)"\n        >\n            <option *ngFor="let code of currencyCodes" [value]="code">{{ code | localeCurrencyName }}</option>\n        </select>\n    </vdr-form-field>\n    <vdr-form-field [label]="\'common.default-language\' | translate" for="defaultLanguage">\n        <select\n            clrSelect\n            name="defaultLanguageCode"\n            formControlName="defaultLanguageCode"\n            [vdrDisabled]="!(updatePermission | hasPermission)"\n        >\n            <option *ngFor="let languageCode of availableLanguageCodes$ | async" [value]="languageCode">\n                {{ \'lang.\' + languageCode | translate }} ({{ languageCode | uppercase }})\n            </option>\n        </select>\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.prices-include-tax\' | translate" for="pricesIncludeTax">\n        <clr-toggle-wrapper>\n            <input\n                type="checkbox"\n                clrToggle\n                id="pricesIncludeTax"\n                formControlName="pricesIncludeTax"\n                [vdrDisabled]="!(updatePermission | hasPermission)"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.default-tax-zone\' | translate" for="defaultTaxZoneId">\n        <select\n            clrSelect\n            name="defaultTaxZoneId"\n            formControlName="defaultTaxZoneId"\n            [vdrDisabled]="!(updatePermission | hasPermission)"\n        >\n            <option *ngFor="let zone of zones$ | async" [value]="zone.id">{{ zone.name }}</option>\n        </select>\n    </vdr-form-field>\n    <clr-alert\n        *ngIf="detailForm.value.code && !detailForm.value.defaultTaxZoneId"\n        clrAlertType="danger"\n        [clrAlertClosable]="false"\n    >\n        <clr-alert-item>\n            <span class="alert-text">\n                {{ \'error.no-default-tax-zone-set\' | translate }}\n            </span>\n        </clr-alert-item>\n    </clr-alert>\n\n    <vdr-form-field [label]="\'settings.default-shipping-zone\' | translate" for="defaultShippingZoneId">\n        <select\n            clrSelect\n            name="defaultShippingZoneId"\n            formControlName="defaultShippingZoneId"\n            [vdrDisabled]="!(updatePermission | hasPermission)"\n        >\n            <option *ngFor="let zone of zones$ | async" [value]="zone.id">{{ zone.name }}</option>\n        </select>\n    </vdr-form-field>\n    <clr-alert\n        *ngIf="detailForm.value.code && !detailForm.value.defaultShippingZoneId"\n        clrAlertType="warning"\n        [clrAlertClosable]="false"\n    >\n        <clr-alert-item>\n            <span class="alert-text">\n                {{ \'error.no-default-shipping-zone-set\' | translate }}\n            </span>\n        </clr-alert-item>\n    </clr-alert>\n\n    <section formGroupName="customFields" *ngIf="customFields.length">\n        <label>{{ \'common.custom-fields\' | translate }}</label>\n        <ng-container *ngFor="let customField of customFields">\n            <vdr-custom-field-control\n                *ngIf="customFieldIsSet(customField.name)"\n                entityName="Channel"\n                [customFieldsFormGroup]="detailForm.get(\'customFields\')"\n                [customField]="customField"\n            ></vdr-custom-field-control>\n        </ng-container>\n    </section>\n</form>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["clr-alert{max-width:30rem;margin-bottom:12px}"]}]}],y.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute},{type:n.ServerConfigService},{type:t.ChangeDetectorRef},{type:n.DataService},{type:a.FormBuilder},{type:n.NotificationService}]};var C=function(){function e(e,t,n){var a=this;this.dataService=e,this.modalService=t,this.notificationService=n,this.refresh$=new l.Subject,this.channels$=this.refresh$.pipe(r.startWith(1),r.switchMap((function(){return a.dataService.settings.getChannels().mapStream((function(e){return e.channels}))})))}return e.prototype.isDefaultChannel=function(e){return e===s.DEFAULT_CHANNEL_CODE},e.prototype.deleteChannel=function(e){var t=this;this.modalService.dialog({title:i.marker("catalog.confirm-delete-channel"),buttons:[{type:"secondary",label:i.marker("common.cancel")},{type:"danger",label:i.marker("common.delete"),returnValue:!0}]}).pipe(r.switchMap((function(n){return n?t.dataService.settings.deleteChannel(e):l.EMPTY})),r.mergeMap((function(){return t.dataService.auth.currentUser().single$})),r.mergeMap((function(e){return t.dataService.client.updateUserChannels(e.me.channels)}))).subscribe((function(){t.notificationService.success(i.marker("common.notify-delete-success"),{entity:"Channel"}),t.refresh$.next(1)}),(function(e){t.notificationService.error(i.marker("common.notify-delete-error"),{entity:"Channel"})}))},e}();C.decorators=[{type:t.Component,args:[{selector:"vdr-channel-list",template:'<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="channel-list"></vdr-action-bar-items>\n        <a class="btn btn-primary" [routerLink]="[\'./create\']" *vdrIfPermissions="\'SuperAdmin\'">\n            <clr-icon shape="plus"></clr-icon>\n            {{ \'settings.create-new-channel\' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table [items]="channels$ | async">\n    <vdr-dt-column>{{ \'common.code\' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-channel="item">\n        <td class="left align-middle">\n            <vdr-channel-badge [channelCode]="channel.code"></vdr-channel-badge>\n            {{ channel.code | channelCodeToLabel | translate }}\n        </td>\n        <td class="right align-middle">\n            <vdr-table-row-action\n                iconShape="edit"\n                [label]="\'common.edit\' | translate"\n                [linkTo]="[\'./\', channel.id]"\n            ></vdr-table-row-action>\n        </td>\n        <td class="right align-middle">\n            <vdr-dropdown>\n                <button type="button" class="btn btn-link btn-sm" vdrDropdownTrigger [disabled]="isDefaultChannel(channel.code)">\n                    {{ \'common.actions\' | translate }}\n                    <clr-icon shape="caret down"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition="bottom-right">\n                    <button\n                        type="button"\n                        class="delete-button"\n                        (click)="deleteChannel(channel.id)"\n                        [disabled]="!([\'SuperAdmin\', \'DeleteChannel\'] | hasPermission)"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape="trash" class="is-danger"></clr-icon>\n                        {{ \'common.delete\' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],C.ctorParameters=function(){return[{type:n.DataService},{type:n.ModalService},{type:n.NotificationService}]};var S=function(e){function t(t,r,o,i,s,l,c){var d=e.call(this,r,t,o,s)||this;return d.changeDetector=i,d.dataService=s,d.formBuilder=l,d.notificationService=c,d.updatePermission=[n.Permission.UpdateSettings,n.Permission.UpdateCountry],d.detailForm=d.formBuilder.group({code:["",a.Validators.required],name:["",a.Validators.required],enabled:[!0]}),d}return p(t,e),t.prototype.ngOnInit=function(){this.init(),this.country$=this.entity$},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.create=function(){var e=this;this.detailForm.dirty&&l.combineLatest(this.country$,this.languageCode$).pipe(r.take(1),r.mergeMap((function(t){var r=f(t,2),a=r[0],o=r[1],i=e.detailForm.value,s=n.createUpdatedTranslatable({translatable:a,updatedFields:i,languageCode:o,defaultTranslation:{name:i.name,languageCode:o}});return e.dataService.settings.createCountry(s)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-create-success"),{entity:"Country"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createCountry.id],{relativeTo:e.route})}),(function(t){e.notificationService.error(i.marker("common.notify-create-error"),{entity:"Country"})}))},t.prototype.save=function(){var e=this;l.combineLatest(this.country$,this.languageCode$).pipe(r.take(1),r.mergeMap((function(t){var r=f(t,2),a=r[0],o=r[1],i=e.detailForm.value,s=n.createUpdatedTranslatable({translatable:a,updatedFields:i,languageCode:o,defaultTranslation:{name:i.name,languageCode:o}});return e.dataService.settings.updateCountry(s)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-update-success"),{entity:"Country"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck()}),(function(t){e.notificationService.error(i.marker("common.notify-update-error"),{entity:"Country"})}))},t.prototype.setFormValues=function(e,t){var r=n.findTranslation(e,t);this.detailForm.patchValue({code:e.code,name:r?r.name:"",enabled:e.enabled})},t}(n.BaseDetailComponent);S.decorators=[{type:t.Component,args:[{selector:"vdr-country-detail",template:'<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]="entity$ | async"></vdr-entity-info>\n        <vdr-language-selector\n            [disabled]="isNew$ | async"\n            [availableLanguageCodes]="availableLanguages$ | async"\n            [currentLanguageCode]="languageCode$ | async"\n            (languageCodeChange)="setLanguage($event)"\n        ></vdr-language-selector>\n    </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="country-detail"></vdr-action-bar-items>\n        <button\n            class="btn btn-primary"\n            *ngIf="isNew$ | async; else updateButton"\n            (click)="create()"\n            [disabled]="detailForm.invalid || detailForm.pristine"\n        >\n            {{ \'common.create\' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class="btn btn-primary"\n                *vdrIfPermissions="updatePermission"\n                (click)="save()"\n                [disabled]="detailForm.invalid || detailForm.pristine"\n            >\n                {{ \'common.update\' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class="form" [formGroup]="detailForm">\n    <vdr-form-field [label]="\'common.code\' | translate" for="code">\n        <input\n            id="code"\n            type="text"\n            formControlName="code"\n            [readonly]="!(updatePermission | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'common.name\' | translate" for="name">\n        <input\n            id="name"\n            type="text"\n            formControlName="name"\n            [readonly]="!(updatePermission | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'common.enabled\' | translate" for="enabled">\n        <clr-toggle-wrapper>\n            <input\n                type="checkbox"\n                clrToggle\n                id="enabled"\n                formControlName="enabled"\n                [vdrDisabled]="!(updatePermission | hasPermission)"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n</form>\n',styles:[""]}]}],S.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute},{type:n.ServerConfigService},{type:t.ChangeDetectorRef},{type:n.DataService},{type:a.FormBuilder},{type:n.NotificationService}]};var k=function(){function e(e,t,n){this.dataService=e,this.notificationService=t,this.modalService=n,this.searchTerm=new a.FormControl(""),this.countries=[],this.destroy$=new l.Subject}return e.prototype.ngOnInit=function(){var e=this,t=this.searchTerm.valueChanges.pipe(r.startWith(null),r.switchMap((function(t){return e.dataService.settings.getCountries(999,0,t).stream$})),r.tap((function(t){return e.countries=t.countries.items})),r.map((function(e){return e.countries.items})));this.zones$=this.dataService.settings.getZones().mapStream((function(e){return e.zones})),this.countriesWithZones$=l.combineLatest(t,this.zones$).pipe(r.map((function(e){var t=f(e,2),n=t[0],r=t[1];return n.map((function(e){return Object.assign(Object.assign({},e),{zones:r.filter((function(t){return!!t.members.find((function(t){return t.id===e.id}))}))})}))})))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.deleteCountry=function(e){var t=this;this.modalService.dialog({title:i.marker("catalog.confirm-delete-country"),buttons:[{type:"secondary",label:i.marker("common.cancel")},{type:"danger",label:i.marker("common.delete"),returnValue:!0}]}).pipe(r.switchMap((function(n){return n?t.dataService.settings.deleteCountry(e):l.EMPTY}))).subscribe((function(e){e.deleteCountry.result===n.DeletionResult.DELETED?(t.notificationService.success(i.marker("common.notify-delete-success"),{entity:"Country"}),t.dataService.settings.getCountries(999,0).single$.subscribe()):t.notificationService.error(e.deleteCountry.message||"")}),(function(e){t.notificationService.error(i.marker("common.notify-delete-error"),{entity:"Country"})}))},e.prototype.isZone=function(e){return e.hasOwnProperty("id")},e}();k.decorators=[{type:t.Component,args:[{selector:"vdr-country-list",template:'<vdr-action-bar>\n    <vdr-ab-left>\n        <input\n            type="text"\n            name="searchTerm"\n            [formControl]="searchTerm"\n            [placeholder]="\'settings.search-country-by-name\' | translate"\n            class="search-input"\n        />\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="country-list"></vdr-action-bar-items>\n        <a class="btn btn-primary" [routerLink]="[\'./create\']" *vdrIfPermissions="[\'CreateSettings\', \'CreateCountry\']">\n            <clr-icon shape="plus"></clr-icon>\n            {{ \'settings.create-new-country\' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]="countriesWithZones$ | async"\n>\n    <vdr-dt-column>{{ \'common.code\' | translate }}</vdr-dt-column>\n    <vdr-dt-column [expand]="true">{{ \'common.name\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'settings.zone\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'common.enabled\' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-country="item">\n        <td class="left align-middle">{{ country.code }}</td>\n        <td class="left align-middle">{{ country.name }}</td>\n        <td class="left align-middle">\n            <a [routerLink]="[\'/settings\', \'zones\', { contents: zone.id }]" *ngFor="let zone of country.zones">\n            <vdr-chip [colorFrom]="zone.name">{{ zone.name }}</vdr-chip>\n            </a>\n        </td>\n        <td class="left align-middle">\n            <clr-icon\n                [class.is-success]="country.enabled"\n                [attr.shape]="country.enabled ? \'check\' : \'times\'"\n            ></clr-icon>\n        </td>\n        <td class="right align-middle">\n            <vdr-table-row-action\n                iconShape="edit"\n                [label]="\'common.edit\' | translate"\n                [linkTo]="[\'./\', country.id]"\n            ></vdr-table-row-action>\n        </td>\n        <td class="right align-middle">\n            <vdr-dropdown>\n                <button type="button" class="btn btn-link btn-sm" vdrDropdownTrigger>\n                    {{ \'common.actions\' | translate }}\n                    <clr-icon shape="caret down"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition="bottom-right">\n                    <button\n                        type="button"\n                        class="delete-button"\n                        (click)="deleteCountry(country.id)"\n                        vdrDropdownItem\n                        [disabled]="!([\'DeleteSettings\', \'DeleteCountry\'] | hasPermission)"\n                    >\n                        <clr-icon shape="trash" class="is-danger"></clr-icon>\n                        {{ \'common.delete\' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[".search-input{margin-top:6px;min-width:300px}"]}]}],k.ctorParameters=function(){return[{type:n.DataService},{type:n.NotificationService},{type:n.ModalService}]};var D=function(e){function t(t,r,o,i,s,l,c){var d=e.call(this,r,t,o,s)||this;return d.changeDetector=i,d.dataService=s,d.formBuilder=l,d.notificationService=c,d.languageCodes=Object.values(n.LanguageCode),d.updatePermission=[n.Permission.UpdateSettings,n.Permission.UpdateGlobalSettings],d.customFields=d.getCustomFieldConfig("GlobalSettings"),d.detailForm=d.formBuilder.group({availableLanguages:[""],trackInventory:!1,outOfStockThreshold:[0,a.Validators.required],customFields:d.formBuilder.group(d.customFields.reduce((function(e,t){var n;return Object.assign(Object.assign({},e),((n={})[t.name]="",n))}),{}))}),d}return p(t,e),t.prototype.ngOnInit=function(){var e=this;this.init(),this.dataService.client.userStatus().single$.subscribe((function(t){if(!t.userStatus.permissions.includes(n.Permission.UpdateSettings)){var r=e.detailForm.get("availableLanguages");r&&r.disable()}}))},t.prototype.customFieldIsSet=function(e){return!!this.detailForm.get(["customFields",e])},t.prototype.save=function(){var e=this;this.detailForm.dirty&&this.dataService.settings.updateGlobalSettings(this.detailForm.value).pipe(r.tap((function(t){var n=t.updateGlobalSettings;switch(n.__typename){case"GlobalSettings":e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success(i.marker("common.notify-update-success"),{entity:"Settings"});break;case"ChannelDefaultLanguageError":e.notificationService.error(n.message)}})),r.switchMap((function(){return e.serverConfigService.refreshGlobalSettings()}))).subscribe()},t.prototype.setFormValues=function(e,t){var n,r;if(this.detailForm.patchValue({availableLanguages:e.availableLanguages,trackInventory:e.trackInventory,outOfStockThreshold:e.outOfStockThreshold}),this.customFields.length){var a=this.detailForm.get("customFields");try{for(var o=v(this.customFields),i=o.next();!i.done;i=o.next()){var s=i.value.name,l=e.customFields[s],c=a.get(s);c&&c.patchValue(l)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}},t}(n.BaseDetailComponent);D.decorators=[{type:t.Component,args:[{selector:"vdr-global-settings",template:'<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="global-settings-detail"></vdr-action-bar-items>\n        <button\n            class="btn btn-primary"\n            (click)="save()"\n            *vdrIfPermissions="updatePermission"\n            [disabled]="detailForm.invalid || detailForm.pristine"\n        >\n            {{ \'common.update\' | translate }}\n        </button>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class="form" [formGroup]="detailForm">\n    <vdr-form-field [label]="\'common.available-languages\' | translate" for="availableLanguages">\n        <ng-select\n            [items]="languageCodes"\n            [addTag]="false"\n            [hideSelected]="true"\n            multiple="true"\n            appendTo="body"\n            formControlName="availableLanguages"\n        >\n            <ng-template ng-label-tmp let-item="item" let-clear="clear">\n                <span class="ng-value-icon left" (click)="clear.call(null, item)" aria-hidden="true">\n                    Ã—\n                </span>\n                <span class="ng-value-label">{{ \'lang.\' + item | translate }} ({{ item }})</span>\n            </ng-template>\n            <ng-template ng-option-tmp let-item="item">\n                {{ \'lang.\' + item | translate }} ({{ item }})\n            </ng-template>\n        </ng-select>\n    </vdr-form-field>\n    <vdr-form-field\n        [label]="\'settings.global-out-of-stock-threshold\' | translate"\n        for="outOfStockThreshold"\n        [tooltip]="\'settings.global-out-of-stock-threshold-tooltip\' | translate"\n    >\n        <input\n            id="outOfStockThreshold"\n            type="number"\n            formControlName="outOfStockThreshold"\n            [readonly]="!(updatePermission | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-form-field\n        [label]="\'settings.track-inventory-default\' | translate"\n        for="enabled"\n        [tooltip]="\'catalog.track-inventory-tooltip\' | translate"\n    >\n        <clr-toggle-wrapper>\n            <input\n                type="checkbox"\n                clrToggle\n                name="enabled"\n                formControlName="trackInventory"\n                [vdrDisabled]="!(updatePermission | hasPermission)"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n    <section formGroupName="customFields" *ngIf="customFields.length">\n        <label>{{ \'common.custom-fields\' | translate }}</label>\n        <ng-container *ngFor="let customField of customFields">\n            <vdr-custom-field-control\n                *ngIf="customFieldIsSet(customField.name)"\n                entityName="GlobalSettings"\n                [customFieldsFormGroup]="detailForm.get(\'customFields\')"\n                [customField]="customField"\n            ></vdr-custom-field-control>\n        </ng-container>\n    </section>\n</form>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["::ng-deep ng-select .ng-arrow-wrapper .ng-arrow,::ng-deep ng-select .ng-select-container>span,::ng-deep ng-select .ng-value>span{margin:0!important}"]}]}],D.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute},{type:n.ServerConfigService},{type:t.ChangeDetectorRef},{type:n.DataService},{type:a.FormBuilder},{type:n.NotificationService}]};var P=function(e){function t(t,r,o,i,s,l,c){var d=e.call(this,r,t,o,s)||this;return d.changeDetector=i,d.dataService=s,d.formBuilder=l,d.notificationService=c,d.checkers=[],d.handlers=[],d.updatePermission=[n.Permission.UpdateSettings,n.Permission.UpdatePaymentMethod],d.detailForm=d.formBuilder.group({code:["",a.Validators.required],name:["",a.Validators.required],description:"",enabled:[!0,a.Validators.required],checker:{},handler:{}}),d}return p(t,e),t.prototype.ngOnInit=function(){var e=this;this.init(),l.combineLatest([this.dataService.settings.getPaymentMethodOperations().single$,this.entity$.pipe(r.take(1))]).subscribe((function(t){var n=f(t,2),r=n[0],a=n[1];e.checkers=r.paymentMethodEligibilityCheckers,e.handlers=r.paymentMethodHandlers,e.changeDetector.markForCheck(),e.selectedCheckerDefinition=r.paymentMethodEligibilityCheckers.find((function(e){return e.code===(a.checker&&a.checker.code)})),e.selectedHandlerDefinition=r.paymentMethodHandlers.find((function(e){return e.code===(a.handler&&a.handler.code)}))}))},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.updateCode=function(e,t){if(!e){var n=this.detailForm.get(["code"]);n&&n.pristine&&n.setValue(c.normalizeString(t,"-"))}},t.prototype.configArgsIsPopulated=function(){var e=this.detailForm.get("configArgs");return!!e&&0<Object.keys(e.controls).length},t.prototype.selectChecker=function(e){this.selectedCheckerDefinition=e,this.selectedChecker=n.configurableDefinitionToInstance(e);var t=this.detailForm.get("checker");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedChecker)),this.detailForm.markAsDirty()},t.prototype.selectHandler=function(e){this.selectedHandlerDefinition=e,this.selectedHandler=n.configurableDefinitionToInstance(e);var t=this.detailForm.get("handler");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedHandler)),this.detailForm.markAsDirty()},t.prototype.removeChecker=function(){this.selectedChecker=null,this.detailForm.markAsDirty()},t.prototype.removeHandler=function(){this.selectedHandler=null,this.detailForm.markAsDirty()},t.prototype.create=function(){var e=this,t=this.selectedChecker,a=this.selectedHandler;a&&this.entity$.pipe(r.take(1),r.mergeMap((function(r){r.id;var o=e.detailForm.value,i={name:o.name,code:o.code,description:o.description,enabled:o.enabled,checker:t?n.toConfigurableOperationInput(t,o.checker):null,handler:n.toConfigurableOperationInput(a,o.handler)};return e.dataService.settings.createPaymentMethod(i)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-create-success"),{entity:"PaymentMethod"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createPaymentMethod.id],{relativeTo:e.route})}),(function(t){e.notificationService.error(i.marker("common.notify-create-error"),{entity:"PaymentMethod"})}))},t.prototype.save=function(){var e=this,t=this.selectedChecker,a=this.selectedHandler;a&&this.entity$.pipe(r.take(1),r.mergeMap((function(r){var o=r.id,i=e.detailForm.value,s={id:o,name:i.name,code:i.code,description:i.description,enabled:i.enabled,checker:t?n.toConfigurableOperationInput(t,i.checker):null,handler:n.toConfigurableOperationInput(a,i.handler)};return e.dataService.settings.updatePaymentMethod(s)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-update-success"),{entity:"PaymentMethod"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck()}),(function(t){e.notificationService.error(i.marker("common.notify-update-error"),{entity:"PaymentMethod"})}))},t.prototype.setFormValues=function(e){this.detailForm.patchValue({name:e.name,code:e.code,description:e.description,enabled:e.enabled,checker:e.checker||{},handler:e.handler||{}}),this.selectedChecker||(this.selectedChecker=e.checker&&{code:e.checker.code,args:e.checker.args.map((function(e){return Object.assign(Object.assign({},e),{value:n.getConfigArgValue(e.value)})}))}),this.selectedHandler||(this.selectedHandler=e.handler&&{code:e.handler.code,args:e.handler.args.map((function(e){return Object.assign(Object.assign({},e),{value:n.getConfigArgValue(e.value)})}))})},t}(n.BaseDetailComponent);P.decorators=[{type:t.Component,args:[{selector:"vdr-payment-method-detail",template:'<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]="entity$ | async"></vdr-entity-info>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="payment-method-detail"></vdr-action-bar-items>\n        <button\n            class="btn btn-primary"\n            *ngIf="isNew$ | async; else updateButton"\n            [disabled]="detailForm.pristine || detailForm.invalid"\n            (click)="create()"\n        >\n            {{ \'common.create\' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                *vdrIfPermissions="updatePermission"\n                class="btn btn-primary"\n                (click)="save()"\n                [disabled]="detailForm.pristine || detailForm.invalid || !selectedHandler"\n            >\n                {{ \'common.update\' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class="form" [formGroup]="detailForm" *ngIf="entity$ | async as paymentMethod">\n    <vdr-form-field [label]="\'common.name\' | translate" for="name">\n        <input\n            id="name"\n            type="text"\n            formControlName="name"\n            [readonly]="!(updatePermission | hasPermission)"\n            (input)="updateCode(paymentMethod.code, $event.target.value)"\n        />\n    </vdr-form-field>\n    <vdr-form-field\n        [label]="\'common.code\' | translate"\n        for="code"\n        [readOnlyToggle]="updatePermission | hasPermission"\n    >\n        <input\n            id="code"\n            type="text"\n            formControlName="code"\n            [readonly]="!(updatePermission | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-rich-text-editor\n        formControlName="description"\n        [readonly]="!(updatePermission | hasPermission)"\n        [label]="\'common.description\' | translate"\n    ></vdr-rich-text-editor>\n    <vdr-form-field [label]="\'common.enabled\' | translate" for="description">\n        <clr-toggle-wrapper>\n            <input\n                type="checkbox"\n                clrToggle\n                id="enabled"\n                [vdrDisabled]="!(updatePermission | hasPermission)"\n                formControlName="enabled"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n\n    <div class="clr-row mt4">\n        <div class="clr-col">\n            <label class="clr-control-label">{{ \'settings.payment-eligibility-checker\' | translate }}</label>\n            <vdr-configurable-input\n                *ngIf="selectedChecker && selectedCheckerDefinition"\n                [operation]="selectedChecker"\n                [operationDefinition]="selectedCheckerDefinition"\n                [readonly]="!(updatePermission | hasPermission)"\n                (remove)="removeChecker()"\n                formControlName="checker"\n            ></vdr-configurable-input>\n            <div *ngIf="!selectedChecker || !selectedCheckerDefinition">\n                <vdr-dropdown>\n                    <button class="btn btn-outline" vdrDropdownTrigger>\n                        <clr-icon shape="plus"></clr-icon>\n                        {{ \'common.select\' | translate }}\n                    </button>\n                    <vdr-dropdown-menu vdrPosition="bottom-left">\n                        <button\n                            *ngFor="let checker of checkers"\n                            type="button"\n                            vdrDropdownItem\n                            (click)="selectChecker(checker)"\n                        >\n                            {{ checker.description }}\n                        </button>\n                    </vdr-dropdown-menu>\n                </vdr-dropdown>\n            </div>\n        </div>\n        <div class="clr-col">\n            <label class="clr-control-label">{{ \'settings.payment-handler\' | translate }}</label>\n            <vdr-configurable-input\n                *ngIf="selectedHandler && selectedHandlerDefinition"\n                [operation]="selectedHandler"\n                [operationDefinition]="selectedHandlerDefinition"\n                [readonly]="!(updatePermission | hasPermission)"\n                (remove)="removeHandler()"\n                formControlName="handler"\n            ></vdr-configurable-input>\n            <div *ngIf="!selectedHandler || !selectedHandlerDefinition">\n                <vdr-dropdown>\n                    <button class="btn btn-outline" vdrDropdownTrigger>\n                        <clr-icon shape="plus"></clr-icon>\n                        {{ \'common.select\' | translate }}\n                    </button>\n                    <vdr-dropdown-menu vdrPosition="bottom-left">\n                        <button\n                            *ngFor="let handler of handlers"\n                            type="button"\n                            vdrDropdownItem\n                            (click)="selectHandler(handler)"\n                        >\n                            {{ handler.description }}\n                        </button>\n                    </vdr-dropdown-menu>\n                </vdr-dropdown>\n            </div>\n        </div>\n    </div>\n</form>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],P.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute},{type:n.ServerConfigService},{type:t.ChangeDetectorRef},{type:n.DataService},{type:a.FormBuilder},{type:n.NotificationService}]};var F=function(e){function t(t,n,r,a,o){var i=e.call(this,n,r)||this;return i.dataService=t,i.modalService=a,i.notificationService=o,e.prototype.setQueryFn.call(i,(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=i.dataService.settings).getPaymentMethods.apply(e,g(t)).refetchOnChannelChange()}),(function(e){return e.paymentMethods})),i}return p(t,e),t.prototype.deletePaymentMethod=function(e){var t=this;this.showModalAndDelete(e).pipe(r.switchMap((function(a){return a.result===n.DeletionResult.DELETED?[!0]:t.showModalAndDelete(e,a.message||"").pipe(r.map((function(e){return e.result===n.DeletionResult.DELETED})))})),r.switchMap((function(){return t.dataService.settings.getPaymentMethods(100).single$}))).subscribe((function(){t.notificationService.success(i.marker("common.notify-delete-success"),{entity:"PaymentMethod"}),t.refresh()}),(function(e){t.notificationService.error(i.marker("common.notify-delete-error"),{entity:"PaymentMethod"})}))},t.prototype.showModalAndDelete=function(e,t){var n=this;return this.modalService.dialog({title:i.marker("settings.confirm-delete-payment-method"),body:t,buttons:[{type:"secondary",label:i.marker("common.cancel")},{type:"danger",label:i.marker("common.delete"),returnValue:!0}]}).pipe(r.switchMap((function(r){return r?n.dataService.settings.deletePaymentMethod(e,!!t):l.EMPTY})),r.map((function(e){return e.deletePaymentMethod})))},t}(n.BaseListComponent);F.decorators=[{type:t.Component,args:[{selector:"vdr-payment-method-list",template:'<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="payment-method-list"></vdr-action-bar-items>\n        <a class="btn btn-primary" [routerLink]="[\'./create\']" *vdrIfPermissions="[\'CreateSettings\', \'CreatePaymentMethod\']">\n            <clr-icon shape="plus"></clr-icon>\n            {{ \'settings.create-new-payment-method\' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]="items$ | async"\n    [itemsPerPage]="itemsPerPage$ | async"\n    [totalItems]="totalItems$ | async"\n    [currentPage]="currentPage$ | async"\n    (pageChange)="setPageNumber($event)"\n    (itemsPerPageChange)="setItemsPerPage($event)"\n>\n    <vdr-dt-column>{{ \'common.code\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'common.enabled\' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-paymentMethod="item">\n        <td class="left align-middle">{{ paymentMethod.code }}</td>\n        <td class="left align-middle">{{ paymentMethod.enabled }}</td>\n        <td class="right align-middle">\n            <vdr-table-row-action\n                iconShape="edit"\n                [label]="\'common.edit\' | translate"\n                [linkTo]="[\'./\', paymentMethod.id]"\n            ></vdr-table-row-action>\n        </td>\n        <td class="right align-middle">\n            <vdr-dropdown>\n                <button type="button" class="btn btn-link btn-sm" vdrDropdownTrigger>\n                    {{ \'common.actions\' | translate }}\n                    <clr-icon shape="caret down"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition="bottom-right">\n                    <button\n                        type="button"\n                        class="delete-button"\n                        (click)="deletePaymentMethod(paymentMethod.id)"\n                        [disabled]="!([\'DeleteSettings\', \'DeletePaymentMethod\'] | hasPermission)"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape="trash" class="is-danger"></clr-icon>\n                        {{ \'common.delete\' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],F.ctorParameters=function(){return[{type:n.DataService},{type:o.Router},{type:o.ActivatedRoute},{type:n.ModalService},{type:n.NotificationService}]};var I=function(){function e(){this.readonly=!1,this.permissionChange=new t.EventEmitter}return e.prototype.ngOnInit=function(){this.buildGrid()},e.prototype.setPermission=function(e,t){this.readonly||this.permissionChange.emit({permission:e,value:t})},e.prototype.toggleAll=function(e){var t,n,r=this,a=e.some((function(e){return!r.activePermissions.includes(e.name)}));try{for(var o=v(e),i=o.next();!i.done;i=o.next()){var s=i.value;this.permissionChange.emit({permission:s.name,value:a})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.buildGrid=function(){var e,t,n,r=this,a=new Map,o=[],i=/^(Create|Read|Update|Delete)([a-zA-Z]+)$/;try{for(var s=v(this.permissionDefinitions),l=s.next();!l.done;l=s.next()){var c=l.value;if(i.test(c.name)){var d=null===(n=c.name.match(i))||void 0===n?void 0:n[2];if(d){var m=a.get(d);m?m.push(c):a.set(d,[c])}}else c.assignable&&o.push(c)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}this.gridData=g(o.map((function(e){return{label:e.name,description:e.description,permissions:[e]}})),Array.from(a.entries()).map((function(e){var t=f(e,2),n=t[0],a=t[1];return{label:n,description:r.extractCrudDescription(a[0]),permissions:a}})))},e.prototype.extractCrudDescription=function(e){return e.description.replace(/Grants permission to [\w]+/,"Grants permissions on")},e}();I.decorators=[{type:t.Component,args:[{selector:"vdr-permission-grid",template:'<table class="table">\n    <tbody>\n        <tr *ngFor="let section of gridData">\n            <td class="permission-group left">\n                <div><strong>{{ section.label | translate }}</strong></div>\n                <small>{{ section.description | translate }}</small><br>\n                <button *ngIf="1 < section.permissions.length && !readonly" class="btn btn-sm btn-link" (click)="toggleAll(section.permissions)">\n                    {{ \'common.toggle-all\' | translate }}\n                </button>\n            </td>\n            <td *ngFor="let permission of section.permissions" [attr.colspan]="section.permissions.length === 1 ? 4 : 1">\n                <vdr-select-toggle\n                    size="small"\n                    [title]="permission.description"\n                    [label]="permission.name"\n                    [disabled]="readonly"\n                    [selected]="activePermissions?.includes(permission.name)"\n                    (selectedChange)="setPermission(permission.name, $event)"\n                ></vdr-select-toggle>\n            </td>\n        </tr>\n    </tbody>\n</table>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["td.permission-group{max-width:300px;background-color:var(--color-component-bg-200)}"]}]}],I.propDecorators={permissionDefinitions:[{type:t.Input}],activePermissions:[{type:t.Input}],readonly:[{type:t.Input}],permissionChange:[{type:t.Output}]};var w=function(e){function t(t,n,r,o,i,s,l){var c=e.call(this,n,t,r,i)||this;return c.changeDetector=o,c.dataService=i,c.formBuilder=s,c.notificationService=l,c.customFields=c.getCustomFieldConfig("Administrator"),c.detailForm=c.formBuilder.group({emailAddress:["",a.Validators.required],firstName:["",a.Validators.required],lastName:["",a.Validators.required],password:[""],customFields:c.formBuilder.group(c.customFields.reduce((function(e,t){var n;return Object.assign(Object.assign({},e),((n={})[t.name]="",n))}),{}))}),c}return p(t,e),t.prototype.ngOnInit=function(){this.init()},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.customFieldIsSet=function(e){return!!this.detailForm.get(["customFields",e])},t.prototype.save=function(){var e=this;this.entity$.pipe(r.take(1),r.mergeMap((function(t){t.id;var n=e.detailForm.value,r={emailAddress:n.emailAddress,firstName:n.firstName,lastName:n.lastName,password:n.password,customFields:n.customFields};return e.dataService.administrator.updateActiveAdministrator(r)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-update-success"),{entity:"Administrator"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck()}),(function(t){e.notificationService.error(i.marker("common.notify-update-error"),{entity:"Administrator"})}))},t.prototype.setFormValues=function(e,t){var n,r;if(this.detailForm.patchValue({emailAddress:e.emailAddress,firstName:e.firstName,lastName:e.lastName}),this.customFields.length){var a=this.detailForm.get("customFields");try{for(var o=v(this.customFields),i=o.next();!i.done;i=o.next()){var s=i.value.name,l=e.customFields[s],c=a.get(s);c&&c.patchValue(l)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}},t}(n.BaseDetailComponent);w.decorators=[{type:t.Component,args:[{selector:"vdr-profile",template:'<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]="entity$ | async"></vdr-entity-info>\n    </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="administrator-detail"></vdr-action-bar-items>\n        <button\n            class="btn btn-primary"\n            (click)="save()"\n            [disabled]="detailForm.invalid || detailForm.pristine"\n        >\n            {{ \'common.update\' | translate }}\n        </button>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class="form" [formGroup]="detailForm">\n    <vdr-form-field [label]="\'settings.email-address\' | translate" for="emailAddress">\n        <input id="emailAddress" type="text" formControlName="emailAddress" />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.first-name\' | translate" for="firstName">\n        <input id="firstName" type="text" formControlName="firstName" />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.last-name\' | translate" for="lastName">\n        <input id="lastName" type="text" formControlName="lastName" />\n    </vdr-form-field>\n    <vdr-form-field *ngIf="isNew$ | async" [label]="\'settings.password\' | translate" for="password">\n        <input id="password" type="password" formControlName="password" />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.password\' | translate" for="password" [readOnlyToggle]="true">\n        <input id="password" type="password" formControlName="password" />\n    </vdr-form-field>\n    <section formGroupName="customFields" *ngIf="customFields.length">\n        <label>{{ \'common.custom-fields\' | translate }}</label>\n        <ng-container *ngFor="let customField of customFields">\n            <vdr-custom-field-control\n                *ngIf="customFieldIsSet(customField.name)"\n                entityName="Administrator"\n                [customFieldsFormGroup]="detailForm.get(\'customFields\')"\n                [customField]="customField"\n            ></vdr-custom-field-control>\n        </ng-container>\n    </section>\n</form>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],w.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute},{type:n.ServerConfigService},{type:t.ChangeDetectorRef},{type:n.DataService},{type:a.FormBuilder},{type:n.NotificationService}]};var x=function(e){function t(t,n,r,o,i,s,l){var c=e.call(this,n,t,r,i)||this;return c.changeDetector=o,c.dataService=i,c.formBuilder=s,c.notificationService=l,c.detailForm=c.formBuilder.group({code:["",a.Validators.required],description:["",a.Validators.required],channelIds:[],permissions:[]}),c}return p(t,e),t.prototype.ngOnInit=function(){this.init(),this.role$=this.entity$,this.permissionDefinitions=this.serverConfigService.getPermissionDefinitions()},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.updateCode=function(e){var t=this.detailForm.get(["code"]);t&&t.pristine&&t.setValue(c.normalizeString(e,"-"))},t.prototype.setPermission=function(e){var t=this.detailForm.get("permissions");if(t){var n=t.value,r=!0===e.value?d.unique(g(n,[e.permission])):n.filter((function(t){return t!==e.permission}));t.setValue(r),t.markAsDirty()}},t.prototype.create=function(){var e=this,t=this.detailForm.value;this.dataService.administrator.createRole(t).subscribe((function(t){e.notificationService.success(i.marker("common.notify-create-success"),{entity:"Role"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createRole.id],{relativeTo:e.route})}),(function(t){e.notificationService.error(i.marker("common.notify-create-error"),{entity:"Role"})}))},t.prototype.save=function(){var e=this;this.role$.pipe(r.take(1),r.mergeMap((function(t){var n=t.id,r=e.detailForm.value,a=Object.assign({id:n},r);return e.dataService.administrator.updateRole(a)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-update-success"),{entity:"Role"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck()}),(function(t){e.notificationService.error(i.marker("common.notify-update-error"),{entity:"Role"})}))},t.prototype.setFormValues=function(e,t){this.detailForm.patchValue({description:e.description,code:e.code,channelIds:e.channels.map((function(e){return e.id})),permissions:e.permissions}),this.changeDetector.detectChanges()},t}(n.BaseDetailComponent);x.decorators=[{type:t.Component,args:[{selector:"vdr-role-detail",template:'<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]="entity$ | async"></vdr-entity-info>\n    </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="role-detail"></vdr-action-bar-items>\n        <button\n            class="btn btn-primary"\n            *ngIf="isNew$ | async; else updateButton"\n            (click)="create()"\n            [disabled]="detailForm.invalid || detailForm.pristine"\n        >\n            {{ \'common.create\' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class="btn btn-primary"\n                (click)="save()"\n                *vdrIfPermissions="\'UpdateAdministrator\'"\n                [disabled]="detailForm.invalid || detailForm.pristine"\n            >\n                {{ \'common.update\' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class="form" [formGroup]="detailForm">\n    <vdr-form-field [label]="\'common.description\' | translate" for="description">\n        <input\n            id="description"\n            type="text"\n            formControlName="description"\n            [readonly]="!(\'UpdateAdministrator\' | hasPermission)"\n            (input)="updateCode($event.target.value)"\n        />\n    </vdr-form-field>\n    <vdr-form-field\n        [label]="\'common.code\' | translate"\n        for="code"\n        [readOnlyToggle]="\'UpdateAdministrator\' | hasPermission"\n    >\n        <input\n            id="code"\n            type="text"\n            formControlName="code"\n            [readonly]="!(\'UpdateAdministrator\' | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.channel\' | translate">\n        <vdr-channel-assignment-control\n            formControlName="channelIds"\n            [vdrDisabled]="!(\'UpdateAdministrator\' | hasPermission)"\n        ></vdr-channel-assignment-control>\n    </vdr-form-field>\n    <label>{{ \'settings.permissions\' | translate }}</label>\n    <vdr-permission-grid\n        [permissionDefinitions]="permissionDefinitions"\n        [activePermissions]="detailForm.get(\'permissions\')?.value"\n        (permissionChange)="setPermission($event)"\n        [readonly]="!(\'UpdateAdministrator\' | hasPermission)"\n    ></vdr-permission-grid>\n</form>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],x.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute},{type:n.ServerConfigService},{type:t.ChangeDetectorRef},{type:n.DataService},{type:a.FormBuilder},{type:n.NotificationService}]};var T=function(e){function t(t,n,r,a,o){var i=e.call(this,a,o)||this;return i.modalService=t,i.notificationService=n,i.dataService=r,i.initialLimit=3,i.displayLimit={},e.prototype.setQueryFn.call(i,(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=i.dataService.administrator).getRoles.apply(e,g(t))}),(function(e){return e.roles})),i}return p(t,e),t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this),this.visibleRoles$=this.items$.pipe(r.map((function(e){return e.filter((function(e){return e.code!==s.CUSTOMER_ROLE_CODE}))})))},t.prototype.toggleDisplayLimit=function(e){this.displayLimit[e.id]===e.permissions.length?this.displayLimit[e.id]=this.initialLimit:this.displayLimit[e.id]=e.permissions.length},t.prototype.isDefaultRole=function(e){return e.code===s.SUPER_ADMIN_ROLE_CODE||e.code===s.CUSTOMER_ROLE_CODE},t.prototype.deleteRole=function(e){var t=this;this.modalService.dialog({title:i.marker("settings.confirm-delete-role"),buttons:[{type:"secondary",label:i.marker("common.cancel")},{type:"danger",label:i.marker("common.delete"),returnValue:!0}]}).pipe(r.switchMap((function(n){return n?t.dataService.administrator.deleteRole(e):l.EMPTY}))).subscribe((function(){t.notificationService.success(i.marker("common.notify-delete-success"),{entity:"Role"}),t.refresh()}),(function(e){t.notificationService.error(i.marker("common.notify-delete-error"),{entity:"Role"})}))},t}(n.BaseListComponent);T.decorators=[{type:t.Component,args:[{selector:"vdr-role-list",template:'<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="role-list"></vdr-action-bar-items>\n        <a class="btn btn-primary" [routerLink]="[\'./create\']" *vdrIfPermissions="\'CreateAdministrator\'">\n            <clr-icon shape="plus"></clr-icon>\n            {{ \'settings.create-new-role\' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]="visibleRoles$ | async"\n    [itemsPerPage]="itemsPerPage$ | async"\n    [totalItems]="totalItems$ | async"\n    [currentPage]="currentPage$ | async"\n    (pageChange)="setPageNumber($event)"\n    (itemsPerPageChange)="setItemsPerPage($event)"\n>\n    <vdr-dt-column>{{ \'common.description\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'common.code\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'settings.channel\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'settings.permissions\' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-role="item">\n        <td class="left align-middle">{{ role.description }}</td>\n        <td class="left align-middle"><span *ngIf="!isDefaultRole(role)">{{ role.code }}</span></td>\n        <td class="left align-middle">\n            <ng-container *ngIf="!isDefaultRole(role)">\n                <vdr-chip *ngFor="let channel of role.channels">\n                    <vdr-channel-badge [channelCode]="channel.code"></vdr-channel-badge>\n                    {{ channel.code | channelCodeToLabel | translate }}\n                </vdr-chip>\n            </ng-container>\n        </td>\n        <td class="left align-middle">\n            <ng-container *ngIf="!isDefaultRole(role); else defaultRole">\n                <vdr-chip *ngFor="let permission of role.permissions |  slice: 0:displayLimit[role.id] || 3">{{ permission }}</vdr-chip>\n                <button\n                    class="btn btn-sm btn-secondary btn-icon"\n                    *ngIf="role.permissions.length > initialLimit"\n                    (click)="toggleDisplayLimit(role)"\n                >\n                    <ng-container *ngIf="(displayLimit[role.id] || 0) < role.permissions.length; else collapse">\n                        <clr-icon shape="plus"></clr-icon>\n                        {{ role.permissions.length - initialLimit }}\n                    </ng-container>\n                    <ng-template #collapse>\n                        <clr-icon shape="minus"></clr-icon>\n                    </ng-template>\n                </button>\n            </ng-container>\n            <ng-template #defaultRole>\n                <span class="default-role-label">{{ \'settings.default-role-label\' | translate }}</span>\n            </ng-template>\n        </td>\n        <td class="right align-middle">\n            <vdr-table-row-action\n                *ngIf="!isDefaultRole(role)"\n                iconShape="edit"\n                [label]="\'common.edit\' | translate"\n                [linkTo]="[\'./\', role.id]"\n            ></vdr-table-row-action>\n        </td>\n        <td class="right align-middle">\n            <vdr-dropdown>\n                <button type="button" class="btn btn-link btn-sm" vdrDropdownTrigger [disabled]="isDefaultRole(role)">\n                    {{ \'common.actions\' | translate }}\n                    <clr-icon shape="caret down"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition="bottom-right">\n                    <button\n                        type="button"\n                        class="delete-button"\n                        (click)="deleteRole(role.id)"\n                        [disabled]="!(\'SuperAdmin\' | hasPermission)"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape="trash" class="is-danger"></clr-icon>\n                        {{ \'common.delete\' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[".default-role-label{color:var(--color-grey-400)}"]}]}],T.ctorParameters=function(){return[{type:n.ModalService},{type:n.NotificationService},{type:n.DataService},{type:o.Router},{type:o.ActivatedRoute}]};var R=function(){this.okToRun=!1,this.testDataUpdated=!1,this.runTest=new t.EventEmitter};R.decorators=[{type:t.Component,args:[{selector:"vdr-shipping-eligibility-test-result",template:'<div class="test-result card">\n    <div class="card-header">\n        {{ \'settings.test-result\' | translate }}\n    </div>\n    <div class="card-block" *ngFor="let quote of testResult">\n        <div class="result-details" [class.stale]="testDataUpdated">\n            <vdr-labeled-data [label]="\'settings.shipping-method\' | translate">\n                {{ quote.name }}\n            </vdr-labeled-data>\n            <div class="price-row">\n                <vdr-labeled-data [label]="\'common.price\' | translate">\n                    {{ quote.price | localeCurrency: currencyCode }}\n                </vdr-labeled-data>\n                <vdr-labeled-data [label]="\'common.price-with-tax\' | translate">\n                    {{ quote.priceWithTax | localeCurrency: currencyCode }}\n                </vdr-labeled-data>\n            </div>\n            <vdr-object-tree *ngIf="quote.metadata" [value]="quote.metadata"></vdr-object-tree>\n        </div>\n    </div>\n    <div class="card-block" *ngIf="testResult?.length === 0">\n        <clr-icon shape="ban" class="is-solid error"></clr-icon>\n        {{ \'settings.no-eligible-shipping-methods\' | translate }}\n    </div>\n    <div class="card-footer">\n        <button class="btn btn-secondary" (click)="runTest.emit()" [disabled]="!okToRun">\n            {{ \'settings.test-shipping-methods\' | translate }}\n        </button>\n    </div>\n</div>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[".result-details{transition:opacity .2s}.result-details.stale{opacity:.5}.price-row{display:flex}.price-row>:not(:first-child){margin-left:24px}clr-icon.error{color:var(--color-error-500)}"]}]}],R.propDecorators={testResult:[{type:t.Input}],okToRun:[{type:t.Input}],testDataUpdated:[{type:t.Input}],currencyCode:[{type:t.Input}],runTest:[{type:t.Output}]};var M=function(e){function t(t,r,o,i,s,c,d){var m=e.call(this,r,t,o,s)||this;return m.changeDetector=i,m.dataService=s,m.formBuilder=c,m.notificationService=d,m.checkers=[],m.calculators=[],m.fulfillmentHandlers=[],m.testDataUpdated=!1,m.updatePermission=[n.Permission.UpdateSettings,n.Permission.UpdateShippingMethod],m.fetchTestResult$=new l.Subject,m.customFields=m.getCustomFieldConfig("ShippingMethod"),m.detailForm=m.formBuilder.group({code:["",a.Validators.required],name:["",a.Validators.required],description:"",fulfillmentHandler:["",a.Validators.required],checker:{},calculator:{},customFields:m.formBuilder.group(m.customFields.reduce((function(e,t){var n;return Object.assign(Object.assign({},e),((n={})[t.name]="",n))}),{}))}),m}return p(t,e),t.prototype.ngOnInit=function(){var e=this;this.init(),l.combineLatest([this.dataService.shippingMethod.getShippingMethodOperations().single$,this.entity$.pipe(r.take(1))]).subscribe((function(t){var n=f(t,2),r=n[0],a=n[1];e.checkers=r.shippingEligibilityCheckers,e.calculators=r.shippingCalculators,e.fulfillmentHandlers=r.fulfillmentHandlers,e.changeDetector.markForCheck(),e.selectedCheckerDefinition=r.shippingEligibilityCheckers.find((function(e){return e.code===(a.checker&&a.checker.code)})),e.selectedCalculatorDefinition=r.shippingCalculators.find((function(e){return e.code===(a.calculator&&a.calculator.code)}))})),this.activeChannel$=this.dataService.settings.getActiveChannel().mapStream((function(e){return e.activeChannel})),this.testResult$=this.fetchTestResult$.pipe(r.switchMap((function(t){var r=f(t,2),a=r[0],o=r[1];if(!e.selectedChecker||!e.selectedCalculator)return l.of(void 0);var i=e.detailForm.value,s={shippingAddress:Object.assign(Object.assign({},a),{streetLine1:"test"}),lines:o.map((function(e){return{productVariantId:e.id,quantity:e.quantity}})),checker:n.toConfigurableOperationInput(e.selectedChecker,i.checker),calculator:n.toConfigurableOperationInput(e.selectedCalculator,i.calculator)};return e.dataService.shippingMethod.testShippingMethod(s).mapSingle((function(e){return e.testShippingMethod}))}))),l.merge(this.detailForm.get(["checker"]).valueChanges,this.detailForm.get(["calculator"]).valueChanges).pipe(r.takeUntil(this.destroy$)).subscribe((function(){return e.testDataUpdated=!0}))},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.customFieldIsSet=function(e){return!!this.detailForm.get(["customFields",e])},t.prototype.updateCode=function(e,t){if(!e){var n=this.detailForm.get(["code"]);n&&n.pristine&&n.setValue(c.normalizeString(t,"-"))}},t.prototype.selectChecker=function(e){this.selectedCheckerDefinition=e,this.selectedChecker=n.configurableDefinitionToInstance(e);var t=this.detailForm.get("checker");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedChecker)),this.detailForm.markAsDirty()},t.prototype.selectCalculator=function(e){this.selectedCalculatorDefinition=e,this.selectedCalculator=n.configurableDefinitionToInstance(e);var t=this.detailForm.get("calculator");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedCalculator)),this.detailForm.markAsDirty()},t.prototype.create=function(){var e=this,t=this.selectedChecker,a=this.selectedCalculator;t&&a&&l.combineLatest([this.entity$,this.languageCode$]).pipe(r.take(1),r.mergeMap((function(r){var o=f(r,2),i=o[0],s=o[1],l=e.detailForm.value,c=Object.assign(Object.assign({},e.getUpdatedShippingMethod(i,e.detailForm,s)),{checker:n.toConfigurableOperationInput(t,l.checker),calculator:n.toConfigurableOperationInput(a,l.calculator)});return e.dataService.shippingMethod.createShippingMethod(c)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-create-success"),{entity:"ShippingMethod"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createShippingMethod.id],{relativeTo:e.route})}),(function(t){e.notificationService.error(i.marker("common.notify-create-error"),{entity:"ShippingMethod"})}))},t.prototype.save=function(){var e=this,t=this.selectedChecker,a=this.selectedCalculator;t&&a&&l.combineLatest([this.entity$,this.languageCode$]).pipe(r.take(1),r.mergeMap((function(r){var o=f(r,2),i=o[0],s=o[1],l=e.detailForm.value,c=Object.assign(Object.assign({},e.getUpdatedShippingMethod(i,e.detailForm,s)),{checker:n.toConfigurableOperationInput(t,l.checker),calculator:n.toConfigurableOperationInput(a,l.calculator)});return e.dataService.shippingMethod.updateShippingMethod(c)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-update-success"),{entity:"ShippingMethod"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck()}),(function(t){e.notificationService.error(i.marker("common.notify-update-error"),{entity:"ShippingMethod"})}))},t.prototype.setTestOrderLines=function(e){this.testOrderLines=e,this.testDataUpdated=!0},t.prototype.setTestAddress=function(e){this.testAddress=e,this.testDataUpdated=!0},t.prototype.allTestDataPresent=function(){return!!(this.testAddress&&this.testOrderLines&&this.testOrderLines.length&&this.selectedChecker&&this.selectedCalculator)},t.prototype.runTest=function(){this.fetchTestResult$.next([this.testAddress,this.testOrderLines]),this.testDataUpdated=!1},t.prototype.getUpdatedShippingMethod=function(e,t,r){var a=t.value,o=n.createUpdatedTranslatable({translatable:e,updatedFields:a,customFieldConfig:this.customFields,languageCode:r,defaultTranslation:{languageCode:r,name:e.name||"",description:e.description||""}});return Object.assign(Object.assign({},o),{fulfillmentHandler:a.fulfillmentHandler})},t.prototype.setFormValues=function(e,t){var r,a,o,i,s,l,c=n.findTranslation(e,t);if(this.detailForm.patchValue({name:null!==(o=null==c?void 0:c.name)&&void 0!==o?o:"",description:null!==(i=null==c?void 0:c.description)&&void 0!==i?i:"",code:e.code,fulfillmentHandler:e.fulfillmentHandlerCode,checker:e.checker||{},calculator:e.calculator||{}}),this.selectedChecker||(this.selectedChecker=e.checker&&{code:e.checker.code,args:e.checker.args.map((function(e){return Object.assign(Object.assign({},e),{value:n.getConfigArgValue(e.value)})}))}),this.selectedCalculator||(this.selectedCalculator=e.calculator&&{code:null===(s=e.calculator)||void 0===s?void 0:s.code,args:null===(l=e.calculator)||void 0===l?void 0:l.args.map((function(e){return Object.assign(Object.assign({},e),{value:n.getConfigArgValue(e.value)})}))}),this.customFields.length){var d=this.detailForm.get("customFields");try{for(var m=v(this.customFields),u=m.next();!u.done;u=m.next()){var p=u.value,f=p.name,g="localeString"===p.type?c.customFields[f]:e.customFields[f],h=d.get(f);h&&h.patchValue(g)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(a=m.return)&&a.call(m)}finally{if(r)throw r.error}}}},t}(n.BaseDetailComponent);M.decorators=[{type:t.Component,args:[{selector:"vdr-shipping-method-detail",template:'<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]="entity$ | async"></vdr-entity-info>\n        <vdr-language-selector\n            [disabled]="isNew$ | async"\n            [availableLanguageCodes]="availableLanguages$ | async"\n            [currentLanguageCode]="languageCode$ | async"\n            (languageCodeChange)="setLanguage($event)"\n        ></vdr-language-selector>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="shipping-method-detail"></vdr-action-bar-items>\n        <button\n            class="btn btn-primary"\n            *ngIf="isNew$ | async; else updateButton"\n            (click)="create()"\n            [disabled]="detailForm.pristine || detailForm.invalid || !selectedChecker || !selectedCalculator"\n        >\n            {{ \'common.create\' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class="btn btn-primary"\n                (click)="save()"\n                *vdrIfPermissions="updatePermission"\n                [disabled]="\n                    detailForm.pristine || detailForm.invalid || !selectedChecker || !selectedCalculator\n                "\n            >\n                {{ \'common.update\' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class="form" [formGroup]="detailForm" *ngIf="entity$ | async as shippingMethod">\n    <vdr-form-field [label]="\'common.name\' | translate" for="name">\n        <input\n            id="name"\n            type="text"\n            formControlName="name"\n            [readonly]="!(updatePermission | hasPermission)"\n            (input)="updateCode(shippingMethod.code, $event.target.value)"\n        />\n    </vdr-form-field>\n    <vdr-form-field\n        [label]="\'common.code\' | translate"\n        for="code"\n        [readOnlyToggle]="updatePermission | hasPermission"\n    >\n        <input\n            id="code"\n            type="text"\n            formControlName="code"\n            [readonly]="!(updatePermission | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-rich-text-editor\n        formControlName="description"\n        [readonly]="!(updatePermission | hasPermission)"\n        [label]="\'common.description\' | translate"\n    ></vdr-rich-text-editor>\n    <vdr-form-field [label]="\'settings.fulfillment-handler\' | translate" for="fulfillmentHandler" class="mb2">\n        <select\n            name="fulfillmentHandler"\n            formControlName="fulfillmentHandler"\n            [vdrDisabled]="!(updatePermission | hasPermission)"\n        >\n            <option *ngFor="let handler of fulfillmentHandlers" [value]="handler.code">\n                {{ handler.code }}: {{ handler.description }}\n            </option>\n        </select>\n    </vdr-form-field>\n\n    <section formGroupName="customFields" *ngIf="customFields.length">\n        <label>{{ \'common.custom-fields\' | translate }}</label>\n        <ng-container *ngFor="let customField of customFields">\n            <vdr-custom-field-control\n                *ngIf="customFieldIsSet(customField.name)"\n                entityName="ShippingMethod"\n                [customFieldsFormGroup]="detailForm.get(\'customFields\')"\n                [customField]="customField"\n            ></vdr-custom-field-control>\n        </ng-container>\n    </section>\n\n    <div class="clr-row mt4">\n        <div class="clr-col">\n            <label class="clr-control-label">{{ \'settings.shipping-eligibility-checker\' | translate }}</label>\n            <vdr-configurable-input\n                *ngIf="selectedChecker && selectedCheckerDefinition"\n                [operation]="selectedChecker"\n                [operationDefinition]="selectedCheckerDefinition"\n                [readonly]="!(updatePermission | hasPermission)"\n                (remove)="selectedChecker = null"\n                formControlName="checker"\n            ></vdr-configurable-input>\n            <div *ngIf="!selectedChecker || !selectedCheckerDefinition">\n                <vdr-dropdown>\n                    <button class="btn btn-outline" vdrDropdownTrigger>\n                        <clr-icon shape="plus"></clr-icon>\n                        {{ \'common.select\' | translate }}\n                    </button>\n                    <vdr-dropdown-menu vdrPosition="bottom-left">\n                        <button\n                            *ngFor="let checker of checkers"\n                            type="button"\n                            vdrDropdownItem\n                            (click)="selectChecker(checker)"\n                        >\n                            {{ checker.description }}\n                        </button>\n                    </vdr-dropdown-menu>\n                </vdr-dropdown>\n            </div>\n        </div>\n        <div class="clr-col">\n            <label class="clr-control-label">{{ \'settings.shipping-calculator\' | translate }}</label>\n            <vdr-configurable-input\n                *ngIf="selectedCalculator && selectedCalculatorDefinition"\n                [operation]="selectedCalculator"\n                [operationDefinition]="selectedCalculatorDefinition"\n                [readonly]="!(updatePermission | hasPermission)"\n                (remove)="selectedCalculator = null"\n                formControlName="calculator"\n            ></vdr-configurable-input>\n            <div *ngIf="!selectedCalculator || !selectedCalculatorDefinition">\n                <vdr-dropdown>\n                    <button class="btn btn-outline" vdrDropdownTrigger>\n                        <clr-icon shape="plus"></clr-icon>\n                        {{ \'common.select\' | translate }}\n                    </button>\n                    <vdr-dropdown-menu vdrPosition="bottom-left">\n                        <button\n                            *ngFor="let calculator of calculators"\n                            type="button"\n                            vdrDropdownItem\n                            (click)="selectCalculator(calculator)"\n                        >\n                            {{ calculator.description }}\n                        </button>\n                    </vdr-dropdown-menu>\n                </vdr-dropdown>\n            </div>\n        </div>\n    </div>\n</form>\n<div class="testing-tool">\n    <clr-accordion>\n        <clr-accordion-panel>\n            <clr-accordion-title>{{ \'settings.test-shipping-method\' | translate }}</clr-accordion-title>\n            <clr-accordion-content *clrIfExpanded>\n                <div class="clr-row">\n                    <div class="clr-col">\n                        <vdr-test-order-builder\n                            (orderLinesChange)="setTestOrderLines($event)"\n                        ></vdr-test-order-builder>\n                    </div>\n                    <div class="clr-col">\n                        <vdr-test-address-form\n                            (addressChange)="setTestAddress($event)"\n                        ></vdr-test-address-form>\n                        <vdr-shipping-method-test-result\n                            [currencyCode]="(activeChannel$ | async)?.currencyCode"\n                            [okToRun]="allTestDataPresent() && testDataUpdated && detailForm.valid"\n                            [testDataUpdated]="testDataUpdated"\n                            [testResult]="testResult$ | async"\n                            (runTest)="runTest()"\n                        ></vdr-shipping-method-test-result>\n                    </div>\n                </div>\n            </clr-accordion-content>\n        </clr-accordion-panel>\n    </clr-accordion>\n</div>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[".testing-tool{margin-top:48px;margin-bottom:128px}.testing-tool h4{margin-bottom:12px}"]}]}],M.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute},{type:n.ServerConfigService},{type:t.ChangeDetectorRef},{type:n.DataService},{type:a.FormBuilder},{type:n.NotificationService}]};var A=function(e){function t(t,n,r,a,o){var i=e.call(this,a,o)||this;return i.modalService=t,i.notificationService=n,i.dataService=r,i.testDataUpdated=!1,i.fetchTestResult$=new l.Subject,e.prototype.setQueryFn.call(i,(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=i.dataService.shippingMethod).getShippingMethods.apply(e,g(t)).refetchOnChannelChange()}),(function(e){return e.shippingMethods})),i}return p(t,e),t.prototype.ngOnInit=function(){var t=this;e.prototype.ngOnInit.call(this),this.testResult$=this.fetchTestResult$.pipe(r.switchMap((function(e){var n=f(e,2),r=n[0],a=n[1],o={shippingAddress:Object.assign(Object.assign({},r),{streetLine1:"test"}),lines:a.map((function(e){return{productVariantId:e.id,quantity:e.quantity}}))};return t.dataService.shippingMethod.testEligibleShippingMethods(o).mapSingle((function(e){return e.testEligibleShippingMethods}))}))),this.activeChannel$=this.dataService.settings.getActiveChannel().mapStream((function(e){return e.activeChannel}))},t.prototype.deleteShippingMethod=function(e){var t=this;this.modalService.dialog({title:i.marker("catalog.confirm-delete-shipping-method"),buttons:[{type:"secondary",label:i.marker("common.cancel")},{type:"danger",label:i.marker("common.delete"),returnValue:!0}]}).pipe(r.switchMap((function(n){return n?t.dataService.shippingMethod.deleteShippingMethod(e):l.EMPTY}))).subscribe((function(){t.notificationService.success(i.marker("common.notify-delete-success"),{entity:"ShippingMethod"}),t.refresh()}),(function(e){t.notificationService.error(i.marker("common.notify-delete-error"),{entity:"ShippingMethod"})}))},t.prototype.setTestOrderLines=function(e){this.testOrderLines=e,this.testDataUpdated=!0},t.prototype.setTestAddress=function(e){this.testAddress=e,this.testDataUpdated=!0},t.prototype.allTestDataPresent=function(){return!!(this.testAddress&&this.testOrderLines&&this.testOrderLines.length)},t.prototype.runTest=function(){this.fetchTestResult$.next([this.testAddress,this.testOrderLines]),this.testDataUpdated=!1},t}(n.BaseListComponent);A.decorators=[{type:t.Component,args:[{selector:"vdr-shipping-method-list",template:'<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="shipping-method-list"></vdr-action-bar-items>\n        <a class="btn btn-primary" [routerLink]="[\'./create\']" *vdrIfPermissions="[\'CreateSettings\', \'CreateShippingMethod\']">\n            <clr-icon shape="plus"></clr-icon>\n            {{ \'settings.create-new-shipping-method\' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]="items$ | async"\n    [itemsPerPage]="itemsPerPage$ | async"\n    [totalItems]="totalItems$ | async"\n    [currentPage]="currentPage$ | async"\n    (pageChange)="setPageNumber($event)"\n    (itemsPerPageChange)="setItemsPerPage($event)"\n>\n    <vdr-dt-column>{{ \'common.code\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'common.name\' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-shippingMethod="item">\n        <td class="left align-middle">{{ shippingMethod.code }}</td>\n        <td class="left align-middle">{{ shippingMethod.name }}</td>\n        <td class="right align-middle">\n            <vdr-table-row-action\n                iconShape="edit"\n                [label]="\'common.edit\' | translate"\n                [linkTo]="[\'./\', shippingMethod.id]"\n            ></vdr-table-row-action>\n        </td>\n        <td class="right align-middle">\n            <vdr-dropdown>\n                <button type="button" class="btn btn-link btn-sm" vdrDropdownTrigger>\n                    {{ \'common.actions\' | translate }}\n                    <clr-icon shape="caret down"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition="bottom-right">\n                    <button\n                        type="button"\n                        class="delete-button"\n                        (click)="deleteShippingMethod(shippingMethod.id)"\n                        [disabled]="!([\'DeleteSettings\', \'DeleteShippingMethod\'] | hasPermission)"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape="trash" class="is-danger"></clr-icon>\n                        {{ \'common.delete\' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n\n<div class="testing-tool">\n    <clr-accordion>\n        <clr-accordion-panel>\n            <clr-accordion-title>{{ \'settings.test-shipping-methods\' | translate }}</clr-accordion-title>\n            <clr-accordion-content *clrIfExpanded>\n                <div class="clr-row">\n                    <div class="clr-col">\n                        <vdr-test-order-builder\n                            (orderLinesChange)="setTestOrderLines($event)"\n                        ></vdr-test-order-builder>\n                    </div>\n                    <div class="clr-col">\n                        <vdr-test-address-form\n                            (addressChange)="setTestAddress($event)"\n                        ></vdr-test-address-form>\n                        <vdr-shipping-eligibility-test-result\n                            [currencyCode]="(activeChannel$ | async)?.currencyCode"\n                            [okToRun]="allTestDataPresent()"\n                            [testDataUpdated]="testDataUpdated"\n                            [testResult]="testResult$ | async"\n                            (runTest)="runTest()"\n                        ></vdr-shipping-eligibility-test-result>\n                    </div>\n                </div>\n            </clr-accordion-content>\n        </clr-accordion-panel>\n    </clr-accordion>\n</div>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[".testing-tool{margin-top:48px}"]}]}],A.ctorParameters=function(){return[{type:n.ModalService},{type:n.NotificationService},{type:n.DataService},{type:o.Router},{type:o.ActivatedRoute}]};var N=function(){this.okToRun=!1,this.testDataUpdated=!1,this.runTest=new t.EventEmitter};N.decorators=[{type:t.Component,args:[{selector:"vdr-shipping-method-test-result",template:'<div\n    class="test-result card"\n    [ngClass]="{\n        success: testResult?.eligible === true,\n        error: testResult?.eligible === false,\n        unknown: !testResult\n    }"\n>\n    <div class="card-header">\n        {{ \'settings.test-result\' | translate }}\n    </div>\n    <div class="card-block">\n        <div class="result-details" [class.stale]="testDataUpdated">\n            <vdr-labeled-data [label]="\'settings.eligible\' | translate">\n                <div class="eligible-icon">\n                    <clr-icon\n                        shape="success-standard"\n                        class="is-solid success"\n                        *ngIf="testResult?.eligible"\n                    ></clr-icon>\n                    <clr-icon\n                        shape="ban"\n                        class="is-solid error"\n                        *ngIf="testResult?.eligible === false"\n                    ></clr-icon>\n                    <clr-icon shape="unknown-status" *ngIf="!testResult"></clr-icon>\n                </div>\n                {{ testResult?.eligible }}\n            </vdr-labeled-data>\n            <div class="price-row">\n                <vdr-labeled-data\n                    [label]="\'common.price\' | translate"\n                    *ngIf="testResult?.quote?.price != null"\n                >\n                    {{ testResult.quote?.price | localeCurrency: currencyCode }}\n                </vdr-labeled-data>\n                <vdr-labeled-data\n                    [label]="\'common.price-with-tax\' | translate"\n                    *ngIf="testResult?.quote?.priceWithTax != null"\n                >\n                    {{ testResult.quote?.priceWithTax | localeCurrency: currencyCode }}\n                </vdr-labeled-data>\n            </div>\n            <vdr-object-tree\n                *ngIf="testResult?.quote?.metadata"\n                [value]="testResult?.quote?.metadata"\n            ></vdr-object-tree>\n        </div>\n    </div>\n    <div class="card-footer">\n        <button class="btn btn-secondary" (click)="runTest.emit()" [disabled]="!okToRun">\n            {{ \'settings.test-shipping-method\' | translate }}\n        </button>\n    </div>\n</div>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[".test-result.success .card-block{background-color:var(--color-success-100)}.test-result.error .card-block{background-color:var(--color-error-100)}.test-result.unknown .card-block{background-color:var(--color-component-bg-100)}.result-details{transition:opacity .2s}.result-details.stale{opacity:.5}.eligible-icon{display:inline-block}.eligible-icon .success{color:var(--color-success-500)}.eligible-icon .error{color:var(--color-error-500)}.price-row{display:flex}.price-row>:not(:first-child){margin-left:24px}"]}]}],N.propDecorators={testResult:[{type:t.Input}],okToRun:[{type:t.Input}],testDataUpdated:[{type:t.Input}],currencyCode:[{type:t.Input}],runTest:[{type:t.Output}]};var O=function(e){function t(t,r,o,i,s,l,c){var d=e.call(this,r,t,o,s)||this;return d.changeDetector=i,d.dataService=s,d.formBuilder=l,d.notificationService=c,d.updatePermission=[n.Permission.UpdateSettings,n.Permission.UpdateTaxCategory],d.detailForm=d.formBuilder.group({name:["",a.Validators.required],isDefault:!1}),d}return p(t,e),t.prototype.ngOnInit=function(){this.init(),this.taxCategory$=this.entity$},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.saveButtonEnabled=function(){return this.detailForm.dirty&&this.detailForm.valid},t.prototype.create=function(){var e=this;if(this.detailForm.dirty){var t=this.detailForm.value,n={name:t.name,isDefault:t.isDefault};this.dataService.settings.createTaxCategory(n).subscribe((function(t){e.notificationService.success(i.marker("common.notify-create-success"),{entity:"TaxCategory"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createTaxCategory.id],{relativeTo:e.route})}),(function(t){e.notificationService.error(i.marker("common.notify-create-error"),{entity:"TaxCategory"})}))}},t.prototype.save=function(){var e=this;if(this.detailForm.dirty){var t=this.detailForm.value;this.taxCategory$.pipe(r.take(1),r.mergeMap((function(n){var r={id:n.id,name:t.name,isDefault:t.isDefault};return e.dataService.settings.updateTaxCategory(r)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-update-success"),{entity:"TaxCategory"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck()}),(function(t){e.notificationService.error(i.marker("common.notify-update-error"),{entity:"TaxCategory"})}))}},t.prototype.setFormValues=function(e,t){this.detailForm.patchValue({name:e.name,isDefault:e.isDefault})},t}(n.BaseDetailComponent);O.decorators=[{type:t.Component,args:[{selector:"vdr-tax-detail",template:'<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]="entity$ | async"></vdr-entity-info>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="tax-category-detail"></vdr-action-bar-items>\n        <button\n            class="btn btn-primary"\n            *ngIf="isNew$ | async; else updateButton"\n            (click)="create()"\n            [disabled]="!saveButtonEnabled()"\n        >\n            {{ \'common.create\' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class="btn btn-primary"\n                (click)="save()"\n                [disabled]="!saveButtonEnabled()"\n                *vdrIfPermissions="updatePermission"\n            >\n                {{ \'common.update\' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class="form" [formGroup]="detailForm">\n    <vdr-form-field [label]="\'common.name\' | translate" for="name">\n        <input\n            id="name"\n            type="text"\n            formControlName="name"\n            [readonly]="!(updatePermission | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'common.default-tax-category\' | translate" for="isDefault">\n        <clr-toggle-wrapper>\n            <input\n                type="checkbox"\n                clrToggle\n                id="isDefault"\n                [vdrDisabled]="!(updatePermission | hasPermission)"\n                formControlName="isDefault"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n</form>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],O.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute},{type:n.ServerConfigService},{type:t.ChangeDetectorRef},{type:n.DataService},{type:a.FormBuilder},{type:n.NotificationService}]};var $=function(){function e(e,t,n){this.dataService=e,this.notificationService=t,this.modalService=n,this.queryResult=this.dataService.settings.getTaxCategories(),this.taxCategories$=this.queryResult.mapStream((function(e){return e.taxCategories}))}return e.prototype.deleteTaxCategory=function(e){var t=this;return this.modalService.dialog({title:i.marker("settings.confirm-delete-tax-category"),body:e.name,buttons:[{type:"secondary",label:i.marker("common.cancel")},{type:"danger",label:i.marker("common.delete"),returnValue:!0}]}).pipe(r.switchMap((function(n){return n?t.dataService.settings.deleteTaxCategory(e.id):l.EMPTY})),r.map((function(e){return e.deleteTaxCategory}))).subscribe((function(e){e.result===n.DeletionResult.DELETED?(t.notificationService.success(i.marker("common.notify-delete-success"),{entity:"TaxRate"}),t.queryResult.ref.refetch()):t.notificationService.error(e.message||i.marker("common.notify-delete-error"),{entity:"TaxRate"})}),(function(e){t.notificationService.error(i.marker("common.notify-delete-error"),{entity:"TaxRate"})}))},e}();$.decorators=[{type:t.Component,args:[{selector:"vdr-tax-list",template:'<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="tax-category-list"></vdr-action-bar-items>\n        <a class="btn btn-primary" [routerLink]="[\'./create\']" *vdrIfPermissions="[\'CreateSettings\', \'CreateTaxCategory\']">\n            <clr-icon shape="plus"></clr-icon>\n            {{ \'settings.create-new-tax-category\' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table [items]="taxCategories$ | async">\n    <vdr-dt-column>{{ \'common.name\' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-taxCategory="item">\n        <td class="left align-middle">{{ taxCategory.name }}</td>\n        <td class="left align-middle">\n            <vdr-chip *ngIf="taxCategory.isDefault">{{ \'common.default-tax-category\' | translate }}</vdr-chip>\n        </td>\n        <td class="right align-middle">\n            <vdr-table-row-action\n                iconShape="edit"\n                [label]="\'common.edit\' | translate"\n                [linkTo]="[\'./\', taxCategory.id]"\n            ></vdr-table-row-action>\n        </td>\n        <td class="right align-middle">\n            <vdr-dropdown>\n                <button type="button" class="btn btn-link btn-sm" vdrDropdownTrigger>\n                    {{ \'common.actions\' | translate }}\n                    <clr-icon shape="caret down"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition="bottom-right">\n                    <button\n                        type="button"\n                        class="delete-button"\n                        (click)="deleteTaxCategory(taxCategory)"\n                        [disabled]="!([\'DeleteSettings\', \'DeleteTaxCategory\'] | hasPermission)"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape="trash" class="is-danger"></clr-icon>\n                        {{ \'common.delete\' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],$.ctorParameters=function(){return[{type:n.DataService},{type:n.NotificationService},{type:n.ModalService}]};var L=function(e){function t(t,r,o,i,s,l,c){var d=e.call(this,r,t,o,s)||this;return d.changeDetector=i,d.dataService=s,d.formBuilder=l,d.notificationService=c,d.updatePermission=[n.Permission.UpdateSettings,n.Permission.UpdateTaxRate],d.detailForm=d.formBuilder.group({name:["",a.Validators.required],enabled:[!0],value:[0,a.Validators.required],taxCategoryId:[""],zoneId:[""],customerGroupId:[""]}),d}return p(t,e),t.prototype.ngOnInit=function(){this.init(),this.taxCategories$=this.dataService.settings.getTaxCategories().mapSingle((function(e){return e.taxCategories})),this.zones$=this.dataService.settings.getZones().mapSingle((function(e){return e.zones}))},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.saveButtonEnabled=function(){return this.detailForm.dirty&&this.detailForm.valid},t.prototype.create=function(){var e=this;if(this.detailForm.dirty){var t=this.detailForm.value,n={name:t.name,enabled:t.enabled,value:t.value,categoryId:t.taxCategoryId,zoneId:t.zoneId,customerGroupId:t.customerGroupId};this.dataService.settings.createTaxRate(n).subscribe((function(t){e.notificationService.success(i.marker("common.notify-create-success"),{entity:"TaxRate"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createTaxRate.id],{relativeTo:e.route})}),(function(t){e.notificationService.error(i.marker("common.notify-create-error"),{entity:"TaxRate"})}))}},t.prototype.save=function(){var e=this;if(this.detailForm.dirty){var t=this.detailForm.value;this.entity$.pipe(r.take(1),r.mergeMap((function(n){var r={id:n.id,name:t.name,enabled:t.enabled,value:t.value,categoryId:t.taxCategoryId,zoneId:t.zoneId,customerGroupId:t.customerGroupId};return e.dataService.settings.updateTaxRate(r)}))).subscribe((function(t){e.notificationService.success(i.marker("common.notify-update-success"),{entity:"TaxRate"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck()}),(function(t){e.notificationService.error(i.marker("common.notify-update-error"),{entity:"TaxRate"})}))}},t.prototype.setFormValues=function(e,t){this.detailForm.patchValue({name:e.name,enabled:e.enabled,value:e.value,taxCategoryId:e.category?e.category.id:"",zoneId:e.zone?e.zone.id:"",customerGroupId:e.customerGroup?e.customerGroup.id:""})},t}(n.BaseDetailComponent);L.decorators=[{type:t.Component,args:[{selector:"vdr-tax-rate-detail",template:'<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]="entity$ | async"></vdr-entity-info>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="tax-rate-detail"></vdr-action-bar-items>\n        <button\n            class="btn btn-primary"\n            *ngIf="isNew$ | async; else updateButton"\n            (click)="create()"\n            [disabled]="!saveButtonEnabled()"\n        >\n            {{ \'common.create\' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class="btn btn-primary"\n                (click)="save()"\n                [disabled]="!saveButtonEnabled()"\n                *vdrIfPermissions="updatePermission"\n            >\n                {{ \'common.update\' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class="form" [formGroup]="detailForm">\n    <vdr-form-field [label]="\'common.name\' | translate" for="name">\n        <input\n            id="name"\n            type="text"\n            formControlName="name"\n            [readonly]="!(updatePermission | hasPermission)"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]="\'common.enabled\' | translate" for="enabled">\n        <clr-toggle-wrapper>\n            <input\n                type="checkbox"\n                clrToggle\n                id="enabled"\n                formControlName="enabled"\n                [vdrDisabled]="!(updatePermission | hasPermission)"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.rate\' | translate" for="value">\n        <vdr-affixed-input suffix="%">\n            <input\n                id="value"\n                type="number"\n                step="0.1"\n                formControlName="value"\n                [readonly]="!(updatePermission | hasPermission)"\n            />\n        </vdr-affixed-input>\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.tax-category\' | translate" for="taxCategoryId">\n        <select\n            clrSelect\n            name="taxCategoryId"\n            formControlName="taxCategoryId"\n            [vdrDisabled]="!(updatePermission | hasPermission)"\n        >\n            <option *ngFor="let taxCategory of taxCategories$ | async" [value]="taxCategory.id">\n                {{ taxCategory.name }}\n            </option>\n        </select>\n    </vdr-form-field>\n    <vdr-form-field [label]="\'settings.zone\' | translate" for="zoneId">\n        <select\n            clrSelect\n            name="zoneId"\n            formControlName="zoneId"\n            [vdrDisabled]="!(updatePermission | hasPermission)"\n        >\n            <option *ngFor="let zone of zones$ | async" [value]="zone.id">{{ zone.name }}</option>\n        </select>\n    </vdr-form-field>\n</form>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],L.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute},{type:n.ServerConfigService},{type:t.ChangeDetectorRef},{type:n.DataService},{type:a.FormBuilder},{type:n.NotificationService}]};var z=function(e){function t(t,n,r,a,o){var i=e.call(this,a,o)||this;return i.modalService=t,i.notificationService=n,i.dataService=r,e.prototype.setQueryFn.call(i,(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=i.dataService.settings).getTaxRates.apply(e,g(t))}),(function(e){return e.taxRates})),i}return p(t,e),t.prototype.deleteTaxRate=function(e){var t=this;return this.modalService.dialog({title:i.marker("settings.confirm-delete-tax-rate"),body:e.name,buttons:[{type:"secondary",label:i.marker("common.cancel")},{type:"danger",label:i.marker("common.delete"),returnValue:!0}]}).pipe(r.switchMap((function(n){return n?t.dataService.settings.deleteTaxRate(e.id):l.EMPTY})),r.map((function(e){return e.deleteTaxRate}))).subscribe((function(e){e.result===n.DeletionResult.DELETED?(t.notificationService.success(i.marker("common.notify-delete-success"),{entity:"TaxRate"}),t.refresh()):t.notificationService.error(e.message||i.marker("common.notify-delete-error"),{entity:"TaxRate"})}),(function(e){t.notificationService.error(i.marker("common.notify-delete-error"),{entity:"TaxRate"})}))},t}(n.BaseListComponent);z.decorators=[{type:t.Component,args:[{selector:"vdr-tax-rate-list",template:'<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="tax-rate-list"></vdr-action-bar-items>\n        <a class="btn btn-primary" [routerLink]="[\'./create\']" *vdrIfPermissions="[\'CreateSettings\', \'CreateTaxRate\']">\n            <clr-icon shape="plus"></clr-icon>\n            {{ \'settings.create-new-tax-rate\' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]="items$ | async"\n    [itemsPerPage]="itemsPerPage$ | async"\n    [totalItems]="totalItems$ | async"\n    [currentPage]="currentPage$ | async"\n    (pageChange)="setPageNumber($event)"\n    (itemsPerPageChange)="setItemsPerPage($event)"\n>\n    <vdr-dt-column>{{ \'common.name\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'settings.tax-category\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'settings.zone\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'settings.tax-rate\' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-taxRate="item">\n        <td class="left align-middle">{{ taxRate.name }}</td>\n        <td class="left align-middle">{{ taxRate.category.name }}</td>\n        <td class="left align-middle">{{ taxRate.zone.name }}</td>\n        <td class="left align-middle">{{ taxRate.value }}%</td>\n        <td class="right align-middle">\n            <vdr-table-row-action\n                iconShape="edit"\n                [label]="\'common.edit\' | translate"\n                [linkTo]="[\'./\', taxRate.id]"\n            ></vdr-table-row-action>\n        </td>\n        <td class="right align-middle">\n            <vdr-dropdown>\n                <button type="button" class="btn btn-link btn-sm" vdrDropdownTrigger>\n                    {{ \'common.actions\' | translate }}\n                    <clr-icon shape="caret down"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition="bottom-right">\n                    <button\n                        type="button"\n                        class="delete-button"\n                        (click)="deleteTaxRate(taxRate)"\n                        [disabled]="!([\'DeleteSettings\', \'DeleteTaxRate\'] | hasPermission)"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape="trash" class="is-danger"></clr-icon>\n                        {{ \'common.delete\' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}],z.ctorParameters=function(){return[{type:n.ModalService},{type:n.NotificationService},{type:n.DataService},{type:o.Router},{type:o.ActivatedRoute}]};var B=function(){function e(e,n,r){this.formBuilder=e,this.dataService=n,this.localStorageService=r,this.addressChange=new t.EventEmitter}return e.prototype.ngOnInit=function(){var e=this;this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle((function(e){return e.countries.items}));var t=this.localStorageService.getForCurrentLocation("shippingTestAddress"),n=t||{city:"",countryCode:"",postalCode:"",province:""};this.addressChange.emit(n),this.form=this.formBuilder.group(n),this.subscription=this.form.valueChanges.subscribe((function(t){e.localStorageService.setForCurrentLocation("shippingTestAddress",t),e.addressChange.emit(t)}))},e.prototype.ngOnDestroy=function(){this.subscription&&this.subscription.unsubscribe()},e}();B.decorators=[{type:t.Component,args:[{selector:"vdr-test-address-form",template:'<div class="card">\n    <div class="card-header">\n        {{ \'settings.test-address\' | translate }}\n    </div>\n    <div class="card-block">\n        <form [formGroup]="form">\n            <clr-input-container>\n                <label>{{ \'customer.city\' | translate }}</label>\n                <input formControlName="city" type="text" clrInput />\n            </clr-input-container>\n            <clr-input-container>\n                <label>{{ \'customer.province\' | translate }}</label>\n                <input formControlName="province" type="text" clrInput />\n            </clr-input-container>\n            <clr-input-container>\n                <label>{{ \'customer.postal-code\' | translate }}</label>\n                <input formControlName="postalCode" type="text" clrInput />\n            </clr-input-container>\n            <clr-input-container>\n                <label>{{ \'customer.country\' | translate }}</label>\n                <select name="countryCode" formControlName="countryCode" clrInput clrSelect>\n                    <option *ngFor="let country of availableCountries$ | async" [value]="country.code">\n                        {{ country.name }}\n                    </option>\n                </select>\n            </clr-input-container>\n        </form>\n    </div>\n</div>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["clr-input-container{margin-bottom:12px}"]}]}],B.ctorParameters=function(){return[{type:a.FormBuilder},{type:n.DataService},{type:n.LocalStorageService}]},B.propDecorators={addressChange:[{type:t.Output}]};var j=function(){function e(e,n){this.dataService=e,this.localStorageService=n,this.orderLinesChange=new t.EventEmitter,this.lines=[]}return Object.defineProperty(e.prototype,"subTotal",{get:function(){return this.lines.reduce((function(e,t){return e+t.unitPriceWithTax*t.quantity}),0)},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.lines=this.loadFromLocalStorage(),this.lines&&this.orderLinesChange.emit(this.lines),this.dataService.settings.getActiveChannel("cache-first").single$.subscribe((function(t){e.currencyCode=t.activeChannel.currencyCode}))},e.prototype.selectResult=function(e){e&&this.addToLines(e)},e.prototype.addToLines=function(e){var t,n;this.lines.find((function(t){return t.id===e.productVariantId}))||(this.lines.push({id:e.productVariantId,name:e.productVariantName,preview:null!==(n=null===(t=e.productAsset)||void 0===t?void 0:t.preview)&&void 0!==n?n:"",quantity:1,sku:e.sku,unitPriceWithTax:"SinglePrice"===e.priceWithTax.__typename&&e.priceWithTax.value||0}),this.persistToLocalStorage(),this.orderLinesChange.emit(this.lines))},e.prototype.updateQuantity=function(){this.persistToLocalStorage(),this.orderLinesChange.emit(this.lines)},e.prototype.removeLine=function(e){this.lines=this.lines.filter((function(t){return t.id!==e.id})),this.persistToLocalStorage(),this.orderLinesChange.emit(this.lines)},e.prototype.persistToLocalStorage=function(){this.localStorageService.setForCurrentLocation("shippingTestOrder",this.lines)},e.prototype.loadFromLocalStorage=function(){return this.localStorageService.getForCurrentLocation("shippingTestOrder")||[]},e}();j.decorators=[{type:t.Component,args:[{selector:"vdr-test-order-builder",template:'<div class="card">\n    <div class="card-header">\n        {{ \'settings.test-order\' | translate }}\n    </div>\n    <table class="order-table table" *ngIf="lines.length; else emptyPlaceholder">\n        <thead>\n            <tr>\n                <th></th>\n                <th>{{ \'order.product-name\' | translate }}</th>\n                <th>{{ \'order.product-sku\' | translate }}</th>\n                <th>{{ \'order.unit-price\' | translate }}</th>\n                <th>{{ \'order.quantity\' | translate }}</th>\n                <th>{{ \'order.total\' | translate }}</th>\n            </tr>\n        </thead>\n        <tr *ngFor="let line of lines" class="order-line">\n            <td class="align-middle thumb">\n                <img [src]="line.preview + \'?preset=tiny\'" />\n            </td>\n            <td class="align-middle name">{{ line.name }}</td>\n            <td class="align-middle sku">{{ line.sku }}</td>\n            <td class="align-middle unit-price">\n                {{ line.unitPriceWithTax | localeCurrency: currencyCode }}\n            </td>\n            <td class="align-middle quantity">\n                <input\n                    [(ngModel)]="line.quantity"\n                    (change)="updateQuantity()"\n                    type="number"\n                    max="9999"\n                    min="1"\n                />\n                <button class="icon-button" (click)="removeLine(line)">\n                    <clr-icon shape="trash"></clr-icon>\n                </button>\n            </td>\n            <td class="align-middle total">\n                {{ (line.unitPriceWithTax * line.quantity) | localeCurrency: currencyCode }}\n            </td>\n        </tr>\n        <tr class="sub-total">\n            <td class="left">{{ \'order.sub-total\' | translate }}</td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td>{{ subTotal | localeCurrency: currencyCode }}</td>\n        </tr>\n    </table>\n\n    <ng-template #emptyPlaceholder>\n        <div class="card-block empty-placeholder">\n            <div class="empty-text">{{ \'settings.add-products-to-test-order\' | translate }}</div>\n            <clr-icon shape="arrow" dir="down" size="96"></clr-icon>\n        </div>\n    </ng-template>\n    <div class="card-block">\n        <vdr-product-selector (productSelected)="selectResult($event)"> </vdr-product-selector>\n    </div>\n</div>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[".empty-placeholder{color:var(--color-grey-400);text-align:center}.empty-text{font-size:22px}"]}]}],j.ctorParameters=function(){return[{type:n.DataService},{type:n.LocalStorageService}]},j.propDecorators={orderLinesChange:[{type:t.Output}]};var E=function(){function e(){}return e.prototype.cancel=function(){this.resolveWith()},e.prototype.save=function(){this.resolveWith(this.zone.name)},e}();E.decorators=[{type:t.Component,args:[{selector:"vdr-zone-detail-dialog",template:'<ng-template vdrDialogTitle>\n    <span *ngIf="zone.id">{{ \'settings.update-zone\' | translate }}</span>\n    <span *ngIf="!zone.id">{{ \'settings.create-zone\' | translate }}</span>\n</ng-template>\n\n<vdr-form-field [label]="\'common.name\' | translate" for="name">\n    <input id="name" type="text" [(ngModel)]="zone.name" [readonly]="!([\'UpdateSettings\', \'UpdateZone\'] | hasPermission)" />\n</vdr-form-field>\n\n<ng-template vdrDialogButtons>\n    <button type="button" class="btn" (click)="cancel()">{{ \'common.cancel\' | translate }}</button>\n    <button type="submit" (click)="save()" [disabled]="!zone.name" class="btn btn-primary">\n        <span *ngIf="zone.id">{{ \'settings.update-zone\' | translate }}</span>\n        <span *ngIf="!zone.id">{{ \'settings.create-zone\' | translate }}</span>\n    </button>\n</ng-template>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[""]}]}];var V=function(){function e(e,t,n,r,a){this.dataService=e,this.notificationService=t,this.modalService=n,this.route=r,this.router=a,this.selectedMemberIds=[]}return e.prototype.ngOnInit=function(){var e=this;this.zones$=this.dataService.settings.getZones().mapStream((function(e){return e.zones}));var t=this.route.paramMap.pipe(r.map((function(e){return e.get("contents")})),r.distinctUntilChanged(),r.tap((function(){return e.selectedMemberIds=[]})));this.activeZone$=l.combineLatest(this.zones$,t).pipe(r.map((function(e){var t=f(e,2),n=t[0],r=t[1];if(r)return n.find((function(e){return e.id===r}))})))},e.prototype.create=function(){var e=this;this.modalService.fromComponent(E,{locals:{zone:{name:""}}}).pipe(r.switchMap((function(t){return t?e.dataService.settings.createZone({name:t,memberIds:[]}):l.EMPTY})),r.switchMap((function(){return e.dataService.settings.getZones().single$}))).subscribe((function(){e.notificationService.success(i.marker("common.notify-create-success"),{entity:"Zone"})}),(function(t){e.notificationService.error(i.marker("common.notify-create-error"),{entity:"Zone"})}))},e.prototype.delete=function(e){var t=this;this.modalService.dialog({title:i.marker("catalog.confirm-delete-zone"),buttons:[{type:"secondary",label:i.marker("common.cancel")},{type:"danger",label:i.marker("common.delete"),returnValue:!0}]}).pipe(r.switchMap((function(n){return n?t.dataService.settings.deleteZone(e):l.EMPTY})),r.switchMap((function(e){return e.deleteZone.result===n.DeletionResult.DELETED?t.dataService.settings.getZones().mapSingle((function(){return{errorMessage:!1}})):l.of({errorMessage:e.deleteZone.message})}))).subscribe((function(e){"string"==typeof e.errorMessage?t.notificationService.error(e.errorMessage):t.notificationService.success(i.marker("common.notify-delete-success"),{entity:"Zone"})}),(function(e){t.notificationService.error(i.marker("common.notify-delete-error"),{entity:"Zone"})}))},e.prototype.update=function(e){var t=this;this.modalService.fromComponent(E,{locals:{zone:e}}).pipe(r.switchMap((function(n){return n?t.dataService.settings.updateZone({id:e.id,name:n}):l.EMPTY}))).subscribe((function(){t.notificationService.success(i.marker("common.notify-update-success"),{entity:"Zone"})}),(function(e){t.notificationService.error(i.marker("common.notify-update-error"),{entity:"Zone"})}))},e.prototype.closeMembers=function(){var e=Object.assign({},this.route.snapshot.params);delete e.contents,this.router.navigate(["./",e],{relativeTo:this.route,queryParamsHandling:"preserve"})},e.prototype.addToZone=function(e){var t=this;this.modalService.fromComponent(m,{locals:{zoneName:e.name,currentMembers:e.members},size:"md"}).pipe(r.switchMap((function(n){return n?t.dataService.settings.addMembersToZone(e.id,n).pipe(r.mapTo(n)):l.EMPTY}))).subscribe({next:function(n){t.notificationService.success(i.marker("settings.add-countries-to-zone-success"),{countryCount:n.length,zoneName:e.name})},error:function(e){t.notificationService.error(e)}})},e.prototype.removeFromZone=function(e,t){var n=this;this.dataService.settings.removeMembersFromZone(e.id,t).subscribe({complete:function(){n.notificationService.success(i.marker("settings.remove-countries-from-zone-success"),{countryCount:t.length,zoneName:e.name})}})},e}();V.decorators=[{type:t.Component,args:[{selector:"vdr-zone-list",template:'<vdr-action-bar>\n    <vdr-ab-left> </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId="zone-list"></vdr-action-bar-items>\n        <button class="btn btn-primary" *vdrIfPermissions="[\'CreateSettings\', \'CreateZone\']" (click)="create()">\n            <clr-icon shape="plus"></clr-icon>\n            {{ \'settings.create-new-zone\' | translate }}\n        </button>\n    </vdr-ab-right>\n</vdr-action-bar>\n<div class="zone-wrapper">\n    <table class="table zone-list">\n        <tbody>\n            <tr *ngFor="let zone of zones$ | async" [class.active]="zone.id === (activeZone$ | async)?.id">\n                <td class="left align-middle"><vdr-entity-info [entity]="zone"></vdr-entity-info></td>\n                <td class="left align-middle"><vdr-chip [colorFrom]="zone.name">{{ zone.name }}</vdr-chip></td>\n                <td class="text-right align-middle">\n                    <a\n                        class="btn btn-link btn-sm"\n                        [routerLink]="[\'./\', { contents: zone.id }]"\n                        queryParamsHandling="preserve"\n                    >\n                        <clr-icon shape="view-list"></clr-icon>\n                        {{ \'settings.view-zone-members\' | translate }}\n                    </a>\n                </td>\n                <td class="align-middle">\n                    <button class="btn btn-link btn-sm" (click)="update(zone)">\n                        <clr-icon shape="edit"></clr-icon>\n                        {{ \'common.edit\' | translate }}\n                    </button>\n                </td>\n                <td class="align-middle">\n                    <vdr-dropdown>\n                        <button type="button" class="btn btn-link btn-sm" vdrDropdownTrigger>\n                            {{ \'common.actions\' | translate }}\n                            <clr-icon shape="caret down"></clr-icon>\n                        </button>\n                        <vdr-dropdown-menu vdrPosition="bottom-right">\n                            <button\n                                class="button"\n                                vdrDropdownItem\n                                (click)="delete(zone.id)"\n                                [disabled]="!([\'DeleteSettings\', \'DeleteZone\'] | hasPermission)"\n                            >\n                                <clr-icon shape="trash" class="is-danger"></clr-icon>\n                                {{ \'common.delete\' | translate }}\n                            </button>\n                        </vdr-dropdown-menu>\n                    </vdr-dropdown>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    <div class="zone-members" [class.expanded]="activeZone$ | async">\n        <ng-container *ngIf="activeZone$ | async as activeZone">\n            <vdr-zone-member-list\n                [members]="activeZone.members"\n                [selectedMemberIds]="selectedMemberIds"\n                (selectionChange)="selectedMemberIds = $event"\n            >\n                <div *vdrZoneMemberListHeader>\n                    <div class="flex">\n                        <div class="header-title-row">\n                            {{ activeZone.name }} ({{ activeZone.members.length }})\n                        </div>\n                        <div class="flex-spacer"></div>\n                        <button type="button" class="close-button" (click)="closeMembers()">\n                            <clr-icon shape="close"></clr-icon>\n                        </button>\n                    </div>\n                    <div class="controls">\n                        <vdr-dropdown>\n                            <button\n                                type="button"\n                                class="btn btn-secondary btn-sm"\n                                vdrDropdownTrigger\n                                [disabled]="selectedMemberIds.length === 0"\n                            >\n                                {{ \'common.with-selected\' | translate }}\n                                <clr-icon shape="caret down"></clr-icon>\n                            </button>\n                            <vdr-dropdown-menu vdrPosition="bottom-right">\n                                <button\n                                    type="button"\n                                    class="delete-button"\n                                    (click)="removeFromZone(activeZone, selectedMemberIds)"\n                                    vdrDropdownItem\n                                    [disabled]="!([\'UpdateSettings\', \'UpdateZone\'] | hasPermission)"\n                                >\n                                    <clr-icon shape="trash" class="is-danger"></clr-icon>\n                                    {{ \'settings.remove-from-zone\' | translate }}\n                                </button>\n                            </vdr-dropdown-menu>\n                        </vdr-dropdown>\n                        <button class="btn btn-secondary btn-sm" (click)="addToZone(activeZone)">\n                            {{ \'settings.add-countries-to-zone\' | translate: { zoneName: activeZone.name } }}\n                        </button>\n                    </div>\n                </div>\n                <div *vdrZoneMemberControls="let member = member">\n                    <vdr-dropdown>\n                        <button type="button" class="btn btn-link btn-sm" vdrDropdownTrigger>\n                            {{ \'common.actions\' | translate }}\n                            <clr-icon shape="caret down"></clr-icon>\n                        </button>\n                        <vdr-dropdown-menu vdrPosition="bottom-right">\n                            <a\n                                type="button"\n                                [routerLink]="[\'/settings\', \'countries\', member.id]"\n                                vdrDropdownItem\n                            >\n                                <clr-icon shape="edit"></clr-icon>\n                                {{ \'common.edit\' | translate }}\n                            </a>\n                            <button\n                                type="button"\n                                class="delete-button"\n                                (click)="removeFromZone(activeZone, [member.id])"\n                                vdrDropdownItem\n                                [disabled]="!([\'UpdateSettings\', \'UpdateZone\'] | hasPermission)"\n                            >\n                                <clr-icon shape="trash" class="is-danger"></clr-icon>\n                                {{ \'settings.remove-from-zone\' | translate }}\n                            </button>\n                        </vdr-dropdown-menu>\n                    </vdr-dropdown>\n                </div>\n            </vdr-zone-member-list>\n        </ng-container>\n    </div>\n</div>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[".zone-wrapper{display:flex;height:calc(100% - 50px)}.zone-wrapper .zone-list{flex:1;overflow:auto;margin-top:0}.zone-wrapper .zone-list tr.active{background-color:var(--color-component-bg-200)}.zone-members{height:100%;width:0;opacity:0;visibility:hidden;overflow:auto;transition:width .3s,opacity .2s .3s,visibility 0s .3s}.zone-members.expanded{width:40vw;visibility:visible;opacity:1;padding-left:12px}.zone-members .close-button{margin:0;background:none;border:none;cursor:pointer}.zone-members ::ng-deep table.table{margin-top:0}.zone-members ::ng-deep table.table th{top:0}.zone-members .controls{display:flex;justify-content:space-between}"]}]}],V.ctorParameters=function(){return[{type:n.DataService},{type:n.NotificationService},{type:n.ModalService},{type:o.ActivatedRoute},{type:o.Router}]};var Z=function(e){this.templateRef=e};Z.decorators=[{type:t.Directive,args:[{selector:"[vdrZoneMemberControls]"}]}],Z.ctorParameters=function(){return[{type:t.TemplateRef}]};var U=function(e){this.templateRef=e};U.decorators=[{type:t.Directive,args:[{selector:"[vdrZoneMemberListHeader]"}]}],U.ctorParameters=function(){return[{type:t.TemplateRef}]};var q=function(){function e(){var e=this;this.members=[],this.selectedMemberIds=[],this.selectionChange=new t.EventEmitter,this.filterTerm="",this.isMemberSelected=function(t){return-1<e.selectedMemberIds.indexOf(t.id)}}return e.prototype.filteredMembers=function(){if(""!==this.filterTerm){var e=this.filterTerm.toLocaleLowerCase();return this.members.filter((function(t){return t.name.toLocaleLowerCase().includes(e)||t.code.toLocaleLowerCase().includes(e)}))}return this.members},e.prototype.areAllSelected=function(){return!!this.members&&this.selectedMemberIds.length===this.members.length},e.prototype.toggleSelectAll=function(){this.areAllSelected()?this.selectionChange.emit([]):this.selectionChange.emit(this.members.map((function(e){return e.id})))},e.prototype.toggleSelectMember=function(e){this.selectedMemberIds.includes(e.id)?this.selectionChange.emit(this.selectedMemberIds.filter((function(t){return t!==e.id}))):this.selectionChange.emit(g(this.selectedMemberIds,[e.id]))},e}();q.decorators=[{type:t.Component,args:[{selector:"vdr-zone-member-list",template:'<div class="members-header">\n    <ng-container *ngIf="headerTemplate">\n        <ng-container *ngTemplateOutlet="headerTemplate.templateRef"></ng-container>\n    </ng-container>\n    <input\n        type="text"\n        [placeholder]="\'settings.filter-by-member-name\' | translate"\n        [(ngModel)]="filterTerm"\n    />\n</div>\n<vdr-data-table\n    [items]="filteredMembers()"\n    [allSelected]="areAllSelected()"\n    [isRowSelectedFn]="([\'UpdateSettings\', \'UpdateZone\'] | hasPermission) && isMemberSelected"\n    (rowSelectChange)="toggleSelectMember($event)"\n    (allSelectChange)="toggleSelectAll()"\n>\n    <vdr-dt-column>{{ \'common.code\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'common.name\' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ \'common.enabled\' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-member="item">\n        <td class="left align-middle">{{ member.code }}</td>\n        <td class="left align-middle">{{ member.name }}</td>\n        <td class="left align-middle">\n            <clr-icon\n                [class.is-success]="member.enabled"\n                [attr.shape]="member.enabled ? \'check\' : \'times\'"\n            ></clr-icon>\n        </td>\n        <td class="right align-middle">\n            <ng-container *ngIf="controlsTemplate">\n                <ng-container\n                    *ngTemplateOutlet="controlsTemplate.templateRef; context: { member: member }"\n                ></ng-container>\n            </ng-container>\n        </td>\n    </ng-template>\n</vdr-data-table>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[".members-header{background-color:var(--color-component-bg-100);position:sticky;top:0;padding:6px;z-index:5;border-bottom:1px solid var(--color-component-border-200)}.members-header .header-title-row{display:flex;justify-content:space-between;align-items:center}.members-header .clr-input{width:100%}"]}]}],q.propDecorators={members:[{type:t.Input}],selectedMemberIds:[{type:t.Input}],selectionChange:[{type:t.Output}],headerTemplate:[{type:t.ContentChild,args:[U]}],controlsTemplate:[{type:t.ContentChild,args:[Z]}]};var G=function(e){function t(t,n){return e.call(this,t,{__typename:"Administrator",id:"",createdAt:"",updatedAt:"",emailAddress:"",firstName:"",lastName:"",user:{roles:[]}},(function(e){return n.administrator.getAdministrator(e).mapStream((function(e){return e.administrator}))}))||this}return p(t,e),t}(n.BaseEntityResolver);G.Éµprov=t.ÉµÉµdefineInjectable({factory:function(){return new G(t.ÉµÉµinject(o.Router),t.ÉµÉµinject(n.DataService))},token:G,providedIn:"root"}),G.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],G.ctorParameters=function(){return[{type:o.Router},{type:n.DataService}]};var _=function(e){function t(t,r){return e.call(this,t,{__typename:"Channel",id:"",createdAt:"",updatedAt:"",code:"",token:"",pricesIncludeTax:!1,currencyCode:n.CurrencyCode.USD,defaultLanguageCode:n.getDefaultUiLanguage(),defaultShippingZone:{},defaultTaxZone:{}},(function(e){return r.settings.getChannel(e).mapStream((function(e){return e.channel}))}))||this}return p(t,e),t}(n.BaseEntityResolver);_.Éµprov=t.ÉµÉµdefineInjectable({factory:function(){return new _(t.ÉµÉµinject(o.Router),t.ÉµÉµinject(n.DataService))},token:_,providedIn:"root"}),_.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],_.ctorParameters=function(){return[{type:o.Router},{type:n.DataService}]};var H=function(e){function t(t,n){return e.call(this,t,{__typename:"Country",id:"",createdAt:"",updatedAt:"",code:"",name:"",enabled:!1,translations:[]},(function(e){return n.settings.getCountry(e).mapStream((function(e){return e.country}))}))||this}return p(t,e),t}(n.BaseEntityResolver);H.Éµprov=t.ÉµÉµdefineInjectable({factory:function(){return new H(t.ÉµÉµinject(o.Router),t.ÉµÉµinject(n.DataService))},token:H,providedIn:"root"}),H.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],H.ctorParameters=function(){return[{type:o.Router},{type:n.DataService}]};var W=function(e){function t(t,n){return e.call(this,t,{},(function(){return n.settings.getGlobalSettings().mapStream((function(e){return e.globalSettings}))}))||this}return p(t,e),t}(n.BaseEntityResolver);W.Éµprov=t.ÉµÉµdefineInjectable({factory:function(){return new W(t.ÉµÉµinject(o.Router),t.ÉµÉµinject(n.DataService))},token:W,providedIn:"root"}),W.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],W.ctorParameters=function(){return[{type:o.Router},{type:n.DataService}]};var Y=function(e){function t(t,n){return e.call(this,t,{__typename:"PaymentMethod",id:"",createdAt:"",updatedAt:"",name:"",code:"",description:"",enabled:!0,checker:void 0,handler:void 0},(function(e){return n.settings.getPaymentMethod(e).mapStream((function(e){return e.paymentMethod}))}))||this}return p(t,e),t}(n.BaseEntityResolver);Y.Éµprov=t.ÉµÉµdefineInjectable({factory:function(){return new Y(t.ÉµÉµinject(o.Router),t.ÉµÉµinject(n.DataService))},token:Y,providedIn:"root"}),Y.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],Y.ctorParameters=function(){return[{type:o.Router},{type:n.DataService}]};var K=function(e){function t(t,n){return e.call(this,t,{__typename:"Administrator",id:"",createdAt:"",updatedAt:"",emailAddress:"",firstName:"",lastName:"",user:{roles:[]}},(function(e){return n.administrator.getActiveAdministrator().mapStream((function(e){return e.activeAdministrator}))}))||this}return p(t,e),t}(n.BaseEntityResolver);K.Éµprov=t.ÉµÉµdefineInjectable({factory:function(){return new K(t.ÉµÉµinject(o.Router),t.ÉµÉµinject(n.DataService))},token:K,providedIn:"root"}),K.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],K.ctorParameters=function(){return[{type:o.Router},{type:n.DataService}]};var Q=function(e){function t(t,n){return e.call(this,t,{__typename:"Role",id:"",createdAt:"",updatedAt:"",code:"",description:"",permissions:[],channels:[]},(function(e){return n.administrator.getRole(e).mapStream((function(e){return e.role}))}))||this}return p(t,e),t}(n.BaseEntityResolver);Q.Éµprov=t.ÉµÉµdefineInjectable({factory:function(){return new Q(t.ÉµÉµinject(o.Router),t.ÉµÉµinject(n.DataService))},token:Q,providedIn:"root"}),Q.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],Q.ctorParameters=function(){return[{type:o.Router},{type:n.DataService}]};var J=function(e){function t(t,n){return e.call(this,t,{__typename:"ShippingMethod",createdAt:"",updatedAt:"",id:"",code:"",name:"",description:"",fulfillmentHandlerCode:void 0,checker:void 0,calculator:void 0,translations:[]},(function(e){return n.shippingMethod.getShippingMethod(e).mapStream((function(e){return e.shippingMethod}))}))||this}return p(t,e),t}(n.BaseEntityResolver);J.Éµprov=t.ÉµÉµdefineInjectable({factory:function(){return new J(t.ÉµÉµinject(o.Router),t.ÉµÉµinject(n.DataService))},token:J,providedIn:"root"}),J.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],J.ctorParameters=function(){return[{type:o.Router},{type:n.DataService}]};var X=function(e){function t(t,n){return e.call(this,t,{__typename:"TaxCategory",id:"",createdAt:"",updatedAt:"",name:"",isDefault:!1},(function(e){return n.settings.getTaxCategory(e).mapStream((function(e){return e.taxCategory}))}))||this}return p(t,e),t}(n.BaseEntityResolver);X.Éµprov=t.ÉµÉµdefineInjectable({factory:function(){return new X(t.ÉµÉµinject(o.Router),t.ÉµÉµinject(n.DataService))},token:X,providedIn:"root"}),X.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],X.ctorParameters=function(){return[{type:o.Router},{type:n.DataService}]};var ee=function(e){function t(t,n){return e.call(this,t,{__typename:"TaxRate",id:"",createdAt:"",updatedAt:"",name:"",value:0,enabled:!0,category:{},zone:{},customerGroup:null},(function(e){return n.settings.getTaxRate(e).mapStream((function(e){return e.taxRate}))}))||this}return p(t,e),t}(n.BaseEntityResolver);ee.Éµprov=t.ÉµÉµdefineInjectable({factory:function(){return new ee(t.ÉµÉµinject(o.Router),t.ÉµÉµinject(n.DataService))},token:ee,providedIn:"root"}),ee.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],ee.ctorParameters=function(){return[{type:o.Router},{type:n.DataService}]};var te={breadcrumb:i.marker("breadcrumb.profile")},ne={breadcrumb:i.marker("breadcrumb.administrators")},re={breadcrumb:Se},ae={breadcrumb:i.marker("breadcrumb.channels")},oe={breadcrumb:ke},ie={breadcrumb:i.marker("breadcrumb.roles")},se={breadcrumb:De},le={breadcrumb:i.marker("breadcrumb.tax-categories")},ce={breadcrumb:Pe},de={breadcrumb:i.marker("breadcrumb.tax-rates")},me={breadcrumb:Fe},ue={breadcrumb:i.marker("breadcrumb.countries")},pe={breadcrumb:Ie},ve={breadcrumb:i.marker("breadcrumb.zones")},fe={breadcrumb:i.marker("breadcrumb.shipping-methods")},ge={breadcrumb:we},he={breadcrumb:i.marker("breadcrumb.payment-methods")},be={breadcrumb:xe},ye={breadcrumb:i.marker("breadcrumb.global-settings")},Ce=[{path:"profile",component:w,resolve:n.createResolveData(K),canDeactivate:[n.CanDeactivateDetailGuard],data:te},{path:"administrators",component:b,data:ne},{path:"administrators/:id",component:h,resolve:n.createResolveData(G),canDeactivate:[n.CanDeactivateDetailGuard],data:re},{path:"channels",component:C,data:ae},{path:"channels/:id",component:y,resolve:n.createResolveData(_),canDeactivate:[n.CanDeactivateDetailGuard],data:oe},{path:"roles",component:T,data:ie},{path:"roles/:id",component:x,resolve:n.createResolveData(Q),canDeactivate:[n.CanDeactivateDetailGuard],data:se},{path:"tax-categories",component:$,data:le},{path:"tax-categories/:id",component:O,resolve:n.createResolveData(X),canDeactivate:[n.CanDeactivateDetailGuard],data:ce},{path:"tax-rates",component:z,data:de},{path:"tax-rates/:id",component:L,resolve:n.createResolveData(ee),canDeactivate:[n.CanDeactivateDetailGuard],data:me},{path:"countries",component:k,data:ue},{path:"countries/:id",component:S,resolve:n.createResolveData(H),canDeactivate:[n.CanDeactivateDetailGuard],data:pe},{path:"zones",component:V,data:ve},{path:"shipping-methods",component:A,data:fe},{path:"shipping-methods/:id",component:M,resolve:n.createResolveData(J),canDeactivate:[n.CanDeactivateDetailGuard],data:ge},{path:"payment-methods",component:F,data:he},{path:"payment-methods/:id",component:P,resolve:n.createResolveData(Y),canDeactivate:[n.CanDeactivateDetailGuard],data:be},{path:"global-settings",component:D,resolve:n.createResolveData(W),canDeactivate:[n.CanDeactivateDetailGuard],data:ye}];function Se(e,t){return n.detailBreadcrumb({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.administrators",getName:function(e){return e.firstName+" "+e.lastName},route:"administrators"})}function ke(e,t){return n.detailBreadcrumb({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.channels",getName:function(e){return e.code},route:"channels"})}function De(e,t){return n.detailBreadcrumb({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.roles",getName:function(e){return e.description},route:"roles"})}function Pe(e,t){return n.detailBreadcrumb({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.tax-categories",getName:function(e){return e.name},route:"tax-categories"})}function Fe(e,t){return n.detailBreadcrumb({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.tax-rates",getName:function(e){return e.name},route:"tax-rates"})}function Ie(e,t){return n.detailBreadcrumb({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.countries",getName:function(e){return e.name},route:"countries"})}function we(e,t){return n.detailBreadcrumb({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.shipping-methods",getName:function(e){return e.name},route:"shipping-methods"})}function xe(e,t){return n.detailBreadcrumb({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.payment-methods",getName:function(e){return e.code},route:"payment-methods"})}var Te=function(){};Te.decorators=[{type:t.NgModule,args:[{imports:[n.SharedModule,o.RouterModule.forChild(Ce)],declarations:[$,O,b,T,x,h,I,k,S,z,L,C,y,A,M,F,P,D,j,B,N,R,V,m,q,U,Z,E,w]}]}],e.AddCountryToZoneDialogComponent=m,e.AdminDetailComponent=h,e.AdministratorListComponent=b,e.AdministratorResolver=G,e.ChannelDetailComponent=y,e.ChannelListComponent=C,e.ChannelResolver=_,e.CountryDetailComponent=S,e.CountryListComponent=k,e.CountryResolver=H,e.GlobalSettingsComponent=D,e.GlobalSettingsResolver=W,e.PaymentMethodDetailComponent=P,e.PaymentMethodListComponent=F,e.PaymentMethodResolver=Y,e.PermissionGridComponent=I,e.ProfileComponent=w,e.ProfileResolver=K,e.RoleDetailComponent=x,e.RoleListComponent=T,e.RoleResolver=Q,e.SettingsModule=Te,e.ShippingEligibilityTestResultComponent=R,e.ShippingMethodDetailComponent=M,e.ShippingMethodListComponent=A,e.ShippingMethodResolver=J,e.ShippingMethodTestResultComponent=N,e.TaxCategoryDetailComponent=O,e.TaxCategoryListComponent=$,e.TaxCategoryResolver=X,e.TaxRateDetailComponent=L,e.TaxRateListComponent=z,e.TaxRateResolver=ee,e.TestAddressFormComponent=B,e.TestOrderBuilderComponent=j,e.ZoneDetailDialogComponent=E,e.ZoneListComponent=V,e.ZoneMemberControlsDirective=Z,e.ZoneMemberListComponent=q,e.ZoneMemberListHeaderDirective=U,e.administratorBreadcrumb=Se,e.channelBreadcrumb=ke,e.countryBreadcrumb=Ie,e.paymentMethodBreadcrumb=xe,e.roleBreadcrumb=De,e.settingsRoutes=Ce,e.shippingMethodBreadcrumb=we,e.taxCategoryBreadcrumb=Pe,e.taxRateBreadcrumb=Fe,e.Éµ0=te,e.Éµ1=ne,e.Éµ10=me,e.Éµ11=ue,e.Éµ12=pe,e.Éµ13=ve,e.Éµ14=fe,e.Éµ15=ge,e.Éµ16=he,e.Éµ17=be,e.Éµ18=ye,e.Éµ2=re,e.Éµ3=ae,e.Éµ4=oe,e.Éµ5=ie,e.Éµ6=se,e.Éµ7=le,e.Éµ8=ce,e.Éµ9=de,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=vendure-admin-ui-settings.umd.min.js.map