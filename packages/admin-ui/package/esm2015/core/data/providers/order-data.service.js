import { ADD_MANUAL_PAYMENT_TO_ORDER, ADD_NOTE_TO_ORDER, CANCEL_ORDER, CREATE_FULFILLMENT, DELETE_ORDER_NOTE, GET_ORDER, GET_ORDERS_LIST, GET_ORDER_HISTORY, GET_ORDER_SUMMARY, MODIFY_ORDER, REFUND_ORDER, SETTLE_PAYMENT, SETTLE_REFUND, TRANSITION_FULFILLMENT_TO_STATE, TRANSITION_ORDER_TO_STATE, TRANSITION_PAYMENT_TO_STATE, UPDATE_ORDER_CUSTOM_FIELDS, UPDATE_ORDER_NOTE, } from '../definitions/order-definitions';
export class OrderDataService {
    constructor(baseDataService) {
        this.baseDataService = baseDataService;
    }
    getOrders(options = { take: 10 }) {
        return this.baseDataService.query(GET_ORDERS_LIST, {
            options,
        });
    }
    getOrder(id) {
        return this.baseDataService.query(GET_ORDER, { id });
    }
    getOrderHistory(id, options) {
        return this.baseDataService.query(GET_ORDER_HISTORY, {
            id,
            options,
        });
    }
    settlePayment(id) {
        return this.baseDataService.mutate(SETTLE_PAYMENT, {
            id,
        });
    }
    transitionPaymentToState(id, state) {
        return this.baseDataService.mutate(TRANSITION_PAYMENT_TO_STATE, {
            id,
            state,
        });
    }
    createFulfillment(input) {
        return this.baseDataService.mutate(CREATE_FULFILLMENT, {
            input,
        });
    }
    transitionFulfillmentToState(id, state) {
        return this.baseDataService.mutate(TRANSITION_FULFILLMENT_TO_STATE, {
            id,
            state,
        });
    }
    cancelOrder(input) {
        return this.baseDataService.mutate(CANCEL_ORDER, {
            input,
        });
    }
    refundOrder(input) {
        return this.baseDataService.mutate(REFUND_ORDER, {
            input,
        });
    }
    settleRefund(input, orderId) {
        return this.baseDataService.mutate(SETTLE_REFUND, {
            input,
        });
    }
    addNoteToOrder(input) {
        return this.baseDataService.mutate(ADD_NOTE_TO_ORDER, {
            input,
        });
    }
    updateOrderNote(input) {
        return this.baseDataService.mutate(UPDATE_ORDER_NOTE, {
            input,
        });
    }
    deleteOrderNote(id) {
        return this.baseDataService.mutate(DELETE_ORDER_NOTE, {
            id,
        });
    }
    transitionToState(id, state) {
        return this.baseDataService.mutate(TRANSITION_ORDER_TO_STATE, {
            id,
            state,
        });
    }
    updateOrderCustomFields(input) {
        return this.baseDataService.mutate(UPDATE_ORDER_CUSTOM_FIELDS, {
            input,
        });
    }
    getOrderSummary(start, end) {
        return this.baseDataService.query(GET_ORDER_SUMMARY, {
            start: start.toISOString(),
            end: end.toISOString(),
        });
    }
    modifyOrder(input) {
        return this.baseDataService.mutate(MODIFY_ORDER, {
            input,
        });
    }
    addManualPaymentToOrder(input) {
        return this.baseDataService.mutate(ADD_MANUAL_PAYMENT_TO_ORDER, { input });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3JkZXItZGF0YS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9jb3JlL3NyYy9kYXRhL3Byb3ZpZGVycy9vcmRlci1kYXRhLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBK0JBLE9BQU8sRUFDSCwyQkFBMkIsRUFDM0IsaUJBQWlCLEVBQ2pCLFlBQVksRUFDWixrQkFBa0IsRUFDbEIsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxlQUFlLEVBQ2YsaUJBQWlCLEVBQ2pCLGlCQUFpQixFQUNqQixZQUFZLEVBQ1osWUFBWSxFQUNaLGNBQWMsRUFDZCxhQUFhLEVBQ2IsK0JBQStCLEVBQy9CLHlCQUF5QixFQUN6QiwyQkFBMkIsRUFDM0IsMEJBQTBCLEVBQzFCLGlCQUFpQixHQUNwQixNQUFNLGtDQUFrQyxDQUFDO0FBSTFDLE1BQU0sT0FBTyxnQkFBZ0I7SUFDekIsWUFBb0IsZUFBZ0M7UUFBaEMsb0JBQWUsR0FBZixlQUFlLENBQWlCO0lBQUcsQ0FBQztJQUV4RCxTQUFTLENBQUMsVUFBNEIsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFO1FBQzlDLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQTZDLGVBQWUsRUFBRTtZQUMzRixPQUFPO1NBQ1YsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVELFFBQVEsQ0FBQyxFQUFVO1FBQ2YsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBcUMsU0FBUyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUM3RixDQUFDO0lBRUQsZUFBZSxDQUFDLEVBQVUsRUFBRSxPQUFpQztRQUN6RCxPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUM3QixpQkFBaUIsRUFDakI7WUFDSSxFQUFFO1lBQ0YsT0FBTztTQUNWLENBQ0osQ0FBQztJQUNOLENBQUM7SUFFRCxhQUFhLENBQUMsRUFBVTtRQUNwQixPQUFPLElBQUks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XG4gICAgQWRkTWFudWFsUGF5bWVudCxcbiAgICBBZGROb3RlVG9PcmRlcixcbiAgICBBZGROb3RlVG9PcmRlcklucHV0LFxuICAgIENhbmNlbE9yZGVyLFxuICAgIENhbmNlbE9yZGVySW5wdXQsXG4gICAgQ3JlYXRlRnVsZmlsbG1lbnQsXG4gICAgRGVsZXRlT3JkZXJOb3RlLFxuICAgIEZ1bGZpbGxPcmRlcklucHV0LFxuICAgIEdldE9yZGVyLFxuICAgIEdldE9yZGVySGlzdG9yeSxcbiAgICBHZXRPcmRlckxpc3QsXG4gICAgR2V0T3JkZXJTdW1tYXJ5LFxuICAgIEhpc3RvcnlFbnRyeUxpc3RPcHRpb25zLFxuICAgIE1hbnVhbFBheW1lbnRJbnB1dCxcbiAgICBNb2RpZnlPcmRlcixcbiAgICBNb2RpZnlPcmRlcklucHV0LFxuICAgIE9yZGVyTGlzdE9wdGlvbnMsXG4gICAgUmVmdW5kT3JkZXIsXG4gICAgUmVmdW5kT3JkZXJJbnB1dCxcbiAgICBTZXR0bGVQYXltZW50LFxuICAgIFNldHRsZVJlZnVuZCxcbiAgICBTZXR0bGVSZWZ1bmRJbnB1dCxcbiAgICBUcmFuc2l0aW9uRnVsZmlsbG1lbnRUb1N0YXRlLFxuICAgIFRyYW5zaXRpb25PcmRlclRvU3RhdGUsXG4gICAgVHJhbnNpdGlvblBheW1lbnRUb1N0YXRlLFxuICAgIFVwZGF0ZU9yZGVyQ3VzdG9tRmllbGRzLFxuICAgIFVwZGF0ZU9yZGVySW5wdXQsXG4gICAgVXBkYXRlT3JkZXJOb3RlLFxuICAgIFVwZGF0ZU9yZGVyTm90ZUlucHV0LFxufSBmcm9tICcuLi8uLi9jb21tb24vZ2VuZXJhdGVkLXR5cGVzJztcbmltcG9ydCB7XG4gICAgQUREX01BTlVBTF9QQVlNRU5UX1RPX09SREVSLFxuICAgIEFERF9OT1RFX1RPX09SREVSLFxuICAgIENBTkNFTF9PUkRFUixcbiAgICBDUkVBVEVfRlVMRklMTE1FTlQsXG4gICAgREVMRVRFX09SREVSX05PVEUsXG4gICAgR0VUX09SREVSLFxuICAgIEdFVF9PUkRFUlNfTElTVCxcbiAgICBHRVRfT1JERVJfSElTVE9SWSxcbiAgICBHRVRfT1JERVJfU1VNTUFSWSxcbiAgICBNT0RJRllfT1JERVIsXG4gICAgUkVGVU5EX09SREVSLFxuICAgIFNFVFRMRV9QQVlNRU5ULFxuICAgIFNFVFRMRV9SRUZVTkQsXG4gICAgVFJBTlNJVElPTl9GVUxGSUxMTUVOVF9UT19TVEFURSxcbiAgICBUUkFOU0lUSU9OX09SREVSX1RPX1NUQVRFLFxuICAgIFRSQU5TSVRJT05fUEFZTUVOVF9UT19TVEFURSxcbiAgICBVUERBVEVfT1JERVJfQ1VTVE9NX0ZJRUxEUyxcbiAgICBVUERBVEVfT1JERVJfTk9URSxcbn0gZnJvbSAnLi4vZGVmaW5pdGlvbnMvb3JkZXItZGVmaW5pdGlvbnMnO1xuXG5pbXBvcnQgeyBCYXNlRGF0YVNlcnZpY2UgfSBmcm9tICcuL2Jhc2UtZGF0YS5zZXJ2aWNlJztcblxuZXhwb3J0IGNsYXNzIE9yZGVyRGF0YVNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgYmFzZURhdGFTZXJ2aWNlOiBCYXNlRGF0YVNlcnZpY2UpIHt9XG5cbiAgICBnZXRPcmRlcnMob3B0aW9uczogT3JkZXJMaXN0T3B0aW9ucyA9IHsgdGFrZTogMTAgfSkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UucXVlcnk8R2V0T3JkZXJMaXN0LlF1ZXJ5LCBHZXRPcmRlckxpc3QuVmFyaWFibGVzPihHRVRfT1JERVJTX0xJU1QsIHtcbiAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldE9yZGVyKGlkOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLnF1ZXJ5PEdldE9yZGVyLlF1ZXJ5LCBHZXRPcmRlci5WYXJpYWJsZXM+KEdFVF9PUkRFUiwgeyBpZCB9KTtcbiAgICB9XG5cbiAgICBnZXRPcmRlckhpc3RvcnkoaWQ6IHN0cmluZywgb3B0aW9ucz86IEhpc3RvcnlFbnRyeUxpc3RPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5xdWVyeTxHZXRPcmRlckhpc3RvcnkuUXVlcnksIEdldE9yZGVySGlzdG9yeS5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgR0VUX09SREVSX0hJU1RPUlksXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgc2V0dGxlUGF5bWVudChpZDogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8U2V0dGxlUGF5bWVudC5NdXRhdGlvbiwgU2V0dGxlUGF5bWVudC5WYXJpYWJsZXM+KFNFVFRMRV9QQVlNRU5ULCB7XG4gICAgICAgICAgICBpZCxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdHJhbnNpdGlvblBheW1lbnRUb1N0YXRlKGlkOiBzdHJpbmcsIHN0YXRlOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxcbiAgICAgICAgICAgIFRyYW5zaXRpb25QYXltZW50VG9TdGF0ZS5NdXRhdGlvbixcbiAgICAgICAgICAgIFRyYW5zaXRpb25QYXltZW50VG9TdGF0ZS5WYXJpYWJsZXNcbiAgICAgICAgPihUUkFOU0lUSU9OX1BBWU1FTlRfVE9fU1RBVEUsIHtcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgc3RhdGUsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNyZWF0ZUZ1bGZpbGxtZW50KGlucHV0OiBGdWxmaWxsT3JkZXJJbnB1dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPENyZWF0ZUZ1bGZpbGxtZW50Lk11dGF0aW9uLCBDcmVhdGVGdWxmaWxsbWVudC5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgQ1JFQVRFX0ZVTEZJTExNRU5ULFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICB0cmFuc2l0aW9uRnVsZmlsbG1lbnRUb1N0YXRlKGlkOiBzdHJpbmcsIHN0YXRlOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxcbiAgICAgICAgICAgIFRyYW5zaXRpb25GdWxmaWxsbWVudFRvU3RhdGUuTXV0YXRpb24sXG4gICAgICAgICAgICBUcmFuc2l0aW9uRnVsZmlsbG1lbnRUb1N0YXRlLlZhcmlhYmxlc1xuICAgICAgICA+KFRSQU5TSVRJT05fRlVMRklMTE1FTlRfVE9fU1RBVEUsIHtcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgc3RhdGUsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNhbmNlbE9yZGVyKGlucHV0OiBDYW5jZWxPcmRlcklucHV0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8Q2FuY2VsT3JkZXIuTXV0YXRpb24sIENhbmNlbE9yZGVyLlZhcmlhYmxlcz4oQ0FOQ0VMX09SREVSLCB7XG4gICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVmdW5kT3JkZXIoaW5wdXQ6IFJlZnVuZE9yZGVySW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxSZWZ1bmRPcmRlci5NdXRhdGlvbiwgUmVmdW5kT3JkZXIuVmFyaWFibGVzPihSRUZVTkRfT1JERVIsIHtcbiAgICAgICAgICAgIGlucHV0LFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZXR0bGVSZWZ1bmQoaW5wdXQ6IFNldHRsZVJlZnVuZElucHV0LCBvcmRlcklkOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxTZXR0bGVSZWZ1bmQuTXV0YXRpb24sIFNldHRsZVJlZnVuZC5WYXJpYWJsZXM+KFNFVFRMRV9SRUZVTkQsIHtcbiAgICAgICAgICAgIGlucHV0LFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhZGROb3RlVG9PcmRlcihpbnB1dDogQWRkTm90ZVRvT3JkZXJJbnB1dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPEFkZE5vdGVUb09yZGVyLk11dGF0aW9uLCBBZGROb3RlVG9PcmRlci5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgQUREX05PVEVfVE9fT1JERVIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5wdXQsXG4gICAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHVwZGF0ZU9yZGVyTm90ZShpbnB1dDogVXBkYXRlT3JkZXJOb3RlSW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxVcGRhdGVPcmRlck5vdGUuTXV0YXRpb24sIFVwZGF0ZU9yZGVyTm90ZS5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgVVBEQVRFX09SREVSX05PVEUsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5wdXQsXG4gICAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgIH1cblxuICAgIGRlbGV0ZU9yZGVyTm90ZShpZDogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8RGVsZXRlT3JkZXJOb3RlLk11dGF0aW9uLCBEZWxldGVPcmRlck5vdGUuVmFyaWFibGVzPihcbiAgICAgICAgICAgIERFTEVURV9PUkRFUl9OT1RFLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICB0cmFuc2l0aW9uVG9TdGF0ZShpZDogc3RyaW5nLCBzdGF0ZTogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8VHJhbnNpdGlvbk9yZGVyVG9TdGF0ZS5NdXRhdGlvbiwgVHJhbnNpdGlvbk9yZGVyVG9TdGF0ZS5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgVFJBTlNJVElPTl9PUkRFUl9UT19TVEFURSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICBzdGF0ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgdXBkYXRlT3JkZXJDdXN0b21GaWVsZHMoaW5wdXQ6IFVwZGF0ZU9yZGVySW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxcbiAgICAgICAgICAgIFVwZGF0ZU9yZGVyQ3VzdG9tRmllbGRzLk11dGF0aW9uLFxuICAgICAgICAgICAgVXBkYXRlT3JkZXJDdXN0b21GaWVsZHMuVmFyaWFibGVzXG4gICAgICAgID4oVVBEQVRFX09SREVSX0NVU1RPTV9GSUVMRFMsIHtcbiAgICAgICAgICAgIGlucHV0LFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBnZXRPcmRlclN1bW1hcnkoc3RhcnQ6IERhdGUsIGVuZDogRGF0ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UucXVlcnk8R2V0T3JkZXJTdW1tYXJ5LlF1ZXJ5LCBHZXRPcmRlclN1bW1hcnkuVmFyaWFibGVzPihcbiAgICAgICAgICAgIEdFVF9PUkRFUl9TVU1NQVJZLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBzdGFydC50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgIGVuZDogZW5kLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgIH1cblxuICAgIG1vZGlmeU9yZGVyKGlucHV0OiBNb2RpZnlPcmRlcklucHV0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8TW9kaWZ5T3JkZXIuTXV0YXRpb24sIE1vZGlmeU9yZGVyLlZhcmlhYmxlcz4oTU9ESUZZX09SREVSLCB7XG4gICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWRkTWFudWFsUGF5bWVudFRvT3JkZXIoaW5wdXQ6IE1hbnVhbFBheW1lbnRJbnB1dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPEFkZE1hbnVhbFBheW1lbnQuTXV0YXRpb24sIEFkZE1hbnVhbFBheW1lbnQuVmFyaWFibGVzPihcbiAgICAgICAgICAgIEFERF9NQU5VQUxfUEFZTUVOVF9UT19PUkRFUixcbiAgICAgICAgICAgIHsgaW5wdXQgfSxcbiAgICAgICAgKTtcbiAgICB9XG59XG4iXX0=