(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"Tn/u":function(e,t,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageCode=t.HistoryEntryType=t.CurrencyCode=t.LogicalOperator=t.ErrorCode=t.SortOrder=t.Permission=t.DeletionResult=t.AdjustmentType=t.GlobalFlag=t.AssetType=void 0,function(e){e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.BINARY="BINARY"}(t.AssetType||(t.AssetType={})),function(e){e.TRUE="TRUE",e.FALSE="FALSE",e.INHERIT="INHERIT"}(t.GlobalFlag||(t.GlobalFlag={})),function(e){e.PROMOTION="PROMOTION",e.DISTRIBUTED_ORDER_PROMOTION="DISTRIBUTED_ORDER_PROMOTION"}(t.AdjustmentType||(t.AdjustmentType={})),function(e){e.DELETED="DELETED",e.NOT_DELETED="NOT_DELETED"}(t.DeletionResult||(t.DeletionResult={})),function(e){e.Authenticated="Authenticated",e.SuperAdmin="SuperAdmin",e.Owner="Owner",e.Public="Public",e.UpdateGlobalSettings="UpdateGlobalSettings",e.CreateCatalog="CreateCatalog",e.ReadCatalog="ReadCatalog",e.UpdateCatalog="UpdateCatalog",e.DeleteCatalog="DeleteCatalog",e.CreateSettings="CreateSettings",e.ReadSettings="ReadSettings",e.UpdateSettings="UpdateSettings",e.DeleteSettings="DeleteSettings",e.CreateAdministrator="CreateAdministrator",e.ReadAdministrator="ReadAdministrator",e.UpdateAdministrator="UpdateAdministrator",e.DeleteAdministrator="DeleteAdministrator",e.CreateAsset="CreateAsset",e.ReadAsset="ReadAsset",e.UpdateAsset="UpdateAsset",e.DeleteAsset="DeleteAsset",e.CreateChannel="CreateChannel",e.ReadChannel="ReadChannel",e.UpdateChannel="UpdateChannel",e.DeleteChannel="DeleteChannel",e.CreateCollection="CreateCollection",e.ReadCollection="ReadCollection",e.UpdateCollection="UpdateCollection",e.DeleteCollection="DeleteCollection",e.CreateCountry="CreateCountry",e.ReadCountry="ReadCountry",e.UpdateCountry="UpdateCountry",e.DeleteCountry="DeleteCountry",e.CreateCustomer="CreateCustomer",e.ReadCustomer="ReadCustomer",e.UpdateCustomer="UpdateCustomer",e.DeleteCustomer="DeleteCustomer",e.CreateCustomerGroup="CreateCustomerGroup",e.ReadCustomerGroup="ReadCustomerGroup",e.UpdateCustomerGroup="UpdateCustomerGroup",e.DeleteCustomerGroup="DeleteCustomerGroup",e.CreateFacet="CreateFacet",e.ReadFacet="ReadFacet",e.UpdateFacet="UpdateFacet",e.DeleteFacet="DeleteFacet",e.CreateOrder="CreateOrder",e.ReadOrder="ReadOrder",e.UpdateOrder="UpdateOrder",e.DeleteOrder="DeleteOrder",e.CreatePaymentMethod="CreatePaymentMethod",e.ReadPaymentMethod="ReadPaymentMethod",e.UpdatePaymentMethod="UpdatePaymentMethod",e.DeletePaymentMethod="DeletePaymentMethod",e.CreateProduct="CreateProduct",e.ReadProduct="ReadProduct",e.UpdateProduct="UpdateProduct",e.DeleteProduct="DeleteProduct",e.CreatePromotion="CreatePromotion",e.ReadPromotion="ReadPromotion",e.UpdatePromotion="UpdatePromotion",e.DeletePromotion="DeletePromotion",e.CreateShippingMethod="CreateShippingMethod",e.ReadShippingMethod="ReadShippingMethod",e.UpdateShippingMethod="UpdateShippingMethod",e.DeleteShippingMethod="DeleteShippingMethod",e.CreateTag="CreateTag",e.ReadTag="ReadTag",e.UpdateTag="UpdateTag",e.DeleteTag="DeleteTag",e.CreateTaxCategory="CreateTaxCategory",e.ReadTaxCategory="ReadTaxCategory",e.UpdateTaxCategory="UpdateTaxCategory",e.DeleteTaxCategory="DeleteTaxCategory",e.CreateTaxRate="CreateTaxRate",e.ReadTaxRate="ReadTaxRate",e.UpdateTaxRate="UpdateTaxRate",e.DeleteTaxRate="DeleteTaxRate",e.CreateSystem="CreateSystem",e.ReadSystem="ReadSystem",e.UpdateSystem="UpdateSystem",e.DeleteSystem="DeleteSystem",e.CreateZone="CreateZone",e.ReadZone="ReadZone",e.UpdateZone="UpdateZone",e.DeleteZone="DeleteZone"}(t.Permission||(t.Permission={})),function(e){e.ASC="ASC",e.DESC="DESC"}(t.SortOrder||(t.SortOrder={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.NATIVE_AUTH_STRATEGY_ERROR="NATIVE_AUTH_STRATEGY_ERROR",e.INVALID_CREDENTIALS_ERROR="INVALID_CREDENTIALS_ERROR",e.ORDER_STATE_TRANSITION_ERROR="ORDER_STATE_TRANSITION_ERROR",e.EMAIL_ADDRESS_CONFLICT_ERROR="EMAIL_ADDRESS_CONFLICT_ERROR",e.ORDER_LIMIT_ERROR="ORDER_LIMIT_ERROR",e.NEGATIVE_QUANTITY_ERROR="NEGATIVE_QUANTITY_ERROR",e.INSUFFICIENT_STOCK_ERROR="INSUFFICIENT_STOCK_ERROR",e.ORDER_MODIFICATION_ERROR="ORDER_MODIFICATION_ERROR",e.INELIGIBLE_SHIPPING_METHOD_ERROR="INELIGIBLE_SHIPPING_METHOD_ERROR",e.ORDER_PAYMENT_STATE_ERROR="ORDER_PAYMENT_STATE_ERROR",e.INELIGIBLE_PAYMENT_METHOD_ERROR="INELIGIBLE_PAYMENT_METHOD_ERROR",e.PAYMENT_FAILED_ERROR="PAYMENT_FAILED_ERROR",e.PAYMENT_DECLINED_ERROR="PAYMENT_DECLINED_ERROR",e.COUPON_CODE_INVALID_ERROR="COUPON_CODE_INVALID_ERROR",e.COUPON_CODE_EXPIRED_ERROR="COUPON_CODE_EXPIRED_ERROR",e.COUPON_CODE_LIMIT_ERROR="COUPON_CODE_LIMIT_ERROR",e.ALREADY_LOGGED_IN_ERROR="ALREADY_LOGGED_IN_ERROR",e.MISSING_PASSWORD_ERROR="MISSING_PASSWORD_ERROR",e.PASSWORD_ALREADY_SET_ERROR="PASSWORD_ALREADY_SET_ERROR",e.VERIFICATION_TOKEN_INVALID_ERROR="VERIFICATION_TOKEN_INVALID_ERROR",e.VERIFICATION_TOKEN_EXPIRED_ERROR="VERIFICATION_TOKEN_EXPIRED_ERROR",e.IDENTIFIER_CHANGE_TOKEN_INVALID_ERROR="IDENTIFIER_CHANGE_TOKEN_INVALID_ERROR",e.IDENTIFIER_CHANGE_TOKEN_EXPIRED_ERROR="IDENTIFIER_CHANGE_TOKEN_EXPIRED_ERROR",e.PASSWORD_RESET_TOKEN_INVALID_ERROR="PASSWORD_RESET_TOKEN_INVALID_ERROR",e.PASSWORD_RESET_TOKEN_EXPIRED_ERROR="PASSWORD_RESET_TOKEN_EXPIRED_ERROR",e.NOT_VERIFIED_ERROR="NOT_VERIFIED_ERROR",e.NO_ACTIVE_ORDER_ERROR="NO_ACTIVE_ORDER_ERROR"}(t.ErrorCode||(t.ErrorCode={})),function(e){e.AND="AND",e.OR="OR"}(t.LogicalOperator||(t.LogicalOperator={})),function(e){e.AED="AED",e.AFN="AFN",e.ALL="ALL",e.AMD="AMD",e.ANG="ANG",e.AOA="AOA",e.ARS="ARS",e.AUD="AUD",e.AWG="AWG",e.AZN="AZN",e.BAM="BAM",e.BBD="BBD",e.BDT="BDT",e.BGN="BGN",e.BHD="BHD",e.BIF="BIF",e.BMD="BMD",e.BND="BND",e.BOB="BOB",e.BRL="BRL",e.BSD="BSD",e.BTN="BTN",e.BWP="BWP",e.BYN="BYN",e.BZD="BZD",e.CAD="CAD",e.CDF="CDF",e.CHF="CHF",e.CLP="CLP",e.CNY="CNY",e.COP="COP",e.CRC="CRC",e.CUC="CUC",e.CUP="CUP",e.CVE="CVE",e.CZK="CZK",e.DJF="DJF",e.DKK="DKK",e.DOP="DOP",e.DZD="DZD",e.EGP="EGP",e.ERN="ERN",e.ETB="ETB",e.EUR="EUR",e.FJD="FJD",e.FKP="FKP",e.GBP="GBP",e.GEL="GEL",e.GHS="GHS",e.GIP="GIP",e.GMD="GMD",e.GNF="GNF",e.GTQ="GTQ",e.GYD="GYD",e.HKD="HKD",e.HNL="HNL",e.HRK="HRK",e.HTG="HTG",e.HUF="HUF",e.IDR="IDR",e.ILS="ILS",e.INR="INR",e.IQD="IQD",e.IRR="IRR",e.ISK="ISK",e.JMD="JMD",e.JOD="JOD",e.JPY="JPY",e.KES="KES",e.KGS="KGS",e.KHR="KHR",e.KMF="KMF",e.KPW="KPW",e.KRW="KRW",e.KWD="KWD",e.KYD="KYD",e.KZT="KZT",e.LAK="LAK",e.LBP="LBP",e.LKR="LKR",e.LRD="LRD",e.LSL="LSL",e.LYD="LYD",e.MAD="MAD",e.MDL="MDL",e.MGA="MGA",e.MKD="MKD",e.MMK="MMK",e.MNT="MNT",e.MOP="MOP",e.MRU="MRU",e.MUR="MUR",e.MVR="MVR",e.MWK="MWK",e.MXN="MXN",e.MYR="MYR",e.MZN="MZN",e.NAD="NAD",e.NGN="NGN",e.NIO="NIO",e.NOK="NOK",e.NPR="NPR",e.NZD="NZD",e.OMR="OMR",e.PAB="PAB",e.PEN="PEN",e.PGK="PGK",e.PHP="PHP",e.PKR="PKR",e.PLN="PLN",e.PYG="PYG",e.QAR="QAR",e.RON="RON",e.RSD="RSD",e.RUB="RUB",e.RWF="RWF",e.SAR="SAR",e.SBD="SBD",e.SCR="SCR",e.SDG="SDG",e.SEK="SEK",e.SGD="SGD",e.SHP="SHP",e.SLL="SLL",e.SOS="SOS",e.SRD="SRD",e.SSP="SSP",e.STN="STN",e.SVC="SVC",e.SYP="SYP",e.SZL="SZL",e.THB="THB",e.TJS="TJS",e.TMT="TMT",e.TND="TND",e.TOP="TOP",e.TRY="TRY",e.TTD="TTD",e.TWD="TWD",e.TZS="TZS",e.UAH="UAH",e.UGX="UGX",e.USD="USD",e.UYU="UYU",e.UZS="UZS",e.VES="VES",e.VND="VND",e.VUV="VUV",e.WST="WST",e.XAF="XAF",e.XCD="XCD",e.XOF="XOF",e.XPF="XPF",e.YER="YER",e.ZAR="ZAR",e.ZMW="ZMW",e.ZWL="ZWL"}(t.CurrencyCode||(t.CurrencyCode={})),function(e){e.CUSTOMER_REGISTERED="CUSTOMER_REGISTERED",e.CUSTOMER_VERIFIED="CUSTOMER_VERIFIED",e.CUSTOMER_DETAIL_UPDATED="CUSTOMER_DETAIL_UPDATED",e.CUSTOMER_ADDED_TO_GROUP="CUSTOMER_ADDED_TO_GROUP",e.CUSTOMER_REMOVED_FROM_GROUP="CUSTOMER_REMOVED_FROM_GROUP",e.CUSTOMER_ADDRESS_CREATED="CUSTOMER_ADDRESS_CREATED",e.CUSTOMER_ADDRESS_UPDATED="CUSTOMER_ADDRESS_UPDATED",e.CUSTOMER_ADDRESS_DELETED="CUSTOMER_ADDRESS_DELETED",e.CUSTOMER_PASSWORD_UPDATED="CUSTOMER_PASSWORD_UPDATED",e.CUSTOMER_PASSWORD_RESET_REQUESTED="CUSTOMER_PASSWORD_RESET_REQUESTED",e.CUSTOMER_PASSWORD_RESET_VERIFIED="CUSTOMER_PASSWORD_RESET_VERIFIED",e.CUSTOMER_EMAIL_UPDATE_REQUESTED="CUSTOMER_EMAIL_UPDATE_REQUESTED",e.CUSTOMER_EMAIL_UPDATE_VERIFIED="CUSTOMER_EMAIL_UPDATE_VERIFIED",e.CUSTOMER_NOTE="CUSTOMER_NOTE",e.ORDER_STATE_TRANSITION="ORDER_STATE_TRANSITION",e.ORDER_PAYMENT_TRANSITION="ORDER_PAYMENT_TRANSITION",e.ORDER_FULFILLMENT="ORDER_FULFILLMENT",e.ORDER_CANCELLATION="ORDER_CANCELLATION",e.ORDER_REFUND_TRANSITION="ORDER_REFUND_TRANSITION",e.ORDER_FULFILLMENT_TRANSITION="ORDER_FULFILLMENT_TRANSITION",e.ORDER_NOTE="ORDER_NOTE",e.ORDER_COUPON_APPLIED="ORDER_COUPON_APPLIED",e.ORDER_COUPON_REMOVED="ORDER_COUPON_REMOVED",e.ORDER_MODIFIED="ORDER_MODIFIED"}(t.HistoryEntryType||(t.HistoryEntryType={})),function(e){e.af="af",e.ak="ak",e.sq="sq",e.am="am",e.ar="ar",e.hy="hy",e.as="as",e.az="az",e.bm="bm",e.bn="bn",e.eu="eu",e.be="be",e.bs="bs",e.br="br",e.bg="bg",e.my="my",e.ca="ca",e.ce="ce",e.zh="zh",e.zh_Hans="zh_Hans",e.zh_Hant="zh_Hant",e.cu="cu",e.kw="kw",e.co="co",e.hr="hr",e.cs="cs",e.da="da",e.nl="nl",e.nl_BE="nl_BE",e.dz="dz",e.en="en",e.en_AU="en_AU",e.en_CA="en_CA",e.en_GB="en_GB",e.en_US="en_US",e.eo="eo",e.et="et",e.ee="ee",e.fo="fo",e.fi="fi",e.fr="fr",e.fr_CA="fr_CA",e.fr_CH="fr_CH",e.ff="ff",e.gl="gl",e.lg="lg",e.ka="ka",e.de="de",e.de_AT="de_AT",e.de_CH="de_CH",e.el="el",e.gu="gu",e.ht="ht",e.ha="ha",e.he="he",e.hi="hi",e.hu="hu",e.is="is",e.ig="ig",e.id="id",e.ia="ia",e.ga="ga",e.it="it",e.ja="ja",e.jv="jv",e.kl="kl",e.kn="kn",e.ks="ks",e.kk="kk",e.km="km",e.ki="ki",e.rw="rw",e.ko="ko",e.ku="ku",e.ky="ky",e.lo="lo",e.la="la",e.lv="lv",e.ln="ln",e.lt="lt",e.lu="lu",e.lb="lb",e.mk="mk",e.mg="mg",e.ms="ms",e.ml="ml",e.mt="mt",e.gv="gv",e.mi="mi",e.mr="mr",e.mn="mn",e.ne="ne",e.nd="nd",e.se="se",e.nb="nb",e.nn="nn",e.ny="ny",e.or="or",e.om="om",e.os="os",e.ps="ps",e.fa="fa",e.fa_AF="fa_AF",e.pl="pl",e.pt="pt",e.pt_BR="pt_BR",e.pt_PT="pt_PT",e.pa="pa",e.qu="qu",e.ro="ro",e.ro_MD="ro_MD",e.rm="rm",e.rn="rn",e.ru="ru",e.sm="sm",e.sg="sg",e.sa="sa",e.gd="gd",e.sr="sr",e.sn="sn",e.ii="ii",e.sd="sd",e.si="si",e.sk="sk",e.sl="sl",e.so="so",e.st="st",e.es="es",e.es_ES="es_ES",e.es_MX="es_MX",e.su="su",e.sw="sw",e.sw_CD="sw_CD",e.sv="sv",e.tg="tg",e.ta="ta",e.tt="tt",e.te="te",e.th="th",e.bo="bo",e.ti="ti",e.to="to",e.tr="tr",e.tk="tk",e.uk="uk",e.ur="ur",e.ug="ug",e.uz="uz",e.vi="vi",e.vo="vo",e.cy="cy",e.fy="fy",e.wo="wo",e.xh="xh",e.yi="yi",e.yo="yo",e.zu="zu"}(t.LanguageCode||(t.LanguageCode={}))},h0eC:function(e,t,c){"use strict";c.r(t),c.d(t,"AddCustomerToGroupDialogComponent",function(){return F}),c.d(t,"AddressCardComponent",function(){return te}),c.d(t,"AddressDetailDialogComponent",function(){return j}),c.d(t,"CustomerDetailComponent",function(){return St}),c.d(t,"CustomerGroupDetailDialogComponent",function(){return Ut}),c.d(t,"CustomerGroupListComponent",function(){return Xt}),c.d(t,"CustomerGroupMemberListComponent",function(){return I}),c.d(t,"CustomerHistoryComponent",function(){return tt}),c.d(t,"CustomerListComponent",function(){return qt}),c.d(t,"CustomerStatusLabelComponent",function(){return Te}),c.d(t,"SelectCustomerGroupDialogComponent",function(){return Ce}),c.d(t,"CustomerModule",function(){return cc}),c.d(t,"customerRoutes",function(){return ec}),c.d(t,"customerBreadcrumb",function(){return tc}),c.d(t,"CustomerResolver",function(){return Jt});var s=c("t9nd"),r=c("2Vo4"),n=c("eIep"),o=c("lJxs"),i=c("fXoL"),a=c("xUfP"),d=c("3Pt+"),l=c("XNiG"),u=c("itXk"),m=c("JX91"),p=c("/uUt"),g=c("Kj3r"),h=c("vkgz"),b=c("1G5W"),f=c("tyNb"),C=c("Bzlx"),R=c("CotX"),y=c("r2d8"),O=c("ef/U"),E=c("sYmb"),D=c("ofXK"),T=c("V0to");const v=function(e){return["/customer","customers",e]};function S(e,t){if(1&e&&(i.hc(0,"td",3),i.Vc(1),i.gc(),i.hc(2,"td",3),i.Vc(3),i.gc(),i.hc(4,"td",4),i.cc(5,"vdr-table-row-action",5),i.sc(6,"translate"),i.gc()),2&e){const e=t.item;i.Qb(1),i.Zc(" ",e.title," ",e.firstName," ",e.lastName," "),i.Qb(2),i.Wc(e.emailAddress),i.Qb(2),i.yc("label",i.tc(6,6,"common.edit"))("linkTo",i.Cc(8,v,e.id))}}class I{constructor(e,t){this.router=e,this.dataService=t,this.selectedMemberIds=[],this.selectionChange=new i.t,this.fetchParamsChange=new i.t,this.filterTermControl=new d.f(""),this.refresh$=new r.a(!0),this.destroy$=new l.a,this.isMemberSelected=e=>-1<this.selectedMemberIds.indexOf(e.id)}ngOnInit(){this.membersCurrentPage$=this.route.paramMap.pipe(Object(o.a)(e=>e.get("membersPage")),Object(o.a)(e=>e?+e:1),Object(m.a)(1),Object(p.a)()),this.membersItemsPerPage$=this.route.paramMap.pipe(Object(o.a)(e=>e.get("membersPerPage")),Object(o.a)(e=>e?+e:10),Object(m.a)(10),Object(p.a)());const e=this.filterTermControl.valueChanges.pipe(Object(g.a)(250),Object(h.a)(()=>this.setContentsPageNumber(1)),Object(m.a)(""));Object(u.a)(this.membersCurrentPage$,this.membersItemsPerPage$,e,this.refresh$).pipe(Object(b.a)(this.destroy$)).subscribe(([e,t,c])=>{const s=t,r=(e-1)*t;this.fetchParamsChange.emit({filterTerm:c,skip:r,take:s})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setContentsPageNumber(e){this.setParam("membersPage",e)}setContentsItemsPerPage(e){this.setParam("membersPerPage",e)}refresh(){this.refresh$.next(!0)}setParam(e,t){this.router.navigate(["./",Object.assign(Object.assign({},this.route.snapshot.params),{[e]:t})],{relativeTo:this.route,queryParamsHandling:"merge"})}areAllSelected(){return!!this.members&&this.selectedMemberIds.length===this.members.length}toggleSelectAll(){this.areAllSelected()?this.selectionChange.emit([]):this.selectionChange.emit(this.members.map(e=>e.id))}toggleSelectMember(e){this.selectedMemberIds.includes(e.id)?this.selectionChange.emit(this.selectedMemberIds.filter(t=>t!==e.id)):this.selectionChange.emit([...this.selectedMemberIds,e.id])}}I.\u0275fac=function(e){return new(e||I)(i.bc(f.e),i.bc(s.s))},I.\u0275cmp=i.Vb({type:I,selectors:[["vdr-customer-group-member-list"]],inputs:{members:"members",totalItems:"totalItems",route:"route",selectedMemberIds:"selectedMemberIds"},outputs:{selectionChange:"selectionChange",fetchParamsChange:"fetchParamsChange"},decls:14,vars:24,consts:[["type","text","name","searchTerm",1,"search-input",3,"formControl","placeholder"],[3,"items","itemsPerPage","totalItems","currentPage","allSelected","isRowSelectedFn","pageChange","itemsPerPageChange","rowSelectChange","allSelectChange"],[3,"expand"],[1,"left","align-middle"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"]],template:function(e,t){1&e&&(i.cc(0,"input",0),i.sc(1,"translate"),i.hc(2,"vdr-data-table",1),i.pc("pageChange",function(e){return t.setContentsPageNumber(e)})("itemsPerPageChange",function(e){return t.setContentsItemsPerPage(e)})("rowSelectChange",function(e){return t.toggleSelectMember(e)})("allSelectChange",function(){return t.toggleSelectAll()}),i.sc(3,"async"),i.sc(4,"async"),i.sc(5,"hasPermission"),i.hc(6,"vdr-dt-column",2),i.Vc(7),i.sc(8,"translate"),i.gc(),i.hc(9,"vdr-dt-column",2),i.Vc(10),i.sc(11,"translate"),i.gc(),i.cc(12,"vdr-dt-column"),i.Tc(13,S,7,10,"ng-template"),i.gc()),2&e&&(i.yc("formControl",t.filterTermControl)("placeholder",i.tc(1,12,"customer.search-customers-by-email")),i.Qb(2),i.yc("items",t.members)("itemsPerPage",i.tc(3,14,t.membersItemsPerPage$))("totalItems",t.totalItems)("currentPage",i.tc(4,16,t.membersCurrentPage$))("allSelected",t.areAllSelected())("isRowSelectedFn",i.tc(5,18,"UpdateCustomerGroup")&&t.isMemberSelected),i.Qb(4),i.yc("expand",!0),i.Qb(1),i.Wc(i.tc(8,20,"customer.name")),i.Qb(2),i.yc("expand",!0),i.Qb(1),i.Wc(i.tc(11,22,"customer.email-address")))},directives:[C.a,d.b,d.p,d.g,R.a,y.a,O.a],pipes:[E.d,D.b,T.a],styles:[""],changeDetection:0});var _=c("jHbs");const A=function(e){return{groupName:e}};function P(e,t){if(1&e&&(i.Vc(0),i.sc(1,"translate")),2&e){const e=i.rc();i.Xc(" ",i.uc(1,1,"customer.add-customers-to-group-with-name",i.Cc(4,A,e.group.name)),"\n")}}const N=function(e){return{count:e}};function M(e,t){if(1&e){const e=i.ic();i.hc(0,"button",3),i.pc("click",function(){i.Lc(e);return i.rc().cancel()}),i.Vc(1),i.sc(2,"translate"),i.gc(),i.hc(3,"button",4),i.pc("click",function(){i.Lc(e);return i.rc().add()}),i.Vc(4),i.sc(5,"translate"),i.gc()}if(2&e){const e=i.rc();i.Qb(1),i.Wc(i.tc(2,3,"common.cancel")),i.Qb(2),i.yc("disabled",!e.selectedCustomerIds.length),i.Qb(1),i.Xc(" ",i.uc(5,5,"customer.add-customers-to-group-with-count",i.Cc(8,N,e.selectedCustomerIds.length))," ")}}class F{constructor(e){this.dataService=e,this.selectedCustomerIds=[],this.fetchGroupMembers$=new r.a({skip:0,take:10,filterTerm:""})}ngOnInit(){const e=this.fetchGroupMembers$.pipe(Object(n.a)(({skip:e,take:t,filterTerm:c})=>this.dataService.customer.getCustomerList(t,e,c).mapStream(e=>e.customers)));this.customers$=e.pipe(Object(o.a)(e=>e.items)),this.customersTotal$=e.pipe(Object(o.a)(e=>e.totalItems))}cancel(){this.resolveWith()}add(){this.resolveWith(this.selectedCustomerIds)}}F.\u0275fac=function(e){return new(e||F)(i.bc(s.s))},F.\u0275cmp=i.Vb({type:F,selectors:[["vdr-add-customer-to-group-dialog"]],decls:5,vars:8,consts:[["vdrDialogTitle",""],[3,"members","totalItems","route","selectedMemberIds","fetchParamsChange","selectionChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(i.Tc(0,P,2,6,"ng-template",0),i.hc(1,"vdr-customer-group-member-list",1),i.pc("fetchParamsChange",function(e){return t.fetchGroupMembers$.next(e)})("selectionChange",function(e){return t.selectedCustomerIds=e}),i.sc(2,"async"),i.sc(3,"async"),i.gc(),i.Tc(4,M,6,10,"ng-template",2)),2&e&&(i.Qb(1),i.yc("members",i.tc(2,4,t.customers$))("totalItems",i.tc(3,6,t.customersTotal$))("route",t.route)("selectedMemberIds",t.selectedCustomerIds))},directives:[a.a,I,_.a],pipes:[D.b,E.d],styles:[""],changeDetection:0});var U=c("pLZG"),Q=c("IzEk"),L=c("4ALk");function V(e,t){if(1&e&&(i.hc(0,"span"),i.Vc(1),i.gc()),2&e){const e=t.ngIf;i.Qb(1),i.Xc("",e,",")}}function G(e,t){if(1&e&&(i.hc(0,"span"),i.Vc(1),i.gc()),2&e){const e=t.ngIf;i.Qb(1),i.Xc(" ",e,"")}}function w(e,t){if(1&e&&(i.Tc(0,V,2,1,"span",3),i.Tc(1,G,2,1,"span",3)),2&e){const e=i.rc();let t=null,c=null;i.yc("ngIf",null==(t=e.addressForm.get("streetLine1"))?null:t.value),i.Qb(1),i.yc("ngIf",null==(c=e.addressForm.get("countryCode"))?null:c.value)}}function k(e,t){if(1&e){const e=i.ic();i.hc(0,"button",4),i.pc("click",function(){i.Lc(e);return i.rc().cancel()}),i.Vc(1),i.sc(2,"translate"),i.gc(),i.hc(3,"button",5),i.pc("click",function(){i.Lc(e);return i.rc().save()}),i.Vc(4),i.sc(5,"translate"),i.gc()}if(2&e){const e=i.rc();i.Qb(1),i.Wc(i.tc(2,3,"common.cancel")),i.Qb(2),i.yc("disabled",!e.addressForm.valid||!e.addressForm.touched),i.Qb(1),i.Xc(" ",i.tc(5,5,"common.update")," ")}}class j{constructor(e){this.changeDetector=e,this.availableCountries=[]}ngOnInit(){this.addressForm.valueChanges.subscribe(()=>this.changeDetector.markForCheck())}cancel(){this.resolveWith()}save(){this.resolveWith(this.addressForm)}}j.\u0275fac=function(e){return new(e||j)(i.bc(i.j))},j.\u0275cmp=i.Vb({type:j,selectors:[["vdr-address-detail-dialog"]],decls:3,vars:3,consts:[["vdrDialogTitle",""],[3,"formGroup","availableCountries","customFields"],["vdrDialogButtons",""],[4,"ngIf"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(i.Tc(0,w,2,2,"ng-template",0),i.cc(1,"vdr-address-form",1),i.Tc(2,k,6,7,"ng-template",2)),2&e&&(i.Qb(1),i.yc("formGroup",t.addressForm)("availableCountries",t.availableCountries)("customFields",t.customFields))},directives:[a.a,L.a,d.q,d.j,_.a,D.o],pipes:[E.d],styles:["clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}"],changeDetection:0});var $=c("qqSn"),B=c("iszU"),x=c("2/wi"),W=c("8MG2"),X=c("zzDm"),K=c("eBFp"),H=c("IKcI"),Y=c("EFLa");function Z(e,t){if(1&e&&(i.hc(0,"span",13),i.Vc(1),i.gc()),2&e){const e=i.rc().ngIf;i.Qb(1),i.Xc("",e.streetLine1,",")}}function z(e,t){1&e&&(i.hc(0,"vdr-chip",14),i.cc(1,"clr-icon",15),i.Vc(2),i.sc(3,"translate"),i.gc()),2&e&&(i.Qb(2),i.Xc(" ",i.tc(3,1,"customer.default-shipping-address")," "))}function q(e,t){1&e&&(i.hc(0,"vdr-chip",14),i.cc(1,"clr-icon",16),i.Vc(2),i.sc(3,"translate"),i.gc()),2&e&&(i.Qb(2),i.Xc(" ",i.tc(3,1,"customer.default-billing-address")," "))}function J(e,t){if(1&e){const e=i.ic();i.fc(0),i.hc(1,"button",17),i.pc("click",function(){i.Lc(e);return i.rc(2).editAddress()}),i.Vc(2),i.sc(3,"translate"),i.gc(),i.hc(4,"vdr-dropdown"),i.hc(5,"button",18),i.Vc(6),i.sc(7,"translate"),i.cc(8,"clr-icon",19),i.gc(),i.hc(9,"vdr-dropdown-menu"),i.hc(10,"button",20),i.pc("click",function(){i.Lc(e);return i.rc(2).setAsDefaultShippingAddress()}),i.Vc(11),i.sc(12,"translate"),i.gc(),i.hc(13,"button",20),i.pc("click",function(){i.Lc(e);return i.rc(2).setAsDefaultBillingAddress()}),i.Vc(14),i.sc(15,"translate"),i.gc(),i.gc(),i.gc(),i.ec()}if(2&e){const e=i.rc(2);i.Qb(2),i.Xc(" ",i.tc(3,6,"common.edit")," "),i.Qb(4),i.Xc(" ",i.tc(7,8,"common.more")," "),i.Qb(4),i.yc("disabled",e.isDefaultShipping),i.Qb(1),i.Xc(" ",i.tc(12,10,"customer.set-as-default-shipping-address")," "),i.Qb(2),i.yc("disabled",e.isDefaultBilling),i.Qb(1),i.Xc(" ",i.tc(15,12,"customer.set-as-default-billing-address")," ")}}function ee(e,t){if(1&e&&(i.hc(0,"div",1),i.hc(1,"div",2),i.hc(2,"div",3),i.Tc(3,Z,2,1,"span",4),i.Vc(4),i.gc(),i.hc(5,"div",5),i.Tc(6,z,4,3,"vdr-chip",6),i.Tc(7,q,4,3,"vdr-chip",6),i.gc(),i.gc(),i.hc(8,"div",7),i.hc(9,"div",8),i.cc(10,"vdr-formatted-address",9),i.gc(),i.gc(),i.hc(11,"div",10),i.cc(12,"vdr-entity-info",11),i.Tc(13,J,16,14,"ng-container",12),i.gc(),i.gc()),2&e){const e=t.ngIf,c=i.rc();i.Qb(3),i.yc("ngIf",e.streetLine1),i.Qb(1),i.Xc(" ",e.countryCode," "),i.Qb(2),i.yc("ngIf",c.isDefaultShipping),i.Qb(1),i.yc("ngIf",c.isDefaultBilling),i.Qb(3),i.yc("address",e),i.Qb(2),i.yc("entity",e),i.Qb(1),i.yc("ngIf",c.editable)}}class te{constructor(e,t){this.modalService=e,this.changeDetector=t,this.availableCountries=[],this.editable=!0,this.setAsDefaultShipping=new i.t,this.setAsDefaultBilling=new i.t,this.dataDependenciesPopulated=new r.a(!1)}ngOnInit(){this.addressForm.get("streetLine1").value||this.dataDependenciesPopulated.pipe(Object(U.a)(e=>e),Object(Q.a)(1)).subscribe(()=>{this.editAddress()})}ngOnChanges(e){null!=this.customFields&&null!=this.availableCountries&&this.dataDependenciesPopulated.next(!0)}getCountryName(e){if(!this.availableCountries)return"";const t=this.availableCountries.find(t=>t.code===e);return t?t.name:""}setAsDefaultBillingAddress(){this.setAsDefaultBilling.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}setAsDefaultShippingAddress(){this.setAsDefaultShipping.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}editAddress(){this.modalService.fromComponent(j,{locals:{addressForm:this.addressForm,customFields:this.customFields,availableCountries:this.availableCountries},size:"md",closable:!0}).subscribe(()=>{this.changeDetector.markForCheck()})}}te.\u0275fac=function(e){return new(e||te)(i.bc(s.F),i.bc(i.j))},te.\u0275cmp=i.Vb({type:te,selectors:[["vdr-address-card"]],inputs:{addressForm:"addressForm",customFields:"customFields",availableCountries:"availableCountries",isDefaultBilling:"isDefaultBilling",isDefaultShipping:"isDefaultShipping",editable:"editable"},outputs:{setAsDefaultShipping:"setAsDefaultShipping",setAsDefaultBilling:"setAsDefaultBilling"},features:[i.Ob],decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"address-title"],["class","street-line",4,"ngIf"],[1,"default-controls"],["class","is-default p8",4,"ngIf"],[1,"card-block"],[1,"card-text"],[3,"address"],[1,"card-footer"],[3,"entity"],[4,"ngIf"],[1,"street-line"],[1,"is-default","p8"],["shape","truck"],["shape","credit-card"],[1,"btn","btn-sm","btn-link",3,"click"],["type","button","vdrDropdownTrigger","",1,"btn","btn-sm","btn-link"],["shape","caret down"],["vdrDropdownItem","",1,"button",3,"disabled","click"]],template:function(e,t){1&e&&i.Tc(0,ee,14,7,"div",0),2&e&&i.yc("ngIf",t.addressForm.value)},directives:[D.o,$.a,B.a,x.a,W.o,X.a,K.a,H.a,Y.a],pipes:[E.d],styles:["[_nghost-%COMP%]{display:block;max-width:360px}clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}.defaul-controls[_ngcontent-%COMP%]{display:flex}.is-default[_ngcontent-%COMP%]{margin:0;color:var(--color-success-500)}"],changeDetection:0});var ce=c("D57K"),se=c("OxKu"),re=c("cOim"),ne=c("cp0P"),oe=c("Cfvw"),ie=c("EY2u"),ae=c("UXun"),de=c("VRyK");var le=c("5+tZ"),ue=c("bOdf"),me=c("ZOsW");function pe(e,t){1&e&&(i.Vc(0),i.sc(1,"translate")),2&e&&i.Xc(" ",i.tc(1,1,"customer.add-customer-to-group"),"\n")}function ge(e,t){if(1&e&&(i.hc(0,"span",5),i.pc("click",function(){const e=t.item;return(0,t.clear)(e)}),i.Vc(1," \xd7 "),i.gc(),i.hc(2,"vdr-chip",6),i.Vc(3),i.gc()),2&e){const e=t.item;i.Qb(2),i.yc("colorFrom",e.id),i.Qb(1),i.Wc(e.name)}}function he(e,t){if(1&e&&(i.hc(0,"vdr-chip",6),i.Vc(1),i.gc()),2&e){const e=t.item;i.yc("colorFrom",e.id),i.Qb(1),i.Wc(e.name)}}const be=function(e){return{count:e}};function fe(e,t){if(1&e){const e=i.ic();i.hc(0,"button",7),i.pc("click",function(){i.Lc(e);return i.rc().cancel()}),i.Vc(1),i.sc(2,"translate"),i.gc(),i.hc(3,"button",8),i.pc("click",function(){i.Lc(e);return i.rc().add()}),i.Vc(4),i.sc(5,"translate"),i.gc()}if(2&e){const e=i.rc();i.Qb(1),i.Wc(i.tc(2,3,"common.cancel")),i.Qb(2),i.yc("disabled",!e.selectedGroupIds.length),i.Qb(1),i.Xc(" ",i.uc(5,5,"customer.add-customer-to-groups-with-count",i.Cc(8,be,e.selectedGroupIds.length))," ")}}class Ce{constructor(e){this.dataService=e,this.selectedGroupIds=[]}ngOnInit(){this.groups$=this.dataService.customer.getCustomerGroupList().mapStream(e=>e.customerGroups.items)}cancel(){this.resolveWith()}add(){this.resolveWith(this.selectedGroupIds)}}Ce.\u0275fac=function(e){return new(e||Ce)(i.bc(s.s))},Ce.\u0275cmp=i.Vb({type:Ce,selectors:[["vdr-select-customer-group-dialog"]],decls:6,vars:8,consts:[["vdrDialogTitle",""],["appendTo","body","bindValue","id",3,"items","addTag","multiple","ngModel","clearable","searchable","ngModelChange"],["ng-label-tmp",""],["ng-option-tmp",""],["vdrDialogButtons",""],["aria-hidden","true",1,"ng-value-icon","left",3,"click"],[3,"colorFrom"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(i.Tc(0,pe,2,3,"ng-template",0),i.hc(1,"ng-select",1),i.pc("ngModelChange",function(e){return t.selectedGroupIds=e}),i.sc(2,"async"),i.Tc(3,ge,4,2,"ng-template",2),i.Tc(4,he,2,2,"ng-template",3),i.gc(),i.Tc(5,fe,6,10,"ng-template",4)),2&e&&(i.Qb(1),i.yc("items",i.tc(2,6,t.groups$))("addTag",!1)("multiple",!0)("ngModel",t.selectedGroupIds)("clearable",!0)("searchable",!1))},directives:[a.a,me.a,d.p,d.s,me.e,me.d,_.a,x.a],pipes:[D.b,E.d],styles:[""],changeDetection:0});var Re=c("uEVm");function ye(e,t){1&e&&(i.fc(0),i.cc(1,"clr-icon",1),i.Vc(2),i.sc(3,"translate"),i.ec()),2&e&&(i.Qb(2),i.Xc(" ",i.tc(3,1,"customer.verified")," "))}function Oe(e,t){1&e&&(i.fc(0),i.cc(1,"clr-icon",2),i.Vc(2),i.sc(3,"translate"),i.ec()),2&e&&(i.Qb(2),i.Xc(" ",i.tc(3,1,"customer.registered")," "))}function Ee(e,t){if(1&e&&(i.hc(0,"vdr-chip"),i.Tc(1,ye,4,3,"ng-container",0),i.Tc(2,Oe,4,3,"ng-container",0),i.gc()),2&e){const e=i.rc();i.Qb(1),i.yc("ngIf",null==e.customer.user?null:e.customer.user.verified),i.Qb(1),i.yc("ngIf",!(null!=e.customer.user&&e.customer.user.verified))}}function De(e,t){1&e&&(i.hc(0,"vdr-chip"),i.Vc(1),i.sc(2,"translate"),i.gc()),2&e&&(i.Qb(1),i.Wc(i.tc(2,1,"customer.guest")))}class Te{}Te.\u0275fac=function(e){return new(e||Te)},Te.\u0275cmp=i.Vb({type:Te,selectors:[["vdr-customer-status-label"]],inputs:{customer:"customer"},decls:2,vars:2,consts:[[4,"ngIf"],["shape","check-circle",1,"verified-user-icon"],["shape","check-circle",1,"registered-user-icon"]],template:function(e,t){1&e&&(i.Tc(0,Ee,3,2,"vdr-chip",0),i.Tc(1,De,3,3,"vdr-chip",0)),2&e&&(i.yc("ngIf",null==t.customer.user?null:t.customer.user.id),i.Qb(1),i.yc("ngIf",!(null!=t.customer.user&&t.customer.user.id)))},directives:[D.o,x.a,W.o],pipes:[E.d],styles:[".registered-user-icon[_ngcontent-%COMP%]{color:var(--color-grey-300)}.verified-user-icon[_ngcontent-%COMP%]{color:var(--color-success-500)}"],changeDetection:0});var ve=c("nqNv"),Se=c("1XD6"),Ie=c("W7hW"),_e=c("Lbhx"),Ae=c("yW18"),Pe=c("u1bq"),Ne=c("2zLM"),Me=c("0MpJ");function Fe(e,t){if(1&e){const e=i.ic();i.hc(0,"vdr-timeline-entry",4),i.hc(1,"div",5),i.hc(2,"textarea",6),i.pc("ngModelChange",function(t){i.Lc(e);return i.rc().note=t}),i.gc(),i.hc(3,"button",7),i.pc("click",function(){i.Lc(e);return i.rc().addNoteToCustomer()}),i.Vc(4),i.sc(5,"translate"),i.gc(),i.gc(),i.gc()}if(2&e){const e=i.rc();i.Qb(2),i.yc("ngModel",e.note),i.Qb(1),i.yc("disabled",!e.note),i.Qb(1),i.Xc(" ",i.tc(5,3,"order.add-note")," ")}}function Ue(e,t){1&e&&(i.fc(0),i.Vc(1),i.sc(2,"translate"),i.ec()),2&e&&(i.Qb(1),i.Xc(" ",i.tc(2,1,"customer.history-using-native-auth-strategy")," "))}const Qe=function(e){return{strategy:e}};function Le(e,t){if(1&e&&(i.Vc(0),i.sc(1,"translate")),2&e){const e=i.rc(2).$implicit;i.Xc(" ",i.uc(1,1,"customer.history-using-external-auth-strategy",i.Cc(4,Qe,e.data.strategy))," ")}}function Ve(e,t){if(1&e&&(i.fc(0),i.hc(1,"div",11),i.Vc(2),i.sc(3,"translate"),i.gc(),i.Tc(4,Ue,3,3,"ng-container",12),i.Tc(5,Le,2,6,"ng-template",null,13,i.Uc),i.ec()),2&e){const e=i.Ic(6),t=i.rc().$implicit;i.Qb(2),i.Xc(" ",i.tc(3,3,"customer.history-customer-registered")," "),i.Qb(2),i.yc("ngIf","native"===t.data.strategy)("ngIfElse",e)}}function Ge(e,t){1&e&&(i.fc(0),i.Vc(1),i.sc(2,"translate"),i.ec()),2&e&&(i.Qb(1),i.Xc(" ",i.tc(2,1,"customer.history-using-native-auth-strategy")," "))}function we(e,t){if(1&e&&(i.Vc(0),i.sc(1,"translate")),2&e){const e=i.rc(2).$implicit;i.Xc(" ",i.uc(1,1,"customer.history-using-external-auth-strategy",i.Cc(4,Qe,e.data.strategy))," ")}}function ke(e,t){if(1&e&&(i.fc(0),i.hc(1,"div",11),i.Vc(2),i.sc(3,"translate"),i.gc(),i.Tc(4,Ge,3,3,"ng-container",12),i.Tc(5,we,2,6,"ng-template",null,13,i.Uc),i.ec()),2&e){const e=i.Ic(6),t=i.rc().$implicit;i.Qb(2),i.Xc(" ",i.tc(3,3,"customer.history-customer-verified")," "),i.Qb(2),i.yc("ngIf","native"===t.data.strategy)("ngIfElse",e)}}function je(e,t){if(1&e&&(i.fc(0),i.hc(1,"div",14),i.Vc(2),i.sc(3,"translate"),i.hc(4,"vdr-history-entry-detail"),i.cc(5,"vdr-object-tree",15),i.gc(),i.gc(),i.ec()),2&e){const e=i.rc().$implicit;i.Qb(2),i.Xc(" ",i.tc(3,2,"customer.history-customer-detail-updated")," "),i.Qb(3),i.yc("value",e.data.input)}}const $e=function(e){return{groupName:e}};function Be(e,t){if(1&e&&(i.fc(0),i.Vc(1),i.sc(2,"translate"),i.ec()),2&e){const e=i.rc().$implicit;i.Qb(1),i.Xc(" ",i.uc(2,1,"customer.history-customer-added-to-group",i.Cc(4,$e,e.data.groupName))," ")}}function xe(e,t){if(1&e&&(i.fc(0),i.Vc(1),i.sc(2,"translate"),i.ec()),2&e){const e=i.rc().$implicit;i.Qb(1),i.Xc(" ",i.uc(2,1,"customer.history-customer-removed-from-group",i.Cc(4,$e,e.data.groupName))," ")}}function We(e,t){if(1&e&&(i.fc(0),i.Vc(1),i.sc(2,"translate"),i.hc(3,"div",14),i.hc(4,"div",16),i.Vc(5),i.gc(),i.gc(),i.ec()),2&e){const e=i.rc().$implicit;i.Qb(1),i.Xc(" ",i.tc(2,2,"customer.history-customer-address-created")," "),i.Qb(4),i.Wc(e.data.address)}}function Xe(e,t){if(1&e&&(i.fc(0),i.Vc(1),i.sc(2,"translate"),i.hc(3,"div",14),i.hc(4,"div",16),i.Vc(5),i.gc(),i.hc(6,"vdr-history-entry-detail"),i.cc(7,"vdr-object-tree",15),i.gc(),i.gc(),i.ec()),2&e){const e=i.rc().$implicit;i.Qb(1),i.Xc(" ",i.tc(2,3,"customer.history-customer-address-updated")," "),i.Qb(4),i.Wc(e.data.address),i.Qb(2),i.yc("value",e.data.input)}}function Ke(e,t){if(1&e&&(i.fc(0),i.Vc(1),i.sc(2,"translate"),i.hc(3,"div",16),i.Vc(4),i.gc(),i.ec()),2&e){const e=i.rc().$implicit;i.Qb(1),i.Xc(" ",i.tc(2,2,"customer.history-customer-address-deleted")," "),i.Qb(3),i.Wc(e.data.address)}}function He(e,t){1&e&&(i.fc(0),i.Vc(1),i.sc(2,"translate"),i.ec()),2&e&&(i.Qb(1),i.Xc(" ",i.tc(2,1,"customer.history-customer-password-updated")," "))}function Ye(e,t){1&e&&(i.fc(0),i.Vc(1),i.sc(2,"translate"),i.ec()),2&e&&(i.Qb(1),i.Xc(" ",i.tc(2,1,"customer.history-customer-password-reset-requested")," "))}function Ze(e,t){1&e&&(i.fc(0),i.Vc(1),i.sc(2,"translate"),i.ec()),2&e&&(i.Qb(1),i.Xc(" ",i.tc(2,1,"customer.history-customer-password-reset-verified")," "))}function ze(e,t){if(1&e&&(i.fc(0),i.hc(1,"div",14),i.Vc(2),i.sc(3,"translate"),i.hc(4,"vdr-history-entry-detail"),i.hc(5,"vdr-labeled-data",17),i.sc(6,"translate"),i.Vc(7),i.gc(),i.hc(8,"vdr-labeled-data",17),i.sc(9,"translate"),i.Vc(10),i.gc(),i.gc(),i.gc(),i.ec()),2&e){const e=i.rc().$implicit;i.Qb(2),i.Xc(" ",i.tc(3,5,"customer.history-customer-email-update-requested")," "),i.Qb(3),i.yc("label",i.tc(6,7,"customer.old-email-address")),i.Qb(2),i.Wc(e.data.oldEmailAddress),i.Qb(1),i.yc("label",i.tc(9,9,"customer.new-email-address")),i.Qb(2),i.Wc(e.data.newEmailAddress)}}function qe(e,t){if(1&e&&(i.fc(0),i.hc(1,"div",14),i.Vc(2),i.sc(3,"translate"),i.hc(4,"vdr-history-entry-detail"),i.hc(5,"vdr-labeled-data",17),i.sc(6,"translate"),i.Vc(7),i.gc(),i.hc(8,"vdr-labeled-data",17),i.sc(9,"translate"),i.Vc(10),i.gc(),i.gc(),i.gc(),i.ec()),2&e){const e=i.rc().$implicit;i.Qb(2),i.Xc(" ",i.tc(3,5,"customer.history-customer-email-update-verified")," "),i.Qb(3),i.yc("label",i.tc(6,7,"customer.old-email-address")),i.Qb(2),i.Wc(e.data.oldEmailAddress),i.Qb(1),i.yc("label",i.tc(9,9,"customer.new-email-address")),i.Qb(2),i.Wc(e.data.newEmailAddress)}}function Je(e,t){if(1&e){const e=i.ic();i.fc(0),i.hc(1,"div",14),i.hc(2,"div",18),i.Vc(3),i.gc(),i.cc(4,"div",19),i.hc(5,"vdr-dropdown"),i.hc(6,"button",20),i.cc(7,"clr-icon",21),i.gc(),i.hc(8,"vdr-dropdown-menu",22),i.hc(9,"button",23),i.pc("click",function(){i.Lc(e);const t=i.rc().$implicit;return i.rc().updateNote.emit(t)}),i.sc(10,"hasPermission"),i.cc(11,"clr-icon",24),i.Vc(12),i.sc(13,"translate"),i.gc(),i.cc(14,"div",25),i.hc(15,"button",23),i.pc("click",function(){i.Lc(e);const t=i.rc().$implicit;return i.rc().deleteNote.emit(t)}),i.sc(16,"hasPermission"),i.cc(17,"clr-icon",26),i.Vc(18),i.sc(19,"translate"),i.gc(),i.gc(),i.gc(),i.gc(),i.ec()}if(2&e){const e=i.rc().$implicit;i.Qb(3),i.Xc(" ",e.data.note," "),i.Qb(6),i.yc("disabled",!i.tc(10,5,"UpdateCustomer")),i.Qb(3),i.Xc(" ",i.tc(13,7,"common.edit")," "),i.Qb(3),i.yc("disabled",!i.tc(16,9,"UpdateCustomer")),i.Qb(3),i.Xc(" ",i.tc(19,11,"common.delete")," ")}}function et(e,t){if(1&e&&(i.hc(0,"vdr-timeline-entry",8),i.fc(1,9),i.Tc(2,Ve,7,5,"ng-container",10),i.Tc(3,ke,7,5,"ng-container",10),i.Tc(4,je,6,4,"ng-container",10),i.Tc(5,Be,3,6,"ng-container",10),i.Tc(6,xe,3,6,"ng-container",10),i.Tc(7,We,6,4,"ng-container",10),i.Tc(8,Xe,8,5,"ng-container",10),i.Tc(9,Ke,5,4,"ng-container",10),i.Tc(10,He,3,3,"ng-container",10),i.Tc(11,Ye,3,3,"ng-container",10),i.Tc(12,Ze,3,3,"ng-container",10),i.Tc(13,ze,11,11,"ng-container",10),i.Tc(14,qe,11,11,"ng-container",10),i.Tc(15,Je,20,13,"ng-container",10),i.ec(),i.gc()),2&e){const e=t.$implicit,c=i.rc();i.yc("displayType",c.getDisplayType(e))("iconShape",c.getTimelineIcon(e))("createdAt",e.createdAt)("name",c.getName(e))("featured",c.isFeatured(e)),i.Qb(1),i.yc("ngSwitch",e.type),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_REGISTERED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_VERIFIED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_DETAIL_UPDATED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_ADDED_TO_GROUP),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_REMOVED_FROM_GROUP),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_ADDRESS_CREATED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_ADDRESS_UPDATED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_ADDRESS_DELETED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_PASSWORD_UPDATED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_PASSWORD_RESET_REQUESTED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_PASSWORD_RESET_VERIFIED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_EMAIL_UPDATE_REQUESTED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_EMAIL_UPDATE_VERIFIED),i.Qb(1),i.yc("ngSwitchCase",c.type.CUSTOMER_NOTE)}}class tt{constructor(){this.addNote=new i.t,this.updateNote=new i.t,this.deleteNote=new i.t,this.note="",this.type=s.y}getDisplayType(e){switch(e.type){case s.y.CUSTOMER_VERIFIED:case s.y.CUSTOMER_EMAIL_UPDATE_VERIFIED:case s.y.CUSTOMER_PASSWORD_RESET_VERIFIED:return"success";case s.y.CUSTOMER_REGISTERED:return"muted";case s.y.CUSTOMER_REMOVED_FROM_GROUP:return"error";default:return"default"}}getTimelineIcon(e){switch(e.type){case s.y.CUSTOMER_REGISTERED:return"user";case s.y.CUSTOMER_VERIFIED:return["assign-user","is-solid"];case s.y.CUSTOMER_NOTE:return"note";case s.y.CUSTOMER_ADDED_TO_GROUP:case s.y.CUSTOMER_REMOVED_FROM_GROUP:return"users"}}isFeatured(e){switch(e.type){case s.y.CUSTOMER_REGISTERED:case s.y.CUSTOMER_VERIFIED:return!0;default:return!1}}getName(e){const{administrator:t}=e;return t?`${t.firstName} ${t.lastName}`:`${this.customer.firstName} ${this.customer.lastName}`}addNoteToCustomer(){this.addNote.emit({note:this.note}),this.note=""}}tt.\u0275fac=function(e){return new(e||tt)},tt.\u0275cmp=i.Vb({type:tt,selectors:[["vdr-customer-history"]],inputs:{customer:"customer",history:"history"},outputs:{addNote:"addNote",updateNote:"updateNote",deleteNote:"deleteNote"},decls:7,vars:6,consts:[[1,"entry-list"],["iconShape","note","displayType","muted",4,"vdrIfPermissions"],[3,"displayType","iconShape","createdAt","name","featured",4,"ngFor","ngForOf"],[3,"isLast"],["iconShape","note","displayType","muted"],[1,"note-entry"],["name","note",1,"note",3,"ngModel","ngModelChange"],[1,"btn","btn-secondary",3,"disabled","click"],[3,"displayType","iconShape","createdAt","name","featured"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"title"],[4,"ngIf","ngIfElse"],["namedStrategy",""],[1,"flex"],[3,"value"],[1,"address-string"],[3,"label"],[1,"note-text"],[1,"flex-spacer"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","edit"],[1,"dropdown-divider"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(i.hc(0,"h4"),i.Vc(1),i.sc(2,"translate"),i.gc(),i.hc(3,"div",0),i.Tc(4,Fe,6,5,"vdr-timeline-entry",1),i.Tc(5,et,16,20,"vdr-timeline-entry",2),i.cc(6,"vdr-timeline-entry",3),i.gc()),2&e&&(i.Qb(1),i.Wc(i.tc(2,4,"customer.customer-history")),i.Qb(3),i.yc("vdrIfPermissions","UpdateCustomer"),i.Qb(1),i.yc("ngForOf",t.history),i.Qb(1),i.yc("isLast",!0))},directives:[Ie.a,D.n,Ae.a,C.a,d.b,d.p,d.s,D.q,D.r,D.o,Pe.a,Ne.a,Me.a,X.a,K.a,W.o,H.a,Y.a],pipes:[E.d,T.a],styles:[".entry-list[_ngcontent-%COMP%]{margin-top:24px;margin-left:24px;margin-right:12px}.note-entry[_ngcontent-%COMP%]{display:flex;align-items:center}.note-entry[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{flex:1}.note-entry[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}textarea.note[_ngcontent-%COMP%]{flex:1;height:36px;border-radius:3px;margin-right:6px}.note-text[_ngcontent-%COMP%]{color:var(--color-text-100);white-space:pre-wrap}.address-string[_ngcontent-%COMP%]{font-size:smaller;color:var(--color-text-200)}"],changeDetection:0});var ct=c("HMPB"),st=c("uHMJ"),rt=c("ZFbG");function nt(e,t){if(1&e&&(i.hc(0,"div",22),i.sc(1,"localeDate"),i.Vc(2),i.sc(3,"translate"),i.sc(4,"timeAgo"),i.gc()),2&e){const e=t.ngIf;i.yc("title",i.uc(1,3,e,"medium")),i.Qb(2),i.Yc(" ",i.tc(3,6,"customer.last-login"),": ",i.tc(4,8,e)," ")}}function ot(e,t){if(1&e){const e=i.ic();i.hc(0,"button",23),i.pc("click",function(){i.Lc(e);return i.rc().create()}),i.Vc(1),i.sc(2,"translate"),i.gc()}if(2&e){const e=i.rc();i.yc("disabled",!(e.addressDefaultsUpdated||e.detailForm.valid&&e.detailForm.dirty)),i.Qb(1),i.Xc(" ",i.tc(2,2,"common.create")," ")}}function it(e,t){if(1&e){const e=i.ic();i.hc(0,"button",23),i.pc("click",function(){i.Lc(e);return i.rc(2).save()}),i.Vc(1),i.sc(2,"translate"),i.gc()}if(2&e){const e=i.rc(2);i.yc("disabled",!(e.addressDefaultsUpdated||e.detailForm.valid&&e.detailForm.dirty)),i.Qb(1),i.Xc(" ",i.tc(2,2,"common.update")," ")}}function at(e,t){1&e&&i.Tc(0,it,3,4,"button",24),2&e&&i.yc("vdrIfPermissions","UpdateCustomer")}function dt(e,t){1&e&&(i.hc(0,"vdr-form-field",25),i.sc(1,"translate"),i.cc(2,"input",26),i.gc()),2&e&&i.yc("label",i.tc(1,1,"customer.password"))}const lt=function(){return["customer","customFields"]};function ut(e,t){if(1&e&&i.cc(0,"vdr-custom-field-control",30),2&e){const e=i.rc().$implicit,t=i.rc(2);i.yc("customFieldsFormGroup",t.detailForm.get(i.Bc(2,lt)))("customField",e)}}function mt(e,t){if(1&e&&(i.fc(0),i.Tc(1,ut,1,3,"vdr-custom-field-control",29),i.ec()),2&e){const e=t.$implicit,c=i.rc(2);i.Qb(1),i.yc("ngIf",c.customFieldIsSet(e.name))}}function pt(e,t){if(1&e&&(i.hc(0,"section",27),i.hc(1,"label"),i.Vc(2),i.sc(3,"translate"),i.gc(),i.Tc(4,mt,2,1,"ng-container",28),i.gc()),2&e){const e=i.rc();i.Qb(2),i.Wc(i.tc(3,2,"common.custom-fields")),i.Qb(2),i.yc("ngForOf",e.customFields)}}function gt(e,t){if(1&e){const e=i.ic();i.hc(0,"vdr-chip",37),i.pc("iconClick",function(){i.Lc(e);const c=t.$implicit;return i.rc(3).removeFromGroup(c)}),i.Vc(1),i.gc()}if(2&e){const e=t.$implicit;i.yc("colorFrom",e.id),i.Qb(1),i.Wc(e.name)}}function ht(e,t){if(1&e&&(i.fc(0),i.Tc(1,gt,2,2,"vdr-chip",36),i.ec()),2&e){const e=i.rc().ngIf;i.Qb(1),i.yc("ngForOf",e)}}function bt(e,t){1&e&&(i.Vc(0),i.sc(1,"translate")),2&e&&i.Xc(" ",i.tc(1,1,"customer.not-a-member-of-any-groups")," ")}function ft(e,t){if(1&e){const e=i.ic();i.hc(0,"button",38),i.pc("click",function(){i.Lc(e);return i.rc(2).addToGroup()}),i.cc(1,"clr-icon",39),i.Vc(2),i.sc(3,"translate"),i.gc()}2&e&&(i.Qb(2),i.Xc(" ",i.tc(3,1,"customer.add-customer-to-group")," "))}function Ct(e,t){if(1&e&&(i.hc(0,"div",31),i.hc(1,"label",32),i.Vc(2),i.sc(3,"translate"),i.gc(),i.Tc(4,ht,2,1,"ng-container",33),i.Tc(5,bt,2,3,"ng-template",null,34,i.Uc),i.hc(7,"div"),i.Tc(8,ft,4,3,"button",35),i.gc(),i.gc()),2&e){const e=t.ngIf,c=i.Ic(6);i.Qb(2),i.Wc(i.tc(3,4,"customer.customer-groups")),i.Qb(2),i.yc("ngIf",e.length)("ngIfElse",c),i.Qb(4),i.yc("vdrIfPermissions","UpdateCustomerGroup")}}const Rt=function(){return["UpdateCustomer"]};function yt(e,t){if(1&e){const e=i.ic();i.hc(0,"vdr-address-card",46),i.pc("setAsDefaultBilling",function(t){i.Lc(e);return i.rc(2).setDefaultBillingAddressId(t)})("setAsDefaultShipping",function(t){i.Lc(e);return i.rc(2).setDefaultShippingAddressId(t)}),i.sc(1,"async"),i.sc(2,"hasPermission"),i.gc()}if(2&e){const e=t.$implicit,c=i.rc(2);i.yc("availableCountries",i.tc(1,6,c.availableCountries$))("isDefaultBilling",c.defaultBillingAddressId===e.value.id)("isDefaultShipping",c.defaultShippingAddressId===e.value.id)("addressForm",e)("customFields",c.addressCustomFields)("editable",i.tc(2,8,i.Bc(10,Rt)))}}function Ot(e,t){if(1&e){const e=i.ic();i.hc(0,"button",47),i.pc("click",function(){i.Lc(e);return i.rc(2).addAddress()}),i.cc(1,"clr-icon",39),i.Vc(2),i.sc(3,"translate"),i.gc()}2&e&&(i.Qb(2),i.Xc(" ",i.tc(3,1,"customer.create-new-address")," "))}const Et=function(e){return["/orders/",e]};function Dt(e,t){if(1&e&&(i.hc(0,"td",48),i.Vc(1),i.gc(),i.hc(2,"td",48),i.Vc(3),i.gc(),i.hc(4,"td",48),i.Vc(5),i.sc(6,"localeCurrency"),i.gc(),i.hc(7,"td",48),i.Vc(8),i.sc(9,"localeDate"),i.gc(),i.hc(10,"td",49),i.cc(11,"vdr-table-row-action",50),i.sc(12,"translate"),i.gc()),2&e){const e=t.item;i.Qb(1),i.Wc(e.code),i.Qb(2),i.Wc(e.state),i.Qb(2),i.Wc(i.uc(6,6,e.total,e.currencyCode)),i.Qb(3),i.Wc(i.uc(9,9,e.updatedAt,"medium")),i.Qb(3),i.yc("label",i.tc(12,12,"common.open"))("linkTo",i.Cc(14,Et,e.id))}}function Tt(e,t){if(1&e){const e=i.ic();i.hc(0,"div",40),i.hc(1,"div",41),i.hc(2,"h3"),i.Vc(3),i.sc(4,"translate"),i.gc(),i.Tc(5,yt,3,11,"vdr-address-card",42),i.Tc(6,Ot,4,3,"button",43),i.gc(),i.hc(7,"div",44),i.hc(8,"h3"),i.Vc(9),i.sc(10,"translate"),i.gc(),i.hc(11,"vdr-data-table",45),i.pc("itemsPerPageChange",function(t){i.Lc(e);return i.rc().setOrderItemsPerPage(t)})("pageChange",function(t){i.Lc(e);return i.rc().setOrderCurrentPage(t)}),i.sc(12,"async"),i.sc(13,"async"),i.sc(14,"translate"),i.hc(15,"vdr-dt-column"),i.Vc(16),i.sc(17,"translate"),i.gc(),i.hc(18,"vdr-dt-column"),i.Vc(19),i.sc(20,"translate"),i.gc(),i.hc(21,"vdr-dt-column"),i.Vc(22),i.sc(23,"translate"),i.gc(),i.hc(24,"vdr-dt-column"),i.Vc(25),i.sc(26,"translate"),i.gc(),i.cc(27,"vdr-dt-column"),i.Tc(28,Dt,13,16,"ng-template"),i.gc(),i.gc(),i.gc()}if(2&e){const e=i.rc();i.Qb(3),i.Wc(i.tc(4,13,"customer.addresses")),i.Qb(2),i.yc("ngForOf",e.getAddressFormControls()),i.Qb(1),i.yc("vdrIfPermissions","UpdateCustomer"),i.Qb(3),i.Wc(i.tc(10,15,"customer.orders")),i.Qb(2),i.yc("items",i.tc(12,17,e.orders$))("itemsPerPage",e.ordersPerPage)("totalItems",i.tc(13,19,e.ordersCount$))("currentPage",e.currentOrdersPage)("emptyStateLabel",i.tc(14,21,"customer.no-orders-placed")),i.Qb(5),i.Wc(i.tc(17,23,"common.code")),i.Qb(3),i.Wc(i.tc(20,25,"order.state")),i.Qb(3),i.Wc(i.tc(23,27,"order.total")),i.Qb(3),i.Wc(i.tc(26,29,"common.updated-at"))}}function vt(e,t){if(1&e){const e=i.ic();i.hc(0,"div",40),i.hc(1,"div",51),i.hc(2,"vdr-customer-history",52),i.pc("addNote",function(t){i.Lc(e);return i.rc().addNoteToCustomer(t)})("updateNote",function(t){i.Lc(e);return i.rc().updateNote(t)})("deleteNote",function(t){i.Lc(e);return i.rc().deleteNote(t)}),i.sc(3,"async"),i.sc(4,"async"),i.gc(),i.gc(),i.gc()}if(2&e){const e=i.rc();i.Qb(2),i.yc("customer",i.tc(3,2,e.entity$))("history",i.tc(4,4,e.history$))}}class St extends s.l{constructor(e,t,c,s,r,n,o,i){super(e,t,c,n),this.changeDetector=s,this.formBuilder=r,this.dataService=n,this.modalService=o,this.notificationService=i,this.fetchHistory=new l.a,this.addressDefaultsUpdated=!1,this.ordersPerPage=10,this.currentOrdersPage=1,this.orderListUpdates$=new l.a,this.customFields=this.getCustomFieldConfig("Customer"),this.addressCustomFields=this.getCustomFieldConfig("Address"),this.detailForm=this.formBuilder.group({customer:this.formBuilder.group({title:"",firstName:["",d.C.required],lastName:["",d.C.required],phoneNumber:"",emailAddress:["",[d.C.required,d.C.email]],password:"",customFields:this.formBuilder.group(this.customFields.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:""}),{}))}),addresses:new d.c([])})}ngOnInit(){this.init(),this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(e=>e.countries.items).pipe(Object(ae.a)(1));const e=this.entity$.pipe(function(...e){return t=>t.lift.call(Object(de.a)(t,...e))}(this.orderListUpdates$));this.orders$=e.pipe(Object(o.a)(e=>e.orders.items)),this.ordersCount$=this.entity$.pipe(Object(o.a)(e=>e.orders.totalItems)),this.history$=this.fetchHistory.pipe(Object(m.a)(null),Object(n.a)(()=>this.dataService.customer.getCustomerHistory(this.id,{sort:{createdAt:s.L.DESC}}).mapStream(e=>{var t;return null===(t=e.customer)||void 0===t?void 0:t.history.items})))}ngOnDestroy(){this.destroy(),this.orderListUpdates$.complete()}customFieldIsSet(e){return!!this.detailForm.get(["customer","customFields",e])}getAddressFormControls(){return this.detailForm.get(["addresses"]).controls}setDefaultBillingAddressId(e){this.defaultBillingAddressId=e,this.addressDefaultsUpdated=!0}setDefaultShippingAddressId(e){this.defaultShippingAddressId=e,this.addressDefaultsUpdated=!0}addAddress(){const e=this.detailForm.get("addresses"),t=this.formBuilder.group({fullName:"",company:"",streetLine1:["",d.C.required],streetLine2:"",city:"",province:"",postalCode:"",countryCode:["",d.C.required],phoneNumber:"",defaultShippingAddress:!1,defaultBillingAddress:!1});if(this.addressCustomFields.length){const e=this.formBuilder.group({});for(const t of this.addressCustomFields)e.addControl(t.name,new d.f(""));t.addControl("customFields",e)}e.push(t)}setOrderItemsPerPage(e){this.ordersPerPage=+e,this.fetchOrdersList()}setOrderCurrentPage(e){this.currentOrdersPage=+e,this.fetchOrdersList()}create(){var e;const t=this.detailForm.get("customer");if(!t)return;const c=t.value,s=null===(e=t.get("customFields"))||void 0===e?void 0:e.value,r={title:c.title,emailAddress:c.emailAddress,firstName:c.firstName,lastName:c.lastName,phoneNumber:c.phoneNumber,customFields:s};this.dataService.customer.createCustomer(r,c.password).subscribe(({createCustomer:e})=>{switch(e.__typename){case"Customer":this.notificationService.success(Object(se.a)("common.notify-create-success"),{entity:"Customer"}),e.emailAddress&&!c.password&&this.notificationService.notify({message:Object(se.a)("customer.email-verification-sent"),translationVars:{emailAddress:c.emailAddress},type:"info",duration:1e4}),this.detailForm.markAsPristine(),this.addressDefaultsUpdated=!1,this.changeDetector.markForCheck(),this.router.navigate(["../",e.id],{relativeTo:this.route});break;case"EmailAddressConflictError":this.notificationService.error(e.message)}})}save(){this.entity$.pipe(Object(Q.a)(1),Object(le.a)(({id:e})=>{var t;const c=[],s=this.detailForm.get("customer");if(s&&s.dirty){const r=s.value,n=null===(t=s.get("customFields"))||void 0===t?void 0:t.value,i={id:e,title:r.title,emailAddress:r.emailAddress,firstName:r.firstName,lastName:r.lastName,phoneNumber:r.phoneNumber,customFields:n};c.push(this.dataService.customer.updateCustomer(i).pipe(Object(o.a)(e=>e.updateCustomer)))}const r=this.detailForm.get("addresses");if(r&&r.dirty||this.addressDefaultsUpdated)for(const n of r.controls)if(n.dirty||this.addressDefaultsUpdated){const t=n.value,s={fullName:t.fullName,company:t.company,streetLine1:t.streetLine1,streetLine2:t.streetLine2,city:t.city,province:t.province,postalCode:t.postalCode,countryCode:t.countryCode,phoneNumber:t.phoneNumber,defaultShippingAddress:this.defaultShippingAddressId===t.id,defaultBillingAddress:this.defaultBillingAddressId===t.id,customFields:t.customFields};t.id?c.push(this.dataService.customer.updateCustomerAddress(Object.assign(Object.assign({},s),{id:t.id})).pipe(Object(o.a)(e=>e.updateCustomerAddress))):c.push(this.dataService.customer.createCustomerAddress(e,s).pipe(Object(o.a)(e=>e.createCustomerAddress)))}return Object(ne.a)(c)})).subscribe(e=>{for(const t of e)switch(t.__typename){case"Customer":case"Address":this.notificationService.success(Object(se.a)("common.notify-update-success"),{entity:"Customer"}),this.detailForm.markAsPristine(),this.addressDefaultsUpdated=!1,this.changeDetector.markForCheck(),this.fetchHistory.next();break;case"EmailAddressConflictError":this.notificationService.error(t.message)}},e=>{this.notificationService.error(Object(se.a)("common.notify-update-error"),{entity:"Customer"})})}addToGroup(){this.modalService.fromComponent(Ce,{size:"md"}).pipe(Object(n.a)(e=>e?Object(oe.a)(e):ie.a),Object(ue.a)(e=>this.dataService.customer.addCustomersToGroup(e,[this.id]))).subscribe({next:e=>{this.notificationService.success(Object(se.a)("customer.add-customers-to-group-success"),{customerCount:1,groupName:e.addCustomersToGroup.name})},complete:()=>{this.dataService.customer.getCustomer(this.id,{take:0}).single$.subscribe(),this.fetchHistory.next()}})}removeFromGroup(e){this.modalService.dialog({title:Object(se.a)("customer.confirm-remove-customer-from-group"),buttons:[{type:"secondary",label:Object(se.a)("common.cancel")},{type:"danger",label:Object(se.a)("common.delete"),returnValue:!0}]}).pipe(Object(n.a)(t=>t?this.dataService.customer.removeCustomersFromGroup(e.id,[this.id]):ie.a),Object(n.a)(()=>this.dataService.customer.getCustomer(this.id,{take:0}).single$)).subscribe(t=>{this.notificationService.success(Object(se.a)("customer.remove-customers-from-group-success"),{customerCount:1,groupName:e.name}),this.fetchHistory.next()})}addNoteToCustomer({note:e}){this.dataService.customer.addNoteToCustomer(this.id,e).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success(Object(se.a)("common.notify-create-success"),{entity:"Note"})})}updateNote(e){this.modalService.fromComponent(s.u,{closable:!0,locals:{displayPrivacyControls:!1,note:e.data.note}}).pipe(Object(n.a)(t=>t?this.dataService.customer.updateCustomerNote({noteId:e.id,note:t.note}):ie.a)).subscribe(e=>{this.fetchHistory.next(),this.notificationService.success(Object(se.a)("common.notify-update-success"),{entity:"Note"})})}deleteNote(e){return this.modalService.dialog({title:Object(se.a)("common.confirm-delete-note"),body:e.data.note,buttons:[{type:"secondary",label:Object(se.a)("common.cancel")},{type:"danger",label:Object(se.a)("common.delete"),returnValue:!0}]}).pipe(Object(n.a)(t=>t?this.dataService.customer.deleteCustomerNote(e.id):ie.a)).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success(Object(se.a)("common.notify-delete-success"),{entity:"Note"})})}setFormValues(e){var t,c;const s=this.detailForm.get("customer");if(s&&s.patchValue({title:e.title,firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phoneNumber,emailAddress:e.emailAddress}),e.addresses){const c=new d.c([]);for(const s of e.addresses){const e=s,{customFields:r}=e,n=Object(ce.c)(e,["customFields"]),o=this.formBuilder.group(Object.assign(Object.assign({},n),{countryCode:s.country.code}));if(c.push(o),s.defaultShippingAddress&&(this.defaultShippingAddressId=s.id),s.defaultBillingAddress&&(this.defaultBillingAddressId=s.id),this.addressCustomFields.length){const e=this.formBuilder.group({});for(const c of this.addressCustomFields){const r=c.name,n=null===(t=s.customFields)||void 0===t?void 0:t[r],o=new d.f(n);e.addControl(r,o)}o.addControl("customFields",e)}}this.detailForm.setControl("addresses",c)}if(this.customFields.length){const t=this.detailForm.get(["customer","customFields"]);for(const s of this.customFields){const r=s.name,n=null===(c=e.customFields)||void 0===c?void 0:c[r],o=t.get(r);o&&o.patchValue(n)}}this.changeDetector.markForCheck()}fetchOrdersList(){this.dataService.customer.getCustomer(this.id,{take:this.ordersPerPage,skip:(this.currentOrdersPage-1)*this.ordersPerPage}).single$.pipe(Object(o.a)(e=>e.customer),Object(U.a)(re.notNullOrUndefined)).subscribe(e=>this.orderListUpdates$.next(e))}}function It(e,t){1&e&&(i.hc(0,"span"),i.Vc(1),i.sc(2,"translate"),i.gc()),2&e&&(i.Qb(1),i.Wc(i.tc(2,1,"customer.update-customer-group")))}function _t(e,t){1&e&&(i.hc(0,"span"),i.Vc(1),i.sc(2,"translate"),i.gc()),2&e&&(i.Qb(1),i.Wc(i.tc(2,1,"customer.create-customer-group")))}function At(e,t){if(1&e&&(i.Tc(0,It,3,3,"span",4),i.Tc(1,_t,3,3,"span",4)),2&e){const e=i.rc();i.yc("ngIf",e.group.id),i.Qb(1),i.yc("ngIf",!e.group.id)}}function Pt(e,t){1&e&&(i.hc(0,"span"),i.Vc(1),i.sc(2,"translate"),i.gc()),2&e&&(i.Qb(1),i.Wc(i.tc(2,1,"customer.update-customer-group")))}function Nt(e,t){1&e&&(i.hc(0,"span"),i.Vc(1),i.sc(2,"translate"),i.gc()),2&e&&(i.Qb(1),i.Wc(i.tc(2,1,"customer.create-customer-group")))}function Mt(e,t){if(1&e){const e=i.ic();i.hc(0,"button",5),i.pc("click",function(){i.Lc(e);return i.rc().cancel()}),i.Vc(1),i.sc(2,"translate"),i.gc(),i.hc(3,"button",6),i.pc("click",function(){i.Lc(e);return i.rc().save()}),i.Tc(4,Pt,3,3,"span",4),i.Tc(5,Nt,3,3,"span",4),i.gc()}if(2&e){const e=i.rc();i.Qb(1),i.Wc(i.tc(2,4,"common.cancel")),i.Qb(2),i.yc("disabled",!e.group.name),i.Qb(1),i.yc("ngIf",e.group.id),i.Qb(1),i.yc("ngIf",!e.group.id)}}St.\u0275fac=function(e){return new(e||St)(i.bc(f.a),i.bc(f.e),i.bc(s.I),i.bc(i.j),i.bc(d.e),i.bc(s.s),i.bc(s.F),i.bc(s.G))},St.\u0275cmp=i.Vb({type:St,selectors:[["vdr-customer-detail"]],features:[i.Nb],decls:45,vars:57,consts:[[1,"flex","clr-align-items-center"],[3,"entity"],[3,"customer"],["class","last-login",3,"title",4,"ngIf"],["locationId","customer-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","title",3,"label","readOnlyToggle"],["id","title","type","text","formControlName","title"],["for","firstName",3,"label","readOnlyToggle"],["id","firstName","type","text","formControlName","firstName"],["for","lastName",3,"label","readOnlyToggle"],["id","lastName","type","text","formControlName","lastName"],["for","emailAddress",3,"label","readOnlyToggle"],["id","emailAddress","type","text","formControlName","emailAddress"],["for","phoneNumber",3,"label","readOnlyToggle"],["id","phoneNumber","type","text","formControlName","phoneNumber"],["for","password",3,"label",4,"ngIf"],["formGroupName","customFields",4,"ngIf"],["class","groups",4,"ngIf"],["class","clr-row",4,"ngIf"],[1,"last-login",3,"title"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],["for","password",3,"label"],["id","password","type","password","formControlName","password"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","Customer",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","Customer",3,"customFieldsFormGroup","customField"],[1,"groups"],[1,"clr-control-label"],[4,"ngIf","ngIfElse"],["noGroups",""],["class","btn btn-sm btn-secondary",3,"click",4,"vdrIfPermissions"],["icon","times",3,"colorFrom","iconClick",4,"ngFor","ngForOf"],["icon","times",3,"colorFrom","iconClick"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],[1,"clr-row"],[1,"clr-col-md-4"],[3,"availableCountries","isDefaultBilling","isDefaultShipping","addressForm","customFields","editable","setAsDefaultBilling","setAsDefaultShipping",4,"ngFor","ngForOf"],["class","btn btn-secondary",3,"click",4,"vdrIfPermissions"],[1,"clr-col-md-8"],[3,"items","itemsPerPage","totalItems","currentPage","emptyStateLabel","itemsPerPageChange","pageChange"],[3,"availableCountries","isDefaultBilling","isDefaultShipping","addressForm","customFields","editable","setAsDefaultBilling","setAsDefaultShipping"],[1,"btn","btn-secondary",3,"click"],[1,"left"],[1,"right"],["iconShape","shopping-cart",3,"label","linkTo"],[1,"clr-col-md-6"],[3,"customer","history","addNote","updateNote","deleteNote"]],template:function(e,t){if(1&e&&(i.hc(0,"vdr-action-bar"),i.hc(1,"vdr-ab-left"),i.hc(2,"div",0),i.cc(3,"vdr-entity-info",1),i.sc(4,"async"),i.cc(5,"vdr-customer-status-label",2),i.sc(6,"async"),i.Tc(7,nt,5,10,"div",3),i.sc(8,"async"),i.gc(),i.gc(),i.hc(9,"vdr-ab-right"),i.cc(10,"vdr-action-bar-items",4),i.Tc(11,ot,3,4,"button",5),i.sc(12,"async"),i.Tc(13,at,1,1,"ng-template",null,6,i.Uc),i.gc(),i.gc(),i.hc(15,"form",7),i.hc(16,"vdr-form-field",8),i.sc(17,"translate"),i.sc(18,"async"),i.cc(19,"input",9),i.gc(),i.hc(20,"vdr-form-field",10),i.sc(21,"translate"),i.sc(22,"async"),i.cc(23,"input",11),i.gc(),i.hc(24,"vdr-form-field",12),i.sc(25,"translate"),i.sc(26,"async"),i.cc(27,"input",13),i.gc(),i.hc(28,"vdr-form-field",14),i.sc(29,"translate"),i.sc(30,"async"),i.cc(31,"input",15),i.gc(),i.hc(32,"vdr-form-field",16),i.sc(33,"translate"),i.sc(34,"async"),i.cc(35,"input",17),i.gc(),i.Tc(36,dt,3,3,"vdr-form-field",18),i.sc(37,"async"),i.Tc(38,pt,5,4,"section",19),i.gc(),i.Tc(39,Ct,9,6,"div",20),i.sc(40,"async"),i.Tc(41,Tt,29,31,"div",21),i.sc(42,"async"),i.Tc(43,vt,5,6,"div",21),i.sc(44,"async")),2&e){const e=i.Ic(14);let c=null,s=null;i.Qb(3),i.yc("entity",i.tc(4,21,t.entity$)),i.Qb(2),i.yc("customer",i.tc(6,23,t.entity$)),i.Qb(2),i.yc("ngIf",null==(c=i.tc(8,25,t.entity$))||null==c.user?null:c.user.lastLogin),i.Qb(4),i.yc("ngIf",i.tc(12,27,t.isNew$))("ngIfElse",e),i.Qb(4),i.yc("formGroup",t.detailForm.get("customer")),i.Qb(1),i.yc("label",i.tc(17,29,"customer.title"))("readOnlyToggle",!i.tc(18,31,t.isNew$)),i.Qb(4),i.yc("label",i.tc(21,33,"customer.first-name"))("readOnlyToggle",!i.tc(22,35,t.isNew$)),i.Qb(4),i.yc("label",i.tc(25,37,"customer.last-name"))("readOnlyToggle",!i.tc(26,39,t.isNew$)),i.Qb(4),i.yc("label",i.tc(29,41,"customer.email-address"))("readOnlyToggle",!i.tc(30,43,t.isNew$)),i.Qb(4),i.yc("label",i.tc(33,45,"customer.phone-number"))("readOnlyToggle",!i.tc(34,47,t.isNew$)),i.Qb(4),i.yc("ngIf",i.tc(37,49,t.isNew$)),i.Qb(2),i.yc("ngIf",t.customFields.length),i.Qb(1),i.yc("ngIf",null==(s=i.tc(40,51,t.entity$))?null:s.groups),i.Qb(2),i.yc("ngIf",!i.tc(42,53,t.isNew$)),i.Qb(2),i.yc("ngIf",!i.tc(44,55,t.isNew$))}},directives:[Re.a,Re.b,B.a,Te,D.o,Re.c,ve.a,d.E,d.q,d.j,Se.a,C.a,d.b,d.p,d.h,Ie.a,d.k,W.u,D.n,_e.a,x.a,W.o,R.a,y.a,te,O.a,tt],pipes:[D.b,E.d,ct.a,st.a,T.a,rt.a],styles:[".last-login[_ngcontent-%COMP%]{margin-left:6px;color:var(--color-grey-500)}"],changeDetection:0});const Ft=function(){return["CreateCustomerGroup","UpdateCustomerGroup"]};class Ut{cancel(){this.resolveWith()}save(){this.resolveWith(this.group.name)}}Ut.\u0275fac=function(e){return new(e||Ut)},Ut.\u0275cmp=i.Vb({type:Ut,selectors:[["vdr-customer-group-detail-dialog"]],decls:6,vars:8,consts:[["vdrDialogTitle",""],["for","name",3,"label"],["id","name","type","text",3,"ngModel","readonly","ngModelChange"],["vdrDialogButtons",""],[4,"ngIf"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(i.Tc(0,At,2,2,"ng-template",0),i.hc(1,"vdr-form-field",1),i.sc(2,"translate"),i.hc(3,"input",2),i.pc("ngModelChange",function(e){return t.group.name=e}),i.sc(4,"hasPermission"),i.gc(),i.gc(),i.Tc(5,Mt,6,6,"ng-template",3)),2&e&&(i.Qb(1),i.yc("label",i.tc(2,3,"common.name")),i.Qb(2),i.yc("ngModel",t.group.name)("readonly",!i.tc(4,5,i.Bc(7,Ft))))},directives:[a.a,Se.a,C.a,d.b,d.p,d.s,_.a,D.o],pipes:[E.d,T.a],styles:[""],changeDetection:0});var Qt=c("LRne"),Lt=c("CqXF"),Vt=c("8BSi");function Gt(e,t){if(1&e){const e=i.ic();i.hc(0,"button",7),i.pc("click",function(){i.Lc(e);return i.rc().create()}),i.cc(1,"clr-icon",8),i.Vc(2),i.sc(3,"translate"),i.gc()}2&e&&(i.Qb(2),i.Xc(" ",i.tc(3,1,"customer.create-new-customer-group")," "))}const wt=function(e){return{contents:e}},kt=function(e){return["./",e]};function jt(e,t){if(1&e){const e=i.ic();i.hc(0,"tr"),i.sc(1,"async"),i.hc(2,"td",11),i.cc(3,"vdr-entity-info",12),i.gc(),i.hc(4,"td",11),i.hc(5,"vdr-chip",13),i.Vc(6),i.gc(),i.gc(),i.hc(7,"td",14),i.hc(8,"a",15),i.cc(9,"clr-icon",16),i.Vc(10),i.sc(11,"translate"),i.gc(),i.gc(),i.hc(12,"td",17),i.hc(13,"button",18),i.pc("click",function(){i.Lc(e);const c=t.$implicit;return i.rc(2).update(c)}),i.cc(14,"clr-icon",19),i.Vc(15),i.sc(16,"translate"),i.gc(),i.gc(),i.hc(17,"td",17),i.hc(18,"vdr-dropdown"),i.hc(19,"button",20),i.Vc(20),i.sc(21,"translate"),i.cc(22,"clr-icon",21),i.gc(),i.hc(23,"vdr-dropdown-menu",22),i.hc(24,"button",23),i.pc("click",function(){i.Lc(e);const c=t.$implicit;return i.rc(2).delete(c.id)}),i.sc(25,"hasPermission"),i.cc(26,"clr-icon",24),i.Vc(27),i.sc(28,"translate"),i.gc(),i.gc(),i.gc(),i.gc(),i.gc()}if(2&e){const e=t.$implicit,c=i.rc(2);let s=null;i.Tb("active",e.id===(null==(s=i.tc(1,11,c.activeGroup$))?null:s.id)),i.Qb(3),i.yc("entity",e),i.Qb(2),i.yc("colorFrom",e.id),i.Qb(1),i.Wc(e.name),i.Qb(2),i.yc("routerLink",i.Cc(25,kt,i.Cc(23,wt,e.id))),i.Qb(2),i.Xc(" ",i.tc(11,13,"customer.view-group-members")," "),i.Qb(5),i.Xc(" ",i.tc(16,15,"common.edit")," "),i.Qb(5),i.Xc(" ",i.tc(21,17,"common.actions")," "),i.Qb(4),i.yc("disabled",!i.tc(25,19,"DeleteCustomerGroup")),i.Qb(3),i.Xc(" ",i.tc(28,21,"common.delete")," ")}}function $t(e,t){if(1&e&&(i.hc(0,"table",9),i.sc(1,"async"),i.hc(2,"tbody"),i.Tc(3,jt,29,27,"tr",10),i.sc(4,"async"),i.gc(),i.gc()),2&e){const e=i.rc();i.Tb("expanded",i.tc(1,3,e.activeGroup$)),i.Qb(3),i.yc("ngForOf",i.tc(4,5,e.groups$))}}function Bt(e,t){1&e&&i.cc(0,"vdr-empty-placeholder")}const xt=function(e){return{groupName:e}};function Wt(e,t){if(1&e){const e=i.ic();i.fc(0),i.hc(1,"div",25),i.hc(2,"div",26),i.Vc(3),i.sc(4,"async"),i.gc(),i.cc(5,"div",27),i.hc(6,"button",28),i.pc("click",function(){i.Lc(e);return i.rc().closeMembers()}),i.cc(7,"clr-icon",29),i.gc(),i.gc(),i.hc(8,"div",30),i.hc(9,"vdr-dropdown"),i.hc(10,"button",31),i.Vc(11),i.sc(12,"translate"),i.cc(13,"clr-icon",21),i.gc(),i.hc(14,"vdr-dropdown-menu",22),i.hc(15,"button",32),i.pc("click",function(){i.Lc(e);const c=t.ngIf,s=i.rc();return s.removeFromGroup(c,s.selectedCustomerIds)}),i.sc(16,"hasPermission"),i.cc(17,"clr-icon",24),i.Vc(18),i.sc(19,"translate"),i.gc(),i.gc(),i.gc(),i.hc(20,"button",33),i.pc("click",function(){i.Lc(e);const c=t.ngIf;return i.rc().addToGroup(c)}),i.Vc(21),i.sc(22,"translate"),i.gc(),i.gc(),i.hc(23,"vdr-customer-group-member-list",34),i.pc("selectionChange",function(t){i.Lc(e);return i.rc().selectedCustomerIds=t})("fetchParamsChange",function(t){i.Lc(e);return i.rc().fetchGroupMembers$.next(t)}),i.sc(24,"async"),i.sc(25,"async"),i.gc(),i.ec()}if(2&e){const e=t.ngIf,c=i.rc();i.Qb(3),i.Yc(" ",e.name," (",i.tc(4,11,c.membersTotal$),") "),i.Qb(7),i.yc("disabled",0===c.selectedCustomerIds.length),i.Qb(1),i.Xc(" ",i.tc(12,13,"common.with-selected")," "),i.Qb(4),i.yc("disabled",!i.tc(16,15,"UpdateCustomerGroup")),i.Qb(3),i.Xc(" ",i.tc(19,17,"customer.remove-from-group")," "),i.Qb(3),i.Xc(" ",i.uc(22,19,"customer.add-customers-to-group",i.Cc(26,xt,e.name))," "),i.Qb(2),i.yc("members",i.tc(24,22,c.members$))("route",c.route)("totalItems",i.tc(25,24,c.membersTotal$))("selectedMemberIds",c.selectedCustomerIds)}}class Xt{constructor(e,t,c,s,n){this.dataService=e,this.notificationService=t,this.modalService=c,this.route=s,this.router=n,this.selectedCustomerIds=[],this.fetchGroupMembers$=new r.a({skip:0,take:0,filterTerm:""}),this.refreshActiveGroupMembers$=new r.a(void 0)}ngOnInit(){this.groups$=this.dataService.customer.getCustomerGroupList().mapStream(e=>e.customerGroups.items);const e=this.route.paramMap.pipe(Object(o.a)(e=>e.get("contents")),Object(p.a)(),Object(h.a)(()=>this.selectedCustomerIds=[]));this.listIsEmpty$=this.groups$.pipe(Object(o.a)(e=>0===e.length)),this.activeGroup$=Object(u.a)(this.groups$,e).pipe(Object(o.a)(([e,t])=>{if(t)return e.find(e=>e.id===t)}));const t=Object(u.a)(this.activeGroup$,this.fetchGroupMembers$,this.refreshActiveGroupMembers$).pipe(Object(n.a)(([e,{skip:t,take:c,filterTerm:s}])=>e?this.dataService.customer.getCustomerGroupWithCustomers(e.id,{skip:t,take:c,filter:{emailAddress:{contains:s}}}).mapStream(e=>{var t;return null===(t=e.customerGroup)||void 0===t?void 0:t.customers}):Object(Qt.a)(void 0)));this.members$=t.pipe(Object(o.a)(e=>{var t;return null!==(t=null==e?void 0:e.items)&&void 0!==t?t:[]})),this.membersTotal$=t.pipe(Object(o.a)(e=>{var t;return null!==(t=null==e?void 0:e.totalItems)&&void 0!==t?t:0}))}create(){this.modalService.fromComponent(Ut,{locals:{group:{name:""}}}).pipe(Object(n.a)(e=>e?this.dataService.customer.createCustomerGroup({name:e,customerIds:[]}):ie.a),Object(n.a)(()=>this.dataService.customer.getCustomerGroupList().single$)).subscribe(()=>{this.notificationService.success(Object(se.a)("common.notify-create-success"),{entity:"CustomerGroup"})},e=>{this.notificationService.error(Object(se.a)("common.notify-create-error"),{entity:"CustomerGroup"})})}delete(e){this.modalService.dialog({title:Object(se.a)("customer.confirm-delete-customer-group"),buttons:[{type:"secondary",label:Object(se.a)("common.cancel")},{type:"danger",label:Object(se.a)("common.delete"),returnValue:!0}]}).pipe(Object(n.a)(t=>t?this.dataService.customer.deleteCustomerGroup(e):ie.a),Object(n.a)(e=>e.deleteCustomerGroup.result===s.t.DELETED?this.dataService.customer.getCustomerGroupList().mapSingle(()=>({errorMessage:!1})):Object(Qt.a)({errorMessage:e.deleteCustomerGroup.message}))).subscribe(e=>{"string"==typeof e.errorMessage?this.notificationService.error(e.errorMessage):this.notificationService.success(Object(se.a)("common.notify-delete-success"),{entity:"CustomerGroup"})},e=>{this.notificationService.error(Object(se.a)("common.notify-delete-error"),{entity:"CustomerGroup"})})}update(e){this.modalService.fromComponent(Ut,{locals:{group:e}}).pipe(Object(n.a)(t=>t?this.dataService.customer.updateCustomerGroup({id:e.id,name:t}):ie.a)).subscribe(()=>{this.notificationService.success(Object(se.a)("common.notify-update-success"),{entity:"CustomerGroup"})},e=>{this.notificationService.error(Object(se.a)("common.notify-update-error"),{entity:"CustomerGroup"})})}closeMembers(){const e=Object.assign({},this.route.snapshot.params);delete e.contents,this.router.navigate(["./",e],{relativeTo:this.route,queryParamsHandling:"preserve"})}addToGroup(e){this.modalService.fromComponent(F,{locals:{group:e,route:this.route},size:"md",verticalAlign:"top"}).pipe(Object(n.a)(t=>t?this.dataService.customer.addCustomersToGroup(e.id,t).pipe(Object(Lt.a)(t)):ie.a)).subscribe({next:t=>{this.notificationService.success(Object(se.a)("customer.add-customers-to-group-success"),{customerCount:t.length,groupName:e.name}),this.refreshActiveGroupMembers$.next(),this.selectedCustomerIds=[]}})}removeFromGroup(e,t){this.dataService.customer.removeCustomersFromGroup(e.id,t).subscribe({complete:()=>{this.notificationService.success(Object(se.a)("customer.remove-customers-from-group-success"),{customerCount:t.length,groupName:e.name}),this.refreshActiveGroupMembers$.next(),this.selectedCustomerIds=[]}})}}Xt.\u0275fac=function(e){return new(e||Xt)(i.bc(s.s),i.bc(s.G),i.bc(s.F),i.bc(f.a),i.bc(f.e))},Xt.\u0275cmp=i.Vb({type:Xt,selectors:[["vdr-customer-group-list"]],decls:14,vars:12,consts:[["locationId","customer-group-list"],["class","btn btn-primary",3,"click",4,"vdrIfPermissions"],[1,"group-wrapper"],["class","table group-list",3,"expanded",4,"ngIf","ngIfElse"],["emptyPlaceholder",""],[1,"group-members"],[4,"ngIf"],[1,"btn","btn-primary",3,"click"],["shape","plus"],[1,"table","group-list"],[3,"active",4,"ngFor","ngForOf"],[1,"left","align-middle"],[3,"entity"],[3,"colorFrom"],[1,"text-right","align-middle"],["queryParamsHandling","preserve",1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","view-list"],[1,"align-middle"],[1,"btn","btn-link","btn-sm",3,"click"],["shape","edit"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","trash",1,"is-danger"],[1,"flex"],[1,"header-title-row"],[1,"flex-spacer"],["type","button",1,"close-button",3,"click"],["shape","close"],[1,"controls"],["type","button","vdrDropdownTrigger","",1,"btn","btn-secondary","btn-sm",3,"disabled"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],[1,"btn","btn-secondary","btn-sm",3,"click"],[3,"members","route","totalItems","selectedMemberIds","selectionChange","fetchParamsChange"]],template:function(e,t){if(1&e&&(i.hc(0,"vdr-action-bar"),i.cc(1,"vdr-ab-left"),i.hc(2,"vdr-ab-right"),i.cc(3,"vdr-action-bar-items",0),i.Tc(4,Gt,4,3,"button",1),i.gc(),i.gc(),i.hc(5,"div",2),i.Tc(6,$t,5,7,"table",3),i.sc(7,"async"),i.Tc(8,Bt,1,0,"ng-template",null,4,i.Uc),i.hc(10,"div",5),i.sc(11,"async"),i.Tc(12,Wt,26,28,"ng-container",6),i.sc(13,"async"),i.gc(),i.gc()),2&e){const e=i.Ic(9);i.Qb(4),i.yc("vdrIfPermissions","CreateCustomerGroup"),i.Qb(2),i.yc("ngIf",!i.tc(7,6,t.listIsEmpty$))("ngIfElse",e),i.Qb(4),i.Tb("expanded",i.tc(11,8,t.activeGroup$)),i.Qb(2),i.yc("ngIf",i.tc(13,10,t.activeGroup$))}},directives:[Re.a,Re.b,Re.c,ve.a,Ie.a,D.o,W.o,D.n,B.a,x.a,f.h,X.a,K.a,H.a,Y.a,Vt.a,I],pipes:[D.b,E.d,T.a],styles:[".group-wrapper[_ngcontent-%COMP%]{display:flex;height:calc(100% - 50px)}.group-wrapper[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]{flex:1;overflow:auto;margin-top:0}.group-wrapper[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.group-wrapper[_ngcontent-%COMP%]   .group-list.expanded[_ngcontent-%COMP%]{width:calc(100% - 40vw)}.group-members[_ngcontent-%COMP%]{height:100%;width:0;opacity:0;visibility:hidden;overflow:auto;transition:width .3s,opacity .2s .3s,visibility 0s .3s}.group-members.expanded[_ngcontent-%COMP%]{width:40vw;visibility:visible;opacity:1;padding-left:12px}.group-members[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{margin:0;background:none;border:none;cursor:pointer}.group-members[_ngcontent-%COMP%]     table.table{margin-top:0}.group-members[_ngcontent-%COMP%]     table.table th{top:0}.group-members[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between}vdr-empty-placeholder[_ngcontent-%COMP%]{flex:1}"],changeDetection:0});var Kt=c("Tn/u");const Ht=function(){return["./create"]};function Yt(e,t){1&e&&(i.hc(0,"a",6),i.cc(1,"clr-icon",7),i.Vc(2),i.sc(3,"translate"),i.gc()),2&e&&(i.yc("routerLink",i.Bc(4,Ht)),i.Qb(2),i.Xc(" ",i.tc(3,2,"customer.create-new-customer")," "))}const Zt=function(e){return["./",e]};function zt(e,t){if(1&e){const e=i.ic();i.hc(0,"td",8),i.Vc(1),i.gc(),i.hc(2,"td",8),i.Vc(3),i.gc(),i.hc(4,"td",8),i.cc(5,"vdr-customer-status-label",9),i.gc(),i.hc(6,"td",10),i.cc(7,"vdr-table-row-action",11),i.sc(8,"translate"),i.gc(),i.hc(9,"td"),i.hc(10,"vdr-dropdown"),i.hc(11,"button",12),i.Vc(12),i.sc(13,"translate"),i.cc(14,"clr-icon",13),i.gc(),i.hc(15,"vdr-dropdown-menu",14),i.hc(16,"button",15),i.pc("click",function(){i.Lc(e);const c=t.item;return i.rc().deleteCustomer(c)}),i.sc(17,"hasPermission"),i.cc(18,"clr-icon",16),i.Vc(19),i.sc(20,"translate"),i.gc(),i.gc(),i.gc(),i.gc()}if(2&e){const e=t.item;i.Qb(1),i.Zc(" ",e.title," ",e.firstName," ",e.lastName," "),i.Qb(2),i.Wc(e.emailAddress),i.Qb(2),i.yc("customer",e),i.Qb(2),i.yc("label",i.tc(8,10,"common.edit"))("linkTo",i.Cc(18,Zt,e.id)),i.Qb(5),i.Xc(" ",i.tc(13,12,"common.actions")," "),i.Qb(4),i.yc("disabled",!i.tc(17,14,"DeleteCustomer")),i.Qb(3),i.Xc(" ",i.tc(20,16,"common.delete")," ")}}class qt extends s.n{constructor(e,t,c,s,r){super(t,c),this.dataService=e,this.modalService=s,this.notificationService=r,this.emailSearchTerm=new d.f(""),this.lastNameSearchTerm=new d.f(""),super.setQueryFn((...e)=>this.dataService.customer.getCustomerList(...e).refetchOnChannelChange(),e=>e.customers,(e,t)=>({options:{skip:e,take:t,filter:{emailAddress:{contains:this.emailSearchTerm.value},lastName:{contains:this.lastNameSearchTerm.value}},sort:{createdAt:Kt.SortOrder.DESC}}}))}ngOnInit(){super.ngOnInit(),Object(de.a)(this.emailSearchTerm.valueChanges,this.lastNameSearchTerm.valueChanges).pipe(Object(U.a)(e=>2<e.length||0===e.length),Object(g.a)(250),Object(b.a)(this.destroy$)).subscribe(()=>this.refresh())}deleteCustomer(e){return this.modalService.dialog({title:Object(se.a)("catalog.confirm-delete-customer"),body:`${e.firstName} ${e.lastName}`,buttons:[{type:"secondary",label:Object(se.a)("common.cancel")},{type:"danger",label:Object(se.a)("common.delete"),returnValue:!0}]}).pipe(Object(n.a)(t=>t?this.dataService.customer.deleteCustomer(e.id):ie.a)).subscribe(()=>{this.notificationService.success(Object(se.a)("common.notify-delete-success"),{entity:"Customer"}),this.refresh()},e=>{this.notificationService.error(Object(se.a)("common.notify-delete-error"),{entity:"Customer"})})}}qt.\u0275fac=function(e){return new(e||qt)(i.bc(s.s),i.bc(f.e),i.bc(f.a),i.bc(s.F),i.bc(s.G))},qt.\u0275cmp=i.Vb({type:qt,selectors:[["vdr-customer-list"]],features:[i.Nb],decls:26,vars:32,consts:[["type","text","name","emailSearchTerm",1,"search-input","ml3",3,"formControl","placeholder"],["type","text","name","lastNameSearchTerm",1,"search-input","ml3",3,"formControl","placeholder"],["locationId","customer-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[3,"expand"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[3,"customer"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(i.hc(0,"vdr-action-bar"),i.hc(1,"vdr-ab-left"),i.cc(2,"input",0),i.sc(3,"translate"),i.cc(4,"input",1),i.sc(5,"translate"),i.gc(),i.hc(6,"vdr-ab-right"),i.cc(7,"vdr-action-bar-items",2),i.Tc(8,Yt,4,5,"a",3),i.gc(),i.gc(),i.hc(9,"vdr-data-table",4),i.pc("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),i.sc(10,"async"),i.sc(11,"async"),i.sc(12,"async"),i.sc(13,"async"),i.hc(14,"vdr-dt-column",5),i.Vc(15),i.sc(16,"translate"),i.gc(),i.hc(17,"vdr-dt-column",5),i.Vc(18),i.sc(19,"translate"),i.gc(),i.hc(20,"vdr-dt-column"),i.Vc(21),i.sc(22,"translate"),i.gc(),i.cc(23,"vdr-dt-column"),i.cc(24,"vdr-dt-column"),i.Tc(25,zt,21,20,"ng-template"),i.gc()),2&e&&(i.Qb(2),i.yc("formControl",t.emailSearchTerm)("placeholder",i.tc(3,14,"customer.search-customers-by-email")),i.Qb(2),i.yc("formControl",t.lastNameSearchTerm)("placeholder",i.tc(5,16,"customer.search-customers-by-last-name")),i.Qb(4),i.yc("vdrIfPermissions","CreateCustomer"),i.Qb(1),i.yc("items",i.tc(10,18,t.items$))("itemsPerPage",i.tc(11,20,t.itemsPerPage$))("totalItems",i.tc(12,22,t.totalItems$))("currentPage",i.tc(13,24,t.currentPage$)),i.Qb(5),i.yc("expand",!0),i.Qb(1),i.Wc(i.tc(16,26,"customer.name")),i.Qb(2),i.yc("expand",!0),i.Qb(1),i.Wc(i.tc(19,28,"customer.email-address")),i.Qb(3),i.Wc(i.tc(22,30,"customer.customer-type")))},directives:[Re.a,Re.b,C.a,d.b,d.p,d.g,Re.c,ve.a,Ie.a,R.a,y.a,f.h,W.o,Te,O.a,X.a,K.a,H.a,Y.a],pipes:[E.d,D.b,T.a],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]});class Jt extends s.m{constructor(e,t){super(e,{__typename:"Customer",id:"",createdAt:"",updatedAt:"",title:"",firstName:"",lastName:"",emailAddress:"",phoneNumber:null,addresses:null,user:null},e=>t.customer.getCustomer(e).mapStream(e=>e.customer))}}Jt.\u0275fac=function(e){return new(e||Jt)(i.lc(f.e),i.lc(s.s))},Jt.\u0275prov=i.Xb({token:Jt,factory:Jt.\u0275fac,providedIn:"root"});const ec=[{path:"customers",component:qt,pathMatch:"",data:{breadcrumb:Object(se.a)("breadcrumb.customers")}},{path:"customers/:id",component:St,resolve:Object(s.O)(Jt),canDeactivate:[s.o],data:{breadcrumb:tc}},{path:"groups",component:Xt,data:{breadcrumb:Object(se.a)("breadcrumb.customer-groups")}}];function tc(e,t){return Object(s.Q)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.customers",getName:e=>`${e.firstName} ${e.lastName}`,route:"customers"})}class cc{}cc.\u0275fac=function(e){return new(e||cc)},cc.\u0275mod=i.Zb({type:cc}),cc.\u0275inj=i.Yb({imports:[[s.J,f.i.forChild(ec)]]})}}]);
//# sourceMappingURL=6-es2015.d07142e29e187a42f1f7.js.map