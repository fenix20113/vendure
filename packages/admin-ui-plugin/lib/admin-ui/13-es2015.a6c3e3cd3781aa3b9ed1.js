(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"5PN2":function(c,e,t){"use strict";t.r(e),t.d(e,"HealthCheckComponent",function(){return v}),t.d(e,"JobListComponent",function(){return Y}),t.d(e,"JobStateLabelComponent",function(){return E}),t.d(e,"SystemModule",function(){return Z}),t.d(e,"systemRoutes",function(){return K});var s=t("t9nd"),n=t("fXoL"),r=t("uEVm"),a=t("ofXK"),o=t("nqNv"),i=t("8MG2"),l=t("2/wi"),d=t("sYmb"),h=t("HMPB");function u(c,e){1&c&&(n.fc(0),n.Vc(1),n.sc(2,"translate"),n.ec()),2&c&&(n.Qb(1),n.Xc(" ",n.tc(2,1,"system.health-all-systems-up")," "))}function b(c,e){1&c&&(n.Vc(0),n.sc(1,"translate")),2&c&&n.Xc(" ",n.tc(1,1,"system.health-error")," ")}const g=function(c,e){return{"is-success":c,"is-danger":e}};function m(c,e){if(1&c&&(n.hc(0,"div",7),n.hc(1,"div",8),n.cc(2,"clr-icon",9),n.gc(),n.hc(3,"div",10),n.Tc(4,u,3,3,"ng-container",11),n.Tc(5,b,2,3,"ng-template",null,12,n.Uc),n.hc(7,"div",13),n.Vc(8),n.sc(9,"translate"),n.sc(10,"localeDate"),n.sc(11,"async"),n.gc(),n.gc(),n.gc()),2&c){const c=e.ngIf,t=n.Ic(6),s=n.rc();n.Qb(2),n.yc("ngClass",n.Dc(13,g,"ok"===c,"ok"!==c)),n.Rb("shape","ok"===c?"check-circle":"exclamation-circle"),n.Qb(2),n.yc("ngIf","ok"===c)("ngIfElse",t),n.Qb(4),n.Yc(" ",n.tc(9,6,"system.health-last-checked"),": ",n.uc(10,8,n.tc(11,11,s.healthCheckService.lastCheck$),"mediumTime")," ")}}function p(c,e){1&c&&(n.fc(0),n.cc(1,"clr-icon",17),n.Vc(2),n.sc(3,"translate"),n.ec()),2&c&&(n.Qb(2),n.Xc(" ",n.tc(3,1,"system.health-status-up")," "))}function f(c,e){1&c&&(n.cc(0,"clr-icon",18),n.Vc(1),n.sc(2,"translate")),2&c&&(n.Qb(1),n.Xc(" ",n.tc(2,1,"system.health-status-down")," "))}function y(c,e){if(1&c&&(n.hc(0,"tr"),n.hc(1,"td",14),n.Vc(2),n.gc(),n.hc(3,"td",14),n.hc(4,"vdr-chip",15),n.Tc(5,p,4,3,"ng-container",11),n.Tc(6,f,3,3,"ng-template",null,16,n.Uc),n.gc(),n.gc(),n.hc(8,"td",14),n.Vc(9),n.gc(),n.gc()),2&c){const c=e.$implicit,t=n.Ic(7);n.Qb(2),n.Wc(c.key),n.Qb(2),n.yc("colorType","up"===c.result.status?"success":"error"),n.Qb(1),n.yc("ngIf","up"===c.result.status)("ngIfElse",t),n.Qb(4),n.Wc(c.result.message)}}class v{constructor(c){this.healthCheckService=c}}v.\u0275fac=function(c){return new(c||v)(n.bc(s.x))},v.\u0275cmp=n.Vb({type:v,selectors:[["vdr-health-check"]],decls:25,vars:18,consts:[["class","system-status-header",4,"ngIf"],["locationId","system-status"],[1,"btn","btn-secondary",3,"click"],["shape","refresh"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"],[1,"system-status-header"],[1,"status-icon"],["size","48",3,"ngClass"],[1,"status-detail"],[4,"ngIf","ngIfElse"],["error",""],[1,"last-checked"],[1,"align-middle","left"],[3,"colorType"],["down",""],["shape","check-circle"],["shape","exclamation-circle"]],template:function(c,e){1&c&&(n.hc(0,"vdr-action-bar"),n.hc(1,"vdr-ab-left"),n.Tc(2,m,12,16,"div",0),n.sc(3,"async"),n.gc(),n.hc(4,"vdr-ab-right"),n.cc(5,"vdr-action-bar-items",1),n.hc(6,"button",2),n.pc("click",function(){return e.healthCheckService.refresh()}),n.cc(7,"clr-icon",3),n.Vc(8),n.sc(9,"translate"),n.gc(),n.gc(),n.gc(),n.hc(10,"table",4),n.hc(11,"thead"),n.hc(12,"tr"),n.hc(13,"th",5),n.Vc(14),n.sc(15,"translate"),n.gc(),n.hc(16,"th",5),n.Vc(17),n.sc(18,"translate"),n.gc(),n.hc(19,"th",5),n.Vc(20),n.sc(21,"translate"),n.gc(),n.gc(),n.gc(),n.hc(22,"tbody"),n.Tc(23,y,10,5,"tr",6),n.sc(24,"async"),n.gc(),n.gc()),2&c&&(n.Qb(2),n.yc("ngIf",n.tc(3,6,e.healthCheckService.status$)),n.Qb(6),n.Xc(" ",n.tc(9,8,"system.health-refresh")," "),n.Qb(6),n.Xc(" ",n.tc(15,10,"common.name")," "),n.Qb(3),n.Xc(" ",n.tc(18,12,"system.health-status")," "),n.Qb(3),n.Xc(" ",n.tc(21,14,"system.health-message")," "),n.Qb(3),n.yc("ngForOf",n.tc(24,16,e.healthCheckService.details$)))},directives:[r.a,r.b,a.o,r.c,o.a,i.o,a.n,a.m,l.a],pipes:[a.b,d.d,h.a],styles:[".system-status-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.system-status-header[_ngcontent-%COMP%]   .status-detail[_ngcontent-%COMP%]{font-weight:700}.system-status-header[_ngcontent-%COMP%]   .last-checked[_ngcontent-%COMP%]{font-weight:400;color:var(--color-grey-500)}"],changeDetection:0});var Q=t("3Pt+"),I=t("PqYM"),j=t("1G5W"),w=t("pLZG"),C=t("lJxs"),k=t("tyNb"),V=t("Bzlx"),P=t("ZOsW"),T=t("CotX"),S=t("r2d8"),N=t("iszU");function O(c,e){if(1&c&&(n.hc(0,"span",2),n.Vc(1),n.sc(2,"percent"),n.gc()),2&c){const c=n.rc();n.Qb(1),n.Xc(" ",n.tc(2,1,c.job.progress/100)," ")}}class E{get iconShape(){switch(this.job.state){case s.B.COMPLETED:return"check-circle";case s.B.FAILED:return"exclamation-circle";case s.B.CANCELLED:return"ban";case s.B.PENDING:case s.B.RETRYING:return"hourglass";case s.B.RUNNING:return"sync"}}get colorType(){switch(this.job.state){case s.B.COMPLETED:return"success";case s.B.FAILED:case s.B.CANCELLED:return"error";case s.B.PENDING:case s.B.RETRYING:return"";case s.B.RUNNING:return"warning"}}}E.\u0275fac=function(c){return new(c||E)},E.\u0275cmp=n.Vb({type:E,selectors:[["vdr-job-state-label"]],inputs:{job:"job"},decls:5,vars:6,consts:[[3,"colorType"],["class","progress",4,"ngIf"],[1,"progress"]],template:function(c,e){1&c&&(n.hc(0,"vdr-chip",0),n.cc(1,"clr-icon"),n.Vc(2),n.sc(3,"titlecase"),n.Tc(4,O,3,3,"span",1),n.gc()),2&c&&(n.yc("colorType",e.colorType),n.Qb(1),n.Rb("shape",e.iconShape),n.Qb(1),n.Xc(" ",n.tc(3,4,e.job.state)," "),n.Qb(2),n.yc("ngIf","RUNNING"===e.job.state))},directives:[l.a,i.o,a.o],pipes:[a.y,a.v],styles:[".progress[_ngcontent-%COMP%]{margin-left:3px}clr-icon[_ngcontent-%COMP%]{min-width:12px}"],changeDetection:0});var D=t("zzDm"),x=t("eBFp"),F=t("IKcI"),X=t("2zLM"),q=t("EFLa"),B=t("uHMJ"),L=t("6qAB"),M=t("V0to");function W(c,e){1&c&&(n.fc(0),n.Vc(1),n.sc(2,"translate"),n.ec()),2&c&&(n.Qb(1),n.Xc(" ",n.tc(2,1,"system.all-job-queues")," "))}function J(c,e){if(1&c&&(n.hc(0,"vdr-chip",8),n.Vc(1),n.gc()),2&c){const c=n.rc().item;n.yc("colorFrom",c.name),n.Qb(1),n.Wc(c.name)}}function R(c,e){if(1&c&&(n.Tc(0,W,3,3,"ng-container",6),n.Tc(1,J,2,2,"ng-template",null,7,n.Uc)),2&c){const c=e.item,t=n.Ic(2);n.yc("ngIf","all"===c.name)("ngIfElse",t)}}function G(c,e){if(1&c&&(n.hc(0,"vdr-dropdown"),n.hc(1,"button",14),n.sc(2,"translate"),n.cc(3,"clr-icon",15),n.gc(),n.hc(4,"vdr-dropdown-menu"),n.hc(5,"div",16),n.cc(6,"vdr-object-tree",17),n.gc(),n.gc(),n.gc()),2&c){const c=n.rc().item;n.Qb(1),n.yc("title",n.tc(2,2,"system.job-data")),n.Qb(5),n.yc("value",c.data)}}function $(c,e){if(1&c&&(n.hc(0,"vdr-dropdown"),n.hc(1,"button",18),n.cc(2,"clr-icon",15),n.Vc(3),n.sc(4,"translate"),n.gc(),n.hc(5,"vdr-dropdown-menu"),n.hc(6,"div",16),n.cc(7,"vdr-object-tree",17),n.gc(),n.gc(),n.gc()),2&c){const c=n.rc().item;n.Qb(3),n.Xc(" ",n.tc(4,2,"system.job-result")," "),n.Qb(4),n.yc("value",c.result)}}function A(c,e){if(1&c&&(n.hc(0,"vdr-dropdown"),n.hc(1,"button",18),n.cc(2,"clr-icon",19),n.Vc(3),n.sc(4,"translate"),n.gc(),n.hc(5,"vdr-dropdown-menu"),n.hc(6,"div",16),n.Vc(7),n.gc(),n.gc(),n.gc()),2&c){const c=n.rc().item;n.Qb(3),n.Xc(" ",n.tc(4,2,"system.job-error")," "),n.Qb(4),n.Xc(" ",c.error," ")}}const U=function(){return["DeleteSettings","DeleteSystem"]};function _(c,e){if(1&c){const c=n.ic();n.hc(0,"vdr-dropdown"),n.hc(1,"button",20),n.cc(2,"clr-icon",21),n.gc(),n.hc(3,"vdr-dropdown-menu",22),n.hc(4,"button",23),n.pc("click",function(){n.Lc(c);const e=n.rc().item;return n.rc().cancelJob(e.id)}),n.sc(5,"hasPermission"),n.cc(6,"clr-icon",24),n.Vc(7),n.sc(8,"translate"),n.gc(),n.gc(),n.gc()}2&c&&(n.Qb(4),n.yc("disabled",!n.tc(5,2,n.Bc(6,U))),n.Qb(3),n.Xc(" ",n.tc(8,4,"common.cancel")," "))}function z(c,e){if(1&c&&(n.hc(0,"td",9),n.cc(1,"vdr-entity-info",10),n.gc(),n.hc(2,"td",9),n.Tc(3,G,7,4,"vdr-dropdown",11),n.hc(4,"vdr-chip",8),n.Vc(5),n.gc(),n.gc(),n.hc(6,"td",9),n.Vc(7),n.sc(8,"timeAgo"),n.gc(),n.hc(9,"td",9),n.cc(10,"vdr-job-state-label",12),n.gc(),n.hc(11,"td",9),n.Vc(12),n.sc(13,"duration"),n.gc(),n.hc(14,"td",9),n.Tc(15,$,8,4,"vdr-dropdown",11),n.Tc(16,A,8,4,"vdr-dropdown",11),n.gc(),n.hc(17,"td",13),n.Tc(18,_,9,7,"vdr-dropdown",11),n.gc()),2&c){const c=e.item,t=n.rc();n.Qb(1),n.yc("entity",c),n.Qb(2),n.yc("ngIf",c.data),n.Qb(1),n.yc("colorFrom",c.queueName),n.Qb(1),n.Wc(c.queueName),n.Qb(2),n.Wc(n.tc(8,10,c.createdAt)),n.Qb(3),n.yc("job",c),n.Qb(2),n.Wc(n.tc(13,12,c.duration)),n.Qb(3),n.yc("ngIf",t.hasResult(c)),n.Qb(1),n.yc("ngIf",c.error),n.Qb(2),n.yc("ngIf",!c.isSettled&&"FAILED"!==c.state)}}class Y extends s.n{constructor(c,e,t,n,r){super(n,r),this.dataService=c,this.modalService=e,this.notificationService=t,this.liveUpdate=new Q.f(!0),this.hideSettled=new Q.f(!0),this.queueFilter=new Q.f("all"),super.setQueryFn((...c)=>this.dataService.settings.getAllJobs(...c),c=>c.jobs,(c,e)=>{const t="all"===this.queueFilter.value?null:{queueName:{eq:this.queueFilter.value}},n=this.hideSettled.value;return{options:{skip:c,take:e,filter:Object.assign(Object.assign({},t),n?{isSettled:{eq:!1}}:{}),sort:{createdAt:s.L.DESC}}}})}ngOnInit(){super.ngOnInit(),Object(I.a)(5e3,2e3).pipe(Object(j.a)(this.destroy$),Object(w.a)(()=>this.liveUpdate.value)).subscribe(()=>{this.refresh()}),this.queues$=this.dataService.settings.getJobQueues().mapStream(c=>c.jobQueues).pipe(Object(C.a)(c=>[{name:"all",running:!0},...c]))}hasResult(c){const e=c.result;return null!=e&&("object"!=typeof e||Object.keys(e).length>0)}cancelJob(c){this.dataService.settings.cancelJob(c).subscribe(()=>this.refresh())}}Y.\u0275fac=function(c){return new(c||Y)(n.bc(s.s),n.bc(s.F),n.bc(s.G),n.bc(k.e),n.bc(k.a))},Y.\u0275cmp=n.Vb({type:Y,selectors:[["vdr-job-list"]],features:[n.Nb],decls:41,vars:45,consts:[["type","checkbox","clrCheckbox","","name","live-update",3,"formControl"],["type","checkbox","clrCheckbox","","name","hide-settled",3,"formControl","change"],["bindValue","name",3,"addTag","items","hideSelected","multiple","markFirst","clearable","searchable","formControl","change"],["ng-label-tmp","","ng-option-tmp",""],["locationId","job-list"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[4,"ngIf","ngIfElse"],["others",""],[3,"colorFrom"],[1,"left","align-middle"],[3,"entity"],[4,"ngIf"],[3,"job"],[1,"right","align-middle"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-icon",3,"title"],["shape","details"],[1,"result-detail"],[3,"value"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-sm","details-button"],["shape","exclamation-circle"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","ban",1,"is-danger"]],template:function(c,e){1&c&&(n.hc(0,"vdr-action-bar"),n.hc(1,"vdr-ab-left"),n.hc(2,"clr-checkbox-container"),n.hc(3,"clr-checkbox-wrapper"),n.cc(4,"input",0),n.hc(5,"label"),n.Vc(6),n.sc(7,"translate"),n.gc(),n.gc(),n.hc(8,"clr-checkbox-wrapper"),n.hc(9,"input",1),n.pc("change",function(){return e.refresh()}),n.gc(),n.hc(10,"label"),n.Vc(11),n.sc(12,"translate"),n.gc(),n.gc(),n.gc(),n.gc(),n.hc(13,"vdr-ab-right"),n.hc(14,"ng-select",2),n.pc("change",function(){return e.refresh()}),n.sc(15,"async"),n.Tc(16,R,3,2,"ng-template",3),n.gc(),n.cc(17,"vdr-action-bar-items",4),n.gc(),n.gc(),n.hc(18,"vdr-data-table",5),n.pc("pageChange",function(c){return e.setPageNumber(c)})("itemsPerPageChange",function(c){return e.setItemsPerPage(c)}),n.sc(19,"async"),n.sc(20,"async"),n.sc(21,"async"),n.sc(22,"async"),n.cc(23,"vdr-dt-column"),n.hc(24,"vdr-dt-column"),n.Vc(25),n.sc(26,"translate"),n.gc(),n.hc(27,"vdr-dt-column"),n.Vc(28),n.sc(29,"translate"),n.gc(),n.hc(30,"vdr-dt-column"),n.Vc(31),n.sc(32,"translate"),n.gc(),n.hc(33,"vdr-dt-column"),n.Vc(34),n.sc(35,"translate"),n.gc(),n.hc(36,"vdr-dt-column"),n.Vc(37),n.sc(38,"translate"),n.gc(),n.cc(39,"vdr-dt-column"),n.Tc(40,z,19,14,"ng-template"),n.gc()),2&c&&(n.Qb(4),n.yc("formControl",e.liveUpdate),n.Qb(2),n.Wc(n.tc(7,21,"common.live-update")),n.Qb(3),n.yc("formControl",e.hideSettled),n.Qb(2),n.Wc(n.tc(12,23,"system.hide-settled-jobs")),n.Qb(3),n.yc("addTag",!1)("items",n.tc(15,25,e.queues$))("hideSelected",!0)("multiple",!1)("markFirst",!1)("clearable",!1)("searchable",!1)("formControl",e.queueFilter),n.Qb(4),n.yc("items",n.tc(19,27,e.items$))("itemsPerPage",n.tc(20,29,e.itemsPerPage$))("totalItems",n.tc(21,31,e.totalItems$))("currentPage",n.tc(22,33,e.currentPage$)),n.Qb(7),n.Wc(n.tc(26,35,"system.job-queue-name")),n.Qb(3),n.Wc(n.tc(29,37,"common.created-at")),n.Qb(3),n.Wc(n.tc(32,39,"system.job-state")),n.Qb(3),n.Wc(n.tc(35,41,"system.job-duration")),n.Qb(3),n.Wc(n.tc(38,43,"system.job-result")))},directives:[r.a,r.b,i.j,i.k,V.a,Q.a,i.i,Q.p,Q.g,i.u,r.c,P.a,P.e,P.d,o.a,T.a,S.a,a.o,l.a,N.a,E,D.a,x.a,i.o,F.a,X.a,q.a],pipes:[d.d,a.b,B.a,L.a,M.a],styles:[".result-detail[_ngcontent-%COMP%]{margin:0 12px}"],changeDetection:0});var H=t("OxKu");const K=[{path:"jobs",component:Y,data:{breadcrumb:Object(H.a)("breadcrumb.job-queue")}},{path:"system-status",component:v,data:{breadcrumb:Object(H.a)("breadcrumb.system-status")}}];class Z{}Z.\u0275fac=function(c){return new(c||Z)},Z.\u0275mod=n.Zb({type:Z}),Z.\u0275inj=n.Yb({imports:[[s.J,k.i.forChild(K)]]})}}]);
//# sourceMappingURL=13-es2015.a6c3e3cd3781aa3b9ed1.js.map