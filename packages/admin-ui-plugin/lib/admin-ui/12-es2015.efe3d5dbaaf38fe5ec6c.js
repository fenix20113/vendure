(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{eOA6:function(e,t,c){"use strict";c.r(t),c.d(t,"AddCountryToZoneDialogComponent",function(){return D}),c.d(t,"AdminDetailComponent",function(){return ne}),c.d(t,"AdministratorListComponent",function(){return ge}),c.d(t,"ChannelDetailComponent",function(){return Ve}),c.d(t,"ChannelListComponent",function(){return ze}),c.d(t,"CountryDetailComponent",function(){return _e}),c.d(t,"CountryListComponent",function(){return it}),c.d(t,"GlobalSettingsComponent",function(){return ut}),c.d(t,"PaymentMethodDetailComponent",function(){return St}),c.d(t,"PaymentMethodListComponent",function(){return wt}),c.d(t,"PermissionGridComponent",function(){return E}),c.d(t,"ProfileComponent",function(){return At}),c.d(t,"RoleDetailComponent",function(){return Gt}),c.d(t,"RoleListComponent",function(){return ic}),c.d(t,"ShippingEligibilityTestResultComponent",function(){return uc}),c.d(t,"ShippingMethodDetailComponent",function(){return _c}),c.d(t,"ShippingMethodListComponent",function(){return en}),c.d(t,"ShippingMethodTestResultComponent",function(){return jc}),c.d(t,"TaxCategoryDetailComponent",function(){return sn}),c.d(t,"TaxCategoryListComponent",function(){return hn}),c.d(t,"TaxRateDetailComponent",function(){return Cn}),c.d(t,"TaxRateListComponent",function(){return Tn}),c.d(t,"TestAddressFormComponent",function(){return Qc}),c.d(t,"TestOrderBuilderComponent",function(){return Cc}),c.d(t,"ZoneDetailDialogComponent",function(){return Mn}),c.d(t,"ZoneListComponent",function(){return Hn}),c.d(t,"ZoneMemberControlsDirective",function(){return a}),c.d(t,"ZoneMemberListHeaderDirective",function(){return o}),c.d(t,"ZoneMemberListComponent",function(){return F}),c.d(t,"AdministratorResolver",function(){return Kn}),c.d(t,"ChannelResolver",function(){return Yn}),c.d(t,"CountryResolver",function(){return Jn}),c.d(t,"GlobalSettingsResolver",function(){return ei}),c.d(t,"PaymentMethodResolver",function(){return ti}),c.d(t,"ProfileResolver",function(){return ci}),c.d(t,"RoleResolver",function(){return ni}),c.d(t,"ShippingMethodResolver",function(){return ii}),c.d(t,"TaxCategoryResolver",function(){return si}),c.d(t,"TaxRateResolver",function(){return ri}),c.d(t,"SettingsModule",function(){return pi}),c.d(t,"settingsRoutes",function(){return ai}),c.d(t,"administratorBreadcrumb",function(){return oi}),c.d(t,"channelBreadcrumb",function(){return li}),c.d(t,"roleBreadcrumb",function(){return di}),c.d(t,"taxCategoryBreadcrumb",function(){return ui}),c.d(t,"taxRateBreadcrumb",function(){return mi}),c.d(t,"countryBreadcrumb",function(){return hi}),c.d(t,"shippingMethodBreadcrumb",function(){return bi}),c.d(t,"paymentMethodBreadcrumb",function(){return gi});var n=c("t9nd"),i=c("lJxs"),s=c("fXoL"),r=c("xUfP");class a{constructor(e){this.templateRef=e}}a.\u0275fac=function(e){return new(e||a)(s.bc(s.ab))},a.\u0275dir=s.Wb({type:a,selectors:[["","vdrZoneMemberControls",""]]});class o{constructor(e){this.templateRef=e}}o.\u0275fac=function(e){return new(e||o)(s.bc(s.ab))},o.\u0275dir=s.Wb({type:o,selectors:[["","vdrZoneMemberListHeader",""]]});var l=c("ofXK"),d=c("Bzlx"),u=c("3Pt+"),m=c("CotX"),h=c("r2d8"),b=c("8MG2"),g=c("sYmb"),p=c("V0to");function f(e,t){1&e&&s.dc(0)}function y(e,t){if(1&e&&(s.fc(0),s.Tc(1,f,1,0,"ng-container",4),s.ec()),2&e){const e=s.rc();s.Qb(1),s.yc("ngTemplateOutlet",e.headerTemplate.templateRef)}}function v(e,t){1&e&&s.dc(0)}const C=function(e){return{member:e}};function O(e,t){if(1&e&&(s.fc(0),s.Tc(1,v,1,0,"ng-container",7),s.ec()),2&e){const e=s.rc().item,t=s.rc();s.Qb(1),s.yc("ngTemplateOutlet",t.controlsTemplate.templateRef)("ngTemplateOutletContext",s.Cc(2,C,e))}}function Q(e,t){if(1&e&&(s.hc(0,"td",5),s.Vc(1),s.gc(),s.hc(2,"td",5),s.Vc(3),s.gc(),s.hc(4,"td",5),s.cc(5,"clr-icon"),s.gc(),s.hc(6,"td",6),s.Tc(7,O,2,4,"ng-container",1),s.gc()),2&e){const e=t.item,c=s.rc();s.Qb(1),s.Wc(e.code),s.Qb(2),s.Wc(e.name),s.Qb(2),s.Tb("is-success",e.enabled),s.Rb("shape",e.enabled?"check":"times"),s.Qb(2),s.yc("ngIf",c.controlsTemplate)}}const k=function(){return["UpdateSettings","UpdateZone"]};class F{constructor(){this.members=[],this.selectedMemberIds=[],this.selectionChange=new s.t,this.filterTerm="",this.isMemberSelected=e=>-1<this.selectedMemberIds.indexOf(e.id)}filteredMembers(){if(""!==this.filterTerm){const e=this.filterTerm.toLocaleLowerCase();return this.members.filter(t=>t.name.toLocaleLowerCase().includes(e)||t.code.toLocaleLowerCase().includes(e))}return this.members}areAllSelected(){return!!this.members&&this.selectedMemberIds.length===this.members.length}toggleSelectAll(){this.areAllSelected()?this.selectionChange.emit([]):this.selectionChange.emit(this.members.map(e=>e.id))}toggleSelectMember(e){this.selectedMemberIds.includes(e.id)?this.selectionChange.emit(this.selectedMemberIds.filter(t=>t!==e.id)):this.selectionChange.emit([...this.selectedMemberIds,e.id])}}F.\u0275fac=function(e){return new(e||F)},F.\u0275cmp=s.Vb({type:F,selectors:[["vdr-zone-member-list"]],contentQueries:function(e,t,c){if(1&e&&(s.Ub(c,o,1),s.Ub(c,a,1)),2&e){let e;s.Hc(e=s.qc())&&(t.headerTemplate=e.first),s.Hc(e=s.qc())&&(t.controlsTemplate=e.first)}},inputs:{members:"members",selectedMemberIds:"selectedMemberIds"},outputs:{selectionChange:"selectionChange"},decls:17,vars:20,consts:[[1,"members-header"],[4,"ngIf"],["type","text",3,"placeholder","ngModel","ngModelChange"],[3,"items","allSelected","isRowSelectedFn","rowSelectChange","allSelectChange"],[4,"ngTemplateOutlet"],[1,"left","align-middle"],[1,"right","align-middle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.Tc(1,y,2,1,"ng-container",1),s.hc(2,"input",2),s.pc("ngModelChange",function(e){return t.filterTerm=e}),s.sc(3,"translate"),s.gc(),s.gc(),s.hc(4,"vdr-data-table",3),s.pc("rowSelectChange",function(e){return t.toggleSelectMember(e)})("allSelectChange",function(){return t.toggleSelectAll()}),s.sc(5,"hasPermission"),s.hc(6,"vdr-dt-column"),s.Vc(7),s.sc(8,"translate"),s.gc(),s.hc(9,"vdr-dt-column"),s.Vc(10),s.sc(11,"translate"),s.gc(),s.hc(12,"vdr-dt-column"),s.Vc(13),s.sc(14,"translate"),s.gc(),s.cc(15,"vdr-dt-column"),s.Tc(16,Q,8,6,"ng-template"),s.gc()),2&e&&(s.Qb(1),s.yc("ngIf",t.headerTemplate),s.Qb(1),s.yc("placeholder",s.tc(3,9,"settings.filter-by-member-name"))("ngModel",t.filterTerm),s.Qb(2),s.yc("items",t.filteredMembers())("allSelected",t.areAllSelected())("isRowSelectedFn",s.tc(5,11,s.Bc(19,k))&&t.isMemberSelected),s.Qb(3),s.Wc(s.tc(8,13,"common.code")),s.Qb(3),s.Wc(s.tc(11,15,"common.name")),s.Qb(3),s.Wc(s.tc(14,17,"common.enabled")))},directives:[l.o,d.a,u.b,u.p,u.s,m.a,h.a,l.t,b.o],pipes:[g.d,p.a],styles:[".members-header[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);position:sticky;top:0;padding:6px;z-index:5;border-bottom:1px solid var(--color-component-border-200)}.members-header[_ngcontent-%COMP%]   .header-title-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.members-header[_ngcontent-%COMP%]   .clr-input[_ngcontent-%COMP%]{width:100%}"],changeDetection:0});var S=c("jHbs");const I=function(e){return{zoneName:e}};function T(e,t){if(1&e&&(s.Vc(0),s.sc(1,"translate")),2&e){const e=s.rc();s.Wc(s.uc(1,1,"settings.add-countries-to-zone",s.Cc(4,I,e.zoneName)))}}function P(e,t){if(1&e){const e=s.ic();s.hc(0,"button",3),s.pc("click",function(){s.Lc(e);return s.rc().cancel()}),s.Vc(1),s.sc(2,"translate"),s.gc(),s.hc(3,"button",4),s.pc("click",function(){s.Lc(e);return s.rc().add()}),s.Vc(4),s.sc(5,"translate"),s.gc()}if(2&e){const e=s.rc();s.Qb(1),s.Wc(s.tc(2,3,"common.cancel")),s.Qb(2),s.yc("disabled",!e.selectedMemberIds.length),s.Qb(1),s.Xc(" ",s.uc(5,5,"settings.add-countries-to-zone",s.Cc(8,I,e.zoneName))," ")}}class D{constructor(e){this.dataService=e,this.currentMembers=[],this.selectedMemberIds=[]}ngOnInit(){const e=this.currentMembers.map(e=>e.id);this.availableCountries$=this.dataService.settings.getCountries(999).mapStream(e=>e.countries.items).pipe(Object(i.a)(t=>t.filter(t=>!e.includes(t.id))))}cancel(){this.resolveWith()}add(){this.resolveWith(this.selectedMemberIds)}}D.\u0275fac=function(e){return new(e||D)(s.bc(n.s))},D.\u0275cmp=s.Vb({type:D,selectors:[["vdr-add-country-to-zone-dialog"]],decls:4,vars:4,consts:[["vdrDialogTitle",""],[3,"members","selectedMemberIds","selectionChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Tc(0,T,2,6,"ng-template",0),s.hc(1,"vdr-zone-member-list",1),s.pc("selectionChange",function(e){return t.selectedMemberIds=e}),s.sc(2,"async"),s.gc(),s.Tc(3,P,6,10,"ng-template",2)),2&e&&(s.Qb(1),s.yc("members",s.tc(2,2,t.availableCountries$))("selectedMemberIds",t.selectedMemberIds))},directives:[r.a,F,S.a],pipes:[l.b,g.d],styles:[""],changeDetection:0});var j=c("OxKu"),V=c("gQU7"),w=c("IzEk"),x=c("5+tZ"),L=c("tyNb"),M=c("uEVm"),$=c("iszU"),A=c("nqNv"),N=c("1XD6"),R=c("ZOsW"),z=c("gXNc");function W(e,t){if(1&e){const e=s.ic();s.hc(0,"button",4),s.pc("click",function(){s.Lc(e);const t=s.rc().$implicit;return s.rc().toggleAll(t.permissions)}),s.Vc(1),s.sc(2,"translate"),s.gc()}2&e&&(s.Qb(1),s.Xc(" ",s.tc(2,1,"common.toggle-all")," "))}function X(e,t){if(1&e){const e=s.ic();s.hc(0,"td"),s.hc(1,"vdr-select-toggle",5),s.pc("selectedChange",function(c){s.Lc(e);const n=t.$implicit;return s.rc(2).setPermission(n.name,c)}),s.gc(),s.gc()}if(2&e){const e=t.$implicit,c=s.rc().$implicit,n=s.rc();s.Rb("colspan",1===c.permissions.length?4:1),s.Qb(1),s.yc("title",e.description)("label",e.name)("disabled",n.readonly)("selected",null==n.activePermissions?null:n.activePermissions.includes(e.name))}}function G(e,t){if(1&e&&(s.hc(0,"tr"),s.hc(1,"td",2),s.hc(2,"div"),s.hc(3,"strong"),s.Vc(4),s.sc(5,"translate"),s.gc(),s.gc(),s.hc(6,"small"),s.Vc(7),s.sc(8,"translate"),s.gc(),s.cc(9,"br"),s.Tc(10,W,3,3,"button",3),s.gc(),s.Tc(11,X,2,5,"td",1),s.gc()),2&e){const e=t.$implicit,c=s.rc();s.Qb(4),s.Wc(s.tc(5,4,e.label)),s.Qb(3),s.Wc(s.tc(8,6,e.description)),s.Qb(3),s.yc("ngIf",1<e.permissions.length&&!c.readonly),s.Qb(1),s.yc("ngForOf",e.permissions)}}class E{constructor(){this.readonly=!1,this.permissionChange=new s.t}ngOnInit(){this.buildGrid()}setPermission(e,t){this.readonly||this.permissionChange.emit({permission:e,value:t})}toggleAll(e){const t=e.some(e=>!this.activePermissions.includes(e.name));for(const c of e)this.permissionChange.emit({permission:c.name,value:t})}buildGrid(){var e;const t=new Map,c=[],n=/^(Create|Read|Update|Delete)([a-zA-Z]+)$/;for(const i of this.permissionDefinitions){if(n.test(i.name)){const c=null===(e=i.name.match(n))||void 0===e?void 0:e[2];if(c){const e=t.get(c);e?e.push(i):t.set(c,[i])}}else i.assignable&&c.push(i)}this.gridData=[...c.map(e=>({label:e.name,description:e.description,permissions:[e]})),...Array.from(t.entries()).map(([e,t])=>({label:e,description:this.extractCrudDescription(t[0]),permissions:t}))]}extractCrudDescription(e){return e.description.replace(/Grants permission to [\w]+/,"Grants permissions on")}}E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=s.Vb({type:E,selectors:[["vdr-permission-grid"]],inputs:{permissionDefinitions:"permissionDefinitions",activePermissions:"activePermissions",readonly:"readonly"},outputs:{permissionChange:"permissionChange"},decls:3,vars:1,consts:[[1,"table"],[4,"ngFor","ngForOf"],[1,"permission-group","left"],["class","btn btn-sm btn-link",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-link",3,"click"],["size","small",3,"title","label","disabled","selected","selectedChange"]],template:function(e,t){1&e&&(s.hc(0,"table",0),s.hc(1,"tbody"),s.Tc(2,G,12,8,"tr",1),s.gc(),s.gc()),2&e&&(s.Qb(2),s.yc("ngForOf",t.gridData))},directives:[l.n,l.o,z.a],pipes:[g.d],styles:["td.permission-group[_ngcontent-%COMP%]{max-width:300px;background-color:var(--color-component-bg-200)}"],changeDetection:0});var U=c("W7hW"),_=c("Lbhx"),Z=c("a1B0");function B(e,t){if(1&e){const e=s.ic();s.hc(0,"button",19),s.pc("click",function(){s.Lc(e);return s.rc().create()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc();s.yc("disabled",e.detailForm.invalid||e.detailForm.pristine),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.create")," ")}}function q(e,t){if(1&e){const e=s.ic();s.hc(0,"button",19),s.pc("click",function(){s.Lc(e);return s.rc(2).save()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc(2);s.yc("disabled",e.detailForm.invalid||e.detailForm.pristine),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.update")," ")}}function H(e,t){1&e&&s.Tc(0,q,3,4,"button",20),2&e&&s.yc("vdrIfPermissions","UpdateAdministrator")}function K(e,t){1&e&&(s.hc(0,"vdr-form-field",21),s.sc(1,"translate"),s.cc(2,"input",22),s.gc()),2&e&&s.yc("label",s.tc(1,1,"settings.password"))}function Y(e,t){1&e&&(s.hc(0,"vdr-form-field",23),s.sc(1,"translate"),s.cc(2,"input",22),s.gc()),2&e&&s.yc("label",s.tc(1,2,"settings.password"))("readOnlyToggle",!0)}function J(e,t){if(1&e&&s.cc(0,"vdr-custom-field-control",27),2&e){const e=s.rc().$implicit,t=s.rc(2);s.yc("customFieldsFormGroup",t.detailForm.get("customFields"))("customField",e)}}function ee(e,t){if(1&e&&(s.fc(0),s.Tc(1,J,1,2,"vdr-custom-field-control",26),s.ec()),2&e){const e=t.$implicit,c=s.rc(2);s.Qb(1),s.yc("ngIf",c.customFieldIsSet(e.name))}}function te(e,t){if(1&e&&(s.hc(0,"section",24),s.hc(1,"label"),s.Vc(2),s.sc(3,"translate"),s.gc(),s.Tc(4,ee,2,1,"ng-container",25),s.gc()),2&e){const e=s.rc();s.Qb(2),s.Wc(s.tc(3,2,"common.custom-fields")),s.Qb(2),s.yc("ngForOf",e.customFields)}}function ce(e,t){if(1&e){const e=s.ic();s.hc(0,"li",28),s.hc(1,"button",29),s.pc("click",function(){s.Lc(e);const c=t.$implicit;return s.rc().selectedChannelId=c.channelId}),s.Vc(2),s.sc(3,"translate"),s.sc(4,"channelCodeToLabel"),s.gc(),s.gc()}if(2&e){const e=t.$implicit,c=s.rc();s.Qb(1),s.Tb("active",c.selectedChannelId===e.channelId),s.yc("id",e.channelId),s.Rb("aria-selected",c.selectedChannelId===e.channelId),s.Qb(1),s.Xc(" ",s.tc(3,5,s.tc(4,7,e.channelCode))," ")}}class ne extends n.l{constructor(e,t,c,n,i,s,r){super(t,e,c,i),this.changeDetector=n,this.dataService=i,this.formBuilder=s,this.notificationService=r,this.selectedRoles=[],this.selectedRolePermissions={},this.selectedChannelId=null,this.customFields=this.getCustomFieldConfig("Administrator"),this.detailForm=this.formBuilder.group({emailAddress:["",u.C.required],firstName:["",u.C.required],lastName:["",u.C.required],password:[""],roles:[[]],customFields:this.formBuilder.group(this.customFields.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:""}),{}))})}getAvailableChannels(){return Object.values(this.selectedRolePermissions)}ngOnInit(){this.init(),this.administrator$=this.entity$,this.allRoles$=this.dataService.administrator.getRoles(999).mapStream(e=>e.roles.items.filter(e=>e.code!==V.CUSTOMER_ROLE_CODE)),this.dataService.client.userStatus().single$.subscribe(({userStatus:e})=>{if(!e.permissions.includes(n.H.UpdateAdministrator)){const e=this.detailForm.get("roles");e&&e.disable()}}),this.permissionDefinitions=this.serverConfigService.getPermissionDefinitions()}ngOnDestroy(){this.destroy()}customFieldIsSet(e){return!!this.detailForm.get(["customFields",e])}rolesChanged(e){this.buildPermissionsMap()}getPermissionsForSelectedChannel(){function e(e){return Object.entries(e).filter(([e,t])=>t).map(([e,t])=>e)}if(this.selectedChannelId){if(this.selectedRolePermissions[this.selectedChannelId]){return e(this.selectedRolePermissions[this.selectedChannelId].permissions)}}const t=Object.values(this.selectedRolePermissions);return 0<t.length?(this.selectedChannelId=t[0].channelId,e(t[0].permissions)):[]}create(){const e=this.detailForm.value,t={emailAddress:e.emailAddress,firstName:e.firstName,lastName:e.lastName,password:e.password,customFields:e.customFields,roleIds:e.roles.map(e=>e.id)};this.dataService.administrator.createAdministrator(t).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-create-success"),{entity:"Administrator"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",e.createAdministrator.id],{relativeTo:this.route})},e=>{this.notificationService.error(Object(j.a)("common.notify-create-error"),{entity:"Administrator"})})}save(){this.administrator$.pipe(Object(w.a)(1),Object(x.a)(({id:e})=>{const t=this.detailForm.value,c={id:e,emailAddress:t.emailAddress,firstName:t.firstName,lastName:t.lastName,password:t.password,customFields:t.customFields,roleIds:t.roles.map(e=>e.id)};return this.dataService.administrator.updateAdministrator(c)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"Administrator"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},e=>{this.notificationService.error(Object(j.a)("common.notify-update-error"),{entity:"Administrator"})})}setFormValues(e,t){if(this.detailForm.patchValue({emailAddress:e.emailAddress,firstName:e.firstName,lastName:e.lastName,roles:e.user.roles}),this.customFields.length){const t=this.detailForm.get("customFields");for(const c of this.customFields){const n=c.name,i=e.customFields[n],s=t.get(n);s&&s.patchValue(i)}}const c=this.detailForm.get("password");c&&(e.id?c.setValidators([]):c.setValidators([u.C.required])),this.buildPermissionsMap()}buildPermissionsMap(){const e=this.detailForm.get("roles");if(e){const t=e.value,c=new Map,n=new Map;for(const e of t)for(const t of e.channels){const i=c.get(t.id)||new Set;e.permissions.forEach(e=>i.add(e)),c.set(t.id,i),n.set(t.id,t.code)}this.selectedRolePermissions={};for(const e of Array.from(c.keys())){const t=c.get(e),i={};for(const e of this.serverConfigService.getPermissionDefinitions())i[e.name]=t.has(e.name);this.selectedRolePermissions[e]={channelId:e,channelCode:n.get(e),permissions:i}}}}}ne.\u0275fac=function(e){return new(e||ne)(s.bc(L.e),s.bc(L.a),s.bc(n.I),s.bc(s.j),s.bc(n.s),s.bc(u.e),s.bc(n.G))},ne.\u0275cmp=s.Vb({type:ne,selectors:[["vdr-admin-detail"]],features:[s.Nb],decls:37,vars:47,consts:[[3,"entity"],["locationId","administrator-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","emailAddress",3,"label"],["id","emailAddress","type","text","formControlName","emailAddress",3,"readonly"],["for","firstName",3,"label"],["id","firstName","type","text","formControlName","firstName",3,"readonly"],["for","lastName",3,"label"],["id","lastName","type","text","formControlName","lastName",3,"readonly"],["for","password",3,"label",4,"ngIf"],["for","password",3,"label","readOnlyToggle",4,"ngIf"],["formGroupName","customFields",4,"ngIf"],[1,"clr-control-label"],["formControlName","roles","bindLabel","description",3,"items","multiple","hideSelected","change"],["role","tablist",1,"nav"],["role","presentation","class","nav-item",4,"ngFor","ngForOf"],[3,"activePermissions","permissionDefinitions","readonly"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],["for","password",3,"label"],["id","password","type","password","formControlName","password"],["for","password",3,"label","readOnlyToggle"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","Administrator",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","Administrator",3,"customFieldsFormGroup","customField"],["role","presentation",1,"nav-item"],["type","button",1,"btn","btn-link","nav-link",3,"id","click"]],template:function(e,t){if(1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.cc(2,"vdr-entity-info",0),s.sc(3,"async"),s.gc(),s.hc(4,"vdr-ab-right"),s.cc(5,"vdr-action-bar-items",1),s.Tc(6,B,3,4,"button",2),s.sc(7,"async"),s.Tc(8,H,1,1,"ng-template",null,3,s.Uc),s.gc(),s.gc(),s.hc(10,"form",4),s.hc(11,"vdr-form-field",5),s.sc(12,"translate"),s.cc(13,"input",6),s.sc(14,"hasPermission"),s.gc(),s.hc(15,"vdr-form-field",7),s.sc(16,"translate"),s.cc(17,"input",8),s.sc(18,"hasPermission"),s.gc(),s.hc(19,"vdr-form-field",9),s.sc(20,"translate"),s.cc(21,"input",10),s.sc(22,"hasPermission"),s.gc(),s.Tc(23,K,3,3,"vdr-form-field",11),s.sc(24,"async"),s.Tc(25,Y,3,4,"vdr-form-field",12),s.sc(26,"async"),s.sc(27,"hasPermission"),s.Tc(28,te,5,4,"section",13),s.hc(29,"label",14),s.Vc(30),s.sc(31,"translate"),s.gc(),s.hc(32,"ng-select",15),s.pc("change",function(e){return t.rolesChanged(e)}),s.sc(33,"async"),s.gc(),s.hc(34,"ul",16),s.Tc(35,ce,5,9,"li",17),s.gc(),s.cc(36,"vdr-permission-grid",18),s.gc()),2&e){const e=s.Ic(9);s.Qb(2),s.yc("entity",s.tc(3,21,t.entity$)),s.Qb(4),s.yc("ngIf",s.tc(7,23,t.isNew$))("ngIfElse",e),s.Qb(4),s.yc("formGroup",t.detailForm),s.Qb(1),s.yc("label",s.tc(12,25,"settings.email-address")),s.Qb(2),s.yc("readonly",!s.tc(14,27,"UpdateAdministrator")),s.Qb(2),s.yc("label",s.tc(16,29,"settings.first-name")),s.Qb(2),s.yc("readonly",!s.tc(18,31,"UpdateAdministrator")),s.Qb(2),s.yc("label",s.tc(20,33,"settings.last-name")),s.Qb(2),s.yc("readonly",!s.tc(22,35,"UpdateAdministrator")),s.Qb(2),s.yc("ngIf",s.tc(24,37,t.isNew$)),s.Qb(2),s.yc("ngIf",!s.tc(26,39,t.isNew$)&&s.tc(27,41,"UpdateAdministrator")),s.Qb(3),s.yc("ngIf",t.customFields.length),s.Qb(2),s.Wc(s.tc(31,43,"settings.roles")),s.Qb(2),s.yc("items",s.tc(33,45,t.allRoles$))("multiple",!0)("hideSelected",!0),s.Qb(3),s.yc("ngForOf",t.getAvailableChannels()),s.Qb(1),s.yc("activePermissions",t.getPermissionsForSelectedChannel())("permissionDefinitions",t.permissionDefinitions)("readonly",!0)}},directives:[M.a,M.b,$.a,M.c,A.a,l.o,u.E,u.q,u.j,N.a,d.a,u.b,u.p,u.h,b.u,R.a,l.n,E,U.a,u.k,_.a],pipes:[l.b,g.d,p.a,Z.a],styles:[""],changeDetection:0});var ie=c("EY2u"),se=c("eIep"),re=c("ef/U"),ae=c("zzDm"),oe=c("eBFp"),le=c("IKcI"),de=c("EFLa");const ue=function(){return["./create"]};function me(e,t){1&e&&(s.hc(0,"a",3),s.cc(1,"clr-icon",4),s.Vc(2),s.sc(3,"translate"),s.gc()),2&e&&(s.yc("routerLink",s.Bc(4,ue)),s.Qb(2),s.Xc(" ",s.tc(3,2,"admin.create-new-administrator")," "))}const he=function(e){return["./",e]};function be(e,t){if(1&e){const e=s.ic();s.hc(0,"td",5),s.Vc(1),s.gc(),s.hc(2,"td",5),s.Vc(3),s.gc(),s.hc(4,"td",5),s.Vc(5),s.gc(),s.hc(6,"td",6),s.cc(7,"vdr-table-row-action",7),s.sc(8,"translate"),s.gc(),s.hc(9,"td"),s.hc(10,"vdr-dropdown"),s.hc(11,"button",8),s.Vc(12),s.sc(13,"translate"),s.cc(14,"clr-icon",9),s.gc(),s.hc(15,"vdr-dropdown-menu",10),s.hc(16,"button",11),s.pc("click",function(){s.Lc(e);const c=t.item;return s.rc().deleteAdministrator(c)}),s.sc(17,"hasPermission"),s.cc(18,"clr-icon",12),s.Vc(19),s.sc(20,"translate"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.item;s.Qb(1),s.Wc(e.firstName),s.Qb(2),s.Wc(e.lastName),s.Qb(2),s.Wc(e.emailAddress),s.Qb(2),s.yc("label",s.tc(8,8,"common.edit"))("linkTo",s.Cc(16,he,e.id)),s.Qb(5),s.Xc(" ",s.tc(13,10,"common.actions")," "),s.Qb(4),s.yc("disabled",!s.tc(17,12,"DeleteAdministrator")),s.Qb(3),s.Xc(" ",s.tc(20,14,"common.delete")," ")}}class ge extends n.n{constructor(e,t,c,n,i){super(t,c),this.dataService=e,this.modalService=n,this.notificationService=i,super.setQueryFn((...e)=>this.dataService.administrator.getAdministrators(...e),e=>e.administrators)}deleteAdministrator(e){return this.modalService.dialog({title:Object(j.a)("catalog.confirm-delete-administrator"),body:`${e.firstName} ${e.lastName}`,buttons:[{type:"secondary",label:Object(j.a)("common.cancel")},{type:"danger",label:Object(j.a)("common.delete"),returnValue:!0}]}).pipe(Object(se.a)(t=>t?this.dataService.administrator.deleteAdministrator(e.id):ie.a)).subscribe(()=>{this.notificationService.success(Object(j.a)("common.notify-delete-success"),{entity:"Administrator"}),this.refresh()},e=>{this.notificationService.error(Object(j.a)("common.notify-delete-error"),{entity:"Administrator"})})}}ge.\u0275fac=function(e){return new(e||ge)(s.bc(n.s),s.bc(L.e),s.bc(L.a),s.bc(n.F),s.bc(n.G))},ge.\u0275cmp=s.Vb({type:ge,selectors:[["vdr-administrator-list"]],features:[s.Nb],decls:21,vars:22,consts:[["locationId","administrator-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-right"),s.cc(2,"vdr-action-bar-items",0),s.Tc(3,me,4,5,"a",1),s.gc(),s.gc(),s.hc(4,"vdr-data-table",2),s.pc("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),s.sc(5,"async"),s.sc(6,"async"),s.sc(7,"async"),s.sc(8,"async"),s.hc(9,"vdr-dt-column"),s.Vc(10),s.sc(11,"translate"),s.gc(),s.hc(12,"vdr-dt-column"),s.Vc(13),s.sc(14,"translate"),s.gc(),s.hc(15,"vdr-dt-column"),s.Vc(16),s.sc(17,"translate"),s.gc(),s.cc(18,"vdr-dt-column"),s.cc(19,"vdr-dt-column"),s.Tc(20,be,21,18,"ng-template"),s.gc()),2&e&&(s.Qb(3),s.yc("vdrIfPermissions","CreateAdministrator"),s.Qb(1),s.yc("items",s.tc(5,8,t.items$))("itemsPerPage",s.tc(6,10,t.itemsPerPage$))("totalItems",s.tc(7,12,t.totalItems$))("currentPage",s.tc(8,14,t.currentPage$)),s.Qb(6),s.Wc(s.tc(11,16,"settings.first-name")),s.Qb(3),s.Wc(s.tc(14,18,"settings.last-name")),s.Qb(3),s.Wc(s.tc(17,20,"settings.email-address")))},directives:[M.a,M.c,A.a,U.a,m.a,h.a,L.h,b.o,re.a,ae.a,oe.a,le.a,de.a],pipes:[l.b,g.d,p.a],styles:[""]});var pe=c("Fh+9"),fe=c("YxnJ");function ye(e,t){if(1&e){const e=s.ic();s.hc(0,"button",22),s.pc("click",function(){s.Lc(e);return s.rc().create()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc();s.yc("disabled",!e.saveButtonEnabled()),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.create")," ")}}function ve(e,t){if(1&e){const e=s.ic();s.hc(0,"button",22),s.pc("click",function(){s.Lc(e);return s.rc(2).save()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc(2);s.yc("disabled",!e.saveButtonEnabled()),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.update")," ")}}const Ce=function(){return["SuperAdmin","UpdateChannel"]};function Oe(e,t){1&e&&s.Tc(0,ve,3,4,"button",23),2&e&&s.yc("vdrIfPermissions",s.Bc(1,Ce))}function Qe(e,t){if(1&e&&(s.hc(0,"option",24),s.Vc(1),s.sc(2,"localeCurrencyName"),s.gc()),2&e){const e=t.$implicit;s.yc("value",e),s.Qb(1),s.Wc(s.tc(2,2,e))}}function ke(e,t){if(1&e&&(s.hc(0,"option",24),s.Vc(1),s.sc(2,"translate"),s.sc(3,"uppercase"),s.gc()),2&e){const e=t.$implicit;s.yc("value",e),s.Qb(1),s.Yc(" ",s.tc(2,3,"lang."+e)," (",s.tc(3,5,e),") ")}}function Fe(e,t){if(1&e&&(s.hc(0,"option",24),s.Vc(1),s.gc()),2&e){const e=t.$implicit;s.yc("value",e.id),s.Qb(1),s.Wc(e.name)}}function Se(e,t){1&e&&(s.hc(0,"clr-alert",25),s.hc(1,"clr-alert-item"),s.hc(2,"span",26),s.Vc(3),s.sc(4,"translate"),s.gc(),s.gc(),s.gc()),2&e&&(s.yc("clrAlertClosable",!1),s.Qb(3),s.Xc(" ",s.tc(4,2,"error.no-default-tax-zone-set")," "))}function Ie(e,t){if(1&e&&(s.hc(0,"option",24),s.Vc(1),s.gc()),2&e){const e=t.$implicit;s.yc("value",e.id),s.Qb(1),s.Wc(e.name)}}function Te(e,t){1&e&&(s.hc(0,"clr-alert",27),s.hc(1,"clr-alert-item"),s.hc(2,"span",26),s.Vc(3),s.sc(4,"translate"),s.gc(),s.gc(),s.gc()),2&e&&(s.yc("clrAlertClosable",!1),s.Qb(3),s.Xc(" ",s.tc(4,2,"error.no-default-shipping-zone-set")," "))}function Pe(e,t){if(1&e&&s.cc(0,"vdr-custom-field-control",31),2&e){const e=s.rc().$implicit,t=s.rc(2);s.yc("customFieldsFormGroup",t.detailForm.get("customFields"))("customField",e)}}function De(e,t){if(1&e&&(s.fc(0),s.Tc(1,Pe,1,2,"vdr-custom-field-control",30),s.ec()),2&e){const e=t.$implicit,c=s.rc(2);s.Qb(1),s.yc("ngIf",c.customFieldIsSet(e.name))}}function je(e,t){if(1&e&&(s.hc(0,"section",28),s.hc(1,"label"),s.Vc(2),s.sc(3,"translate"),s.gc(),s.Tc(4,De,2,1,"ng-container",29),s.gc()),2&e){const e=s.rc();s.Qb(2),s.Wc(s.tc(3,2,"common.custom-fields")),s.Qb(2),s.yc("ngForOf",e.customFields)}}class Ve extends n.l{constructor(e,t,c,i,s,r,a){super(t,e,c,s),this.serverConfigService=c,this.changeDetector=i,this.dataService=s,this.formBuilder=r,this.notificationService=a,this.currencyCodes=Object.values(n.q),this.updatePermission=[n.H.SuperAdmin,n.H.UpdateChannel,n.H.CreateChannel],this.customFields=this.getCustomFieldConfig("Channel"),this.detailForm=this.formBuilder.group({code:["",u.C.required],token:["",u.C.required],pricesIncludeTax:[!1],currencyCode:[""],defaultShippingZoneId:["",u.C.required],defaultLanguageCode:[],defaultTaxZoneId:["",u.C.required],customFields:this.formBuilder.group(this.customFields.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:""}),{}))})}ngOnInit(){this.init(),this.zones$=this.dataService.settings.getZones().mapSingle(e=>e.zones),this.availableLanguageCodes$=this.serverConfigService.getAvailableLanguages()}ngOnDestroy(){this.destroy()}customFieldIsSet(e){return!!this.detailForm.get(["customFields",e])}saveButtonEnabled(){return this.detailForm.dirty&&this.detailForm.valid}create(){if(!this.detailForm.dirty)return;const e=this.detailForm.value,t={code:e.code,token:e.token,defaultLanguageCode:e.defaultLanguageCode,pricesIncludeTax:e.pricesIncludeTax,currencyCode:e.currencyCode,defaultShippingZoneId:e.defaultShippingZoneId,defaultTaxZoneId:e.defaultTaxZoneId,customFields:e.customFields};this.dataService.settings.createChannel(t).pipe(Object(x.a)(({createChannel:e})=>this.dataService.auth.currentUser().single$.pipe(Object(i.a)(({me:t})=>({me:t,createChannel:e})))),Object(x.a)(({me:e,createChannel:t})=>this.dataService.client.updateUserChannels(e.channels).pipe(Object(i.a)(()=>t)))).subscribe(e=>{switch(e.__typename){case"Channel":this.notificationService.success(Object(j.a)("common.notify-create-success"),{entity:"Channel"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",e.id],{relativeTo:this.route});break;case"LanguageNotAvailableError":this.notificationService.error(e.message)}})}save(){if(!this.detailForm.dirty)return;const e=this.detailForm.value;this.entity$.pipe(Object(w.a)(1),Object(x.a)(t=>{const c={id:t.id,code:e.code,pricesIncludeTax:e.pricesIncludeTax,currencyCode:e.currencyCode,defaultShippingZoneId:e.defaultShippingZoneId,defaultLanguageCode:e.defaultLanguageCode,defaultTaxZoneId:e.defaultTaxZoneId,customFields:e.customFields};return this.dataService.settings.updateChannel(c)})).subscribe(({updateChannel:e})=>{switch(e.__typename){case"Channel":this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"Channel"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck();break;case"LanguageNotAvailableError":this.notificationService.error(e.message)}})}setFormValues(e,t){if(this.detailForm.patchValue({code:e.code,token:e.token||this.generateToken(),pricesIncludeTax:e.pricesIncludeTax,currencyCode:e.currencyCode,defaultShippingZoneId:e.defaultShippingZone?e.defaultShippingZone.id:"",defaultLanguageCode:e.defaultLanguageCode,defaultTaxZoneId:e.defaultTaxZone?e.defaultTaxZone.id:""}),this.customFields.length){const t=this.detailForm.get("customFields");for(const c of this.customFields){const n=c.name,i=e.customFields[n],s=t.get(n);s&&s.patchValue(i)}}if(e.code===V.DEFAULT_CHANNEL_CODE){const e=this.detailForm.get("code");e&&e.disable()}}generateToken(){const e=()=>Math.random().toString(36).substr(3,10);return`${e()}${e()}`}}Ve.\u0275fac=function(e){return new(e||Ve)(s.bc(L.e),s.bc(L.a),s.bc(n.I),s.bc(s.j),s.bc(n.s),s.bc(u.e),s.bc(n.G))},Ve.\u0275cmp=s.Vb({type:Ve,selectors:[["vdr-channel-detail"]],features:[s.Nb],decls:50,vars:63,consts:[[3,"entity"],["locationId","channel-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","code",3,"label"],["id","code","type","text","formControlName","code",3,"readonly"],["for","token",3,"label"],["id","token","type","text","formControlName","token",3,"readonly"],["for","defaultTaxZoneId",3,"label"],["clrSelect","","name","currencyCode","formControlName","currencyCode",3,"vdrDisabled"],[3,"value",4,"ngFor","ngForOf"],["for","defaultLanguage",3,"label"],["clrSelect","","name","defaultLanguageCode","formControlName","defaultLanguageCode",3,"vdrDisabled"],["for","pricesIncludeTax",3,"label"],["type","checkbox","clrToggle","","id","pricesIncludeTax","formControlName","pricesIncludeTax",3,"vdrDisabled"],["clrSelect","","name","defaultTaxZoneId","formControlName","defaultTaxZoneId",3,"vdrDisabled"],["clrAlertType","danger",3,"clrAlertClosable",4,"ngIf"],["for","defaultShippingZoneId",3,"label"],["clrSelect","","name","defaultShippingZoneId","formControlName","defaultShippingZoneId",3,"vdrDisabled"],["clrAlertType","warning",3,"clrAlertClosable",4,"ngIf"],["formGroupName","customFields",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"value"],["clrAlertType","danger",3,"clrAlertClosable"],[1,"alert-text"],["clrAlertType","warning",3,"clrAlertClosable"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","Channel",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","Channel",3,"customFieldsFormGroup","customField"]],template:function(e,t){if(1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.cc(2,"vdr-entity-info",0),s.sc(3,"async"),s.gc(),s.hc(4,"vdr-ab-right"),s.cc(5,"vdr-action-bar-items",1),s.Tc(6,ye,3,4,"button",2),s.sc(7,"async"),s.Tc(8,Oe,1,2,"ng-template",null,3,s.Uc),s.gc(),s.gc(),s.hc(10,"form",4),s.hc(11,"vdr-form-field",5),s.sc(12,"translate"),s.cc(13,"input",6),s.sc(14,"hasPermission"),s.gc(),s.hc(15,"vdr-form-field",7),s.sc(16,"translate"),s.cc(17,"input",8),s.sc(18,"hasPermission"),s.gc(),s.hc(19,"vdr-form-field",9),s.sc(20,"translate"),s.hc(21,"select",10),s.sc(22,"hasPermission"),s.Tc(23,Qe,3,4,"option",11),s.gc(),s.gc(),s.hc(24,"vdr-form-field",12),s.sc(25,"translate"),s.hc(26,"select",13),s.sc(27,"hasPermission"),s.Tc(28,ke,4,7,"option",11),s.sc(29,"async"),s.gc(),s.gc(),s.hc(30,"vdr-form-field",14),s.sc(31,"translate"),s.hc(32,"clr-toggle-wrapper"),s.cc(33,"input",15),s.sc(34,"hasPermission"),s.gc(),s.gc(),s.hc(35,"vdr-form-field",9),s.sc(36,"translate"),s.hc(37,"select",16),s.sc(38,"hasPermission"),s.Tc(39,Fe,2,2,"option",11),s.sc(40,"async"),s.gc(),s.gc(),s.Tc(41,Se,5,4,"clr-alert",17),s.hc(42,"vdr-form-field",18),s.sc(43,"translate"),s.hc(44,"select",19),s.sc(45,"hasPermission"),s.Tc(46,Ie,2,2,"option",11),s.sc(47,"async"),s.gc(),s.gc(),s.Tc(48,Te,5,4,"clr-alert",20),s.Tc(49,je,5,4,"section",21),s.gc()),2&e){const e=s.Ic(9);s.Qb(2),s.yc("entity",s.tc(3,25,t.entity$)),s.Qb(4),s.yc("ngIf",s.tc(7,27,t.isNew$))("ngIfElse",e),s.Qb(4),s.yc("formGroup",t.detailForm),s.Qb(1),s.yc("label",s.tc(12,29,"common.code")),s.Qb(2),s.yc("readonly",!s.tc(14,31,t.updatePermission)),s.Qb(2),s.yc("label",s.tc(16,33,"settings.channel-token")),s.Qb(2),s.yc("readonly",!s.tc(18,35,t.updatePermission)),s.Qb(2),s.yc("label",s.tc(20,37,"settings.currency")),s.Qb(2),s.yc("vdrDisabled",!s.tc(22,39,t.updatePermission)),s.Qb(2),s.yc("ngForOf",t.currencyCodes),s.Qb(1),s.yc("label",s.tc(25,41,"common.default-language")),s.Qb(2),s.yc("vdrDisabled",!s.tc(27,43,t.updatePermission)),s.Qb(2),s.yc("ngForOf",s.tc(29,45,t.availableLanguageCodes$)),s.Qb(2),s.yc("label",s.tc(31,47,"settings.prices-include-tax")),s.Qb(3),s.yc("vdrDisabled",!s.tc(34,49,t.updatePermission)),s.Qb(2),s.yc("label",s.tc(36,51,"settings.default-tax-zone")),s.Qb(2),s.yc("vdrDisabled",!s.tc(38,53,t.updatePermission)),s.Qb(2),s.yc("ngForOf",s.tc(40,55,t.zones$)),s.Qb(2),s.yc("ngIf",t.detailForm.value.code&&!t.detailForm.value.defaultTaxZoneId),s.Qb(1),s.yc("label",s.tc(43,57,"settings.default-shipping-zone")),s.Qb(2),s.yc("vdrDisabled",!s.tc(45,59,t.updatePermission)),s.Qb(2),s.yc("ngForOf",s.tc(47,61,t.zones$)),s.Qb(2),s.yc("ngIf",t.detailForm.value.code&&!t.detailForm.value.defaultShippingZoneId),s.Qb(1),s.yc("ngIf",t.customFields.length)}},directives:[M.a,M.b,$.a,M.c,A.a,l.o,u.E,u.q,u.j,N.a,d.a,u.b,u.p,u.h,u.A,b.A,pe.a,l.n,b.k,u.a,b.i,U.a,u.u,u.D,b.f,b.g,b.h,u.k,b.u,_.a],pipes:[l.b,g.d,p.a,fe.a,l.A],styles:["clr-alert[_ngcontent-%COMP%]{max-width:30rem;margin-bottom:12px}"],changeDetection:0});var we=c("XNiG"),xe=c("JX91"),Le=c("gUbN");const Me=function(){return["./create"]};function $e(e,t){1&e&&(s.hc(0,"a",3),s.cc(1,"clr-icon",4),s.Vc(2),s.sc(3,"translate"),s.gc()),2&e&&(s.yc("routerLink",s.Bc(4,Me)),s.Qb(2),s.Xc(" ",s.tc(3,2,"settings.create-new-channel")," "))}const Ae=function(e){return["./",e]},Ne=function(){return["SuperAdmin","DeleteChannel"]};function Re(e,t){if(1&e){const e=s.ic();s.hc(0,"td",5),s.cc(1,"vdr-channel-badge",6),s.Vc(2),s.sc(3,"translate"),s.sc(4,"channelCodeToLabel"),s.gc(),s.hc(5,"td",7),s.cc(6,"vdr-table-row-action",8),s.sc(7,"translate"),s.gc(),s.hc(8,"td",7),s.hc(9,"vdr-dropdown"),s.hc(10,"button",9),s.Vc(11),s.sc(12,"translate"),s.cc(13,"clr-icon",10),s.gc(),s.hc(14,"vdr-dropdown-menu",11),s.hc(15,"button",12),s.pc("click",function(){s.Lc(e);const c=t.item;return s.rc().deleteChannel(c.id)}),s.sc(16,"hasPermission"),s.cc(17,"clr-icon",13),s.Vc(18),s.sc(19,"translate"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.item,c=s.rc();s.Qb(1),s.yc("channelCode",e.code),s.Qb(1),s.Xc(" ",s.tc(3,8,s.tc(4,10,e.code))," "),s.Qb(4),s.yc("label",s.tc(7,12,"common.edit"))("linkTo",s.Cc(20,Ae,e.id)),s.Qb(4),s.yc("disabled",c.isDefaultChannel(e.code)),s.Qb(1),s.Xc(" ",s.tc(12,14,"common.actions")," "),s.Qb(4),s.yc("disabled",!s.tc(16,16,s.Bc(22,Ne))),s.Qb(3),s.Xc(" ",s.tc(19,18,"common.delete")," ")}}class ze{constructor(e,t,c){this.dataService=e,this.modalService=t,this.notificationService=c,this.refresh$=new we.a,this.channels$=this.refresh$.pipe(Object(xe.a)(1),Object(se.a)(()=>this.dataService.settings.getChannels().mapStream(e=>e.channels)))}isDefaultChannel(e){return e===V.DEFAULT_CHANNEL_CODE}deleteChannel(e){this.modalService.dialog({title:Object(j.a)("catalog.confirm-delete-channel"),buttons:[{type:"secondary",label:Object(j.a)("common.cancel")},{type:"danger",label:Object(j.a)("common.delete"),returnValue:!0}]}).pipe(Object(se.a)(t=>t?this.dataService.settings.deleteChannel(e):ie.a),Object(x.a)(()=>this.dataService.auth.currentUser().single$),Object(x.a)(e=>this.dataService.client.updateUserChannels(e.me.channels))).subscribe(()=>{this.notificationService.success(Object(j.a)("common.notify-delete-success"),{entity:"Channel"}),this.refresh$.next(1)},e=>{this.notificationService.error(Object(j.a)("common.notify-delete-error"),{entity:"Channel"})})}}ze.\u0275fac=function(e){return new(e||ze)(s.bc(n.s),s.bc(n.F),s.bc(n.G))},ze.\u0275cmp=s.Vb({type:ze,selectors:[["vdr-channel-list"]],decls:12,vars:7,consts:[["locationId","channel-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[3,"channelCode"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm",3,"disabled"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-right"),s.cc(2,"vdr-action-bar-items",0),s.Tc(3,$e,4,5,"a",1),s.gc(),s.gc(),s.hc(4,"vdr-data-table",2),s.sc(5,"async"),s.hc(6,"vdr-dt-column"),s.Vc(7),s.sc(8,"translate"),s.gc(),s.cc(9,"vdr-dt-column"),s.cc(10,"vdr-dt-column"),s.Tc(11,Re,20,23,"ng-template"),s.gc()),2&e&&(s.Qb(3),s.yc("vdrIfPermissions","SuperAdmin"),s.Qb(1),s.yc("items",s.tc(5,3,t.channels$)),s.Qb(3),s.Wc(s.tc(8,5,"common.code")))},directives:[M.a,M.c,A.a,U.a,m.a,h.a,L.h,b.o,Le.a,re.a,ae.a,oe.a,le.a,de.a],pipes:[l.b,g.d,Z.a,p.a],styles:[""],changeDetection:0});var We=c("itXk"),Xe=c("40ut");function Ge(e,t){if(1&e){const e=s.ic();s.hc(0,"button",12),s.pc("click",function(){s.Lc(e);return s.rc().create()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc();s.yc("disabled",e.detailForm.invalid||e.detailForm.pristine),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.create")," ")}}function Ee(e,t){if(1&e){const e=s.ic();s.hc(0,"button",12),s.pc("click",function(){s.Lc(e);return s.rc(2).save()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc(2);s.yc("disabled",e.detailForm.invalid||e.detailForm.pristine),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.update")," ")}}function Ue(e,t){if(1&e&&s.Tc(0,Ee,3,4,"button",13),2&e){const e=s.rc();s.yc("vdrIfPermissions",e.updatePermission)}}class _e extends n.l{constructor(e,t,c,i,s,r,a){super(t,e,c,s),this.changeDetector=i,this.dataService=s,this.formBuilder=r,this.notificationService=a,this.updatePermission=[n.H.UpdateSettings,n.H.UpdateCountry],this.detailForm=this.formBuilder.group({code:["",u.C.required],name:["",u.C.required],enabled:[!0]})}ngOnInit(){this.init(),this.country$=this.entity$}ngOnDestroy(){this.destroy()}create(){this.detailForm.dirty&&Object(We.a)(this.country$,this.languageCode$).pipe(Object(w.a)(1),Object(x.a)(([e,t])=>{const c=this.detailForm.value,i=Object(n.P)({translatable:e,updatedFields:c,languageCode:t,defaultTranslation:{name:c.name,languageCode:t}});return this.dataService.settings.createCountry(i)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-create-success"),{entity:"Country"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",e.createCountry.id],{relativeTo:this.route})},e=>{this.notificationService.error(Object(j.a)("common.notify-create-error"),{entity:"Country"})})}save(){Object(We.a)(this.country$,this.languageCode$).pipe(Object(w.a)(1),Object(x.a)(([e,t])=>{const c=this.detailForm.value,i=Object(n.P)({translatable:e,updatedFields:c,languageCode:t,defaultTranslation:{name:c.name,languageCode:t}});return this.dataService.settings.updateCountry(i)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"Country"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},e=>{this.notificationService.error(Object(j.a)("common.notify-update-error"),{entity:"Country"})})}setFormValues(e,t){const c=Object(n.S)(e,t);this.detailForm.patchValue({code:e.code,name:c?c.name:"",enabled:e.enabled})}}_e.\u0275fac=function(e){return new(e||_e)(s.bc(L.e),s.bc(L.a),s.bc(n.I),s.bc(s.j),s.bc(n.s),s.bc(u.e),s.bc(n.G))},_e.\u0275cmp=s.Vb({type:_e,selectors:[["vdr-country-detail"]],features:[s.Nb],decls:28,vars:35,consts:[[3,"entity"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","country-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","code",3,"label"],["id","code","type","text","formControlName","code",3,"readonly"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["for","enabled",3,"label"],["type","checkbox","clrToggle","","id","enabled","formControlName","enabled",3,"vdrDisabled"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"]],template:function(e,t){if(1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.cc(2,"vdr-entity-info",0),s.sc(3,"async"),s.hc(4,"vdr-language-selector",1),s.pc("languageCodeChange",function(e){return t.setLanguage(e)}),s.sc(5,"async"),s.sc(6,"async"),s.sc(7,"async"),s.gc(),s.gc(),s.hc(8,"vdr-ab-right"),s.cc(9,"vdr-action-bar-items",2),s.Tc(10,Ge,3,4,"button",3),s.sc(11,"async"),s.Tc(12,Ue,1,1,"ng-template",null,4,s.Uc),s.gc(),s.gc(),s.hc(14,"form",5),s.hc(15,"vdr-form-field",6),s.sc(16,"translate"),s.cc(17,"input",7),s.sc(18,"hasPermission"),s.gc(),s.hc(19,"vdr-form-field",8),s.sc(20,"translate"),s.cc(21,"input",9),s.sc(22,"hasPermission"),s.gc(),s.hc(23,"vdr-form-field",10),s.sc(24,"translate"),s.hc(25,"clr-toggle-wrapper"),s.cc(26,"input",11),s.sc(27,"hasPermission"),s.gc(),s.gc(),s.gc()),2&e){const e=s.Ic(13);s.Qb(2),s.yc("entity",s.tc(3,13,t.entity$)),s.Qb(2),s.yc("disabled",s.tc(5,15,t.isNew$))("availableLanguageCodes",s.tc(6,17,t.availableLanguages$))("currentLanguageCode",s.tc(7,19,t.languageCode$)),s.Qb(6),s.yc("ngIf",s.tc(11,21,t.isNew$))("ngIfElse",e),s.Qb(4),s.yc("formGroup",t.detailForm),s.Qb(1),s.yc("label",s.tc(16,23,"common.code")),s.Qb(2),s.yc("readonly",!s.tc(18,25,t.updatePermission)),s.Qb(2),s.yc("label",s.tc(20,27,"common.name")),s.Qb(2),s.yc("readonly",!s.tc(22,29,t.updatePermission)),s.Qb(2),s.yc("label",s.tc(24,31,"common.enabled")),s.Qb(3),s.yc("vdrDisabled",!s.tc(27,33,t.updatePermission))}},directives:[M.a,M.b,$.a,Xe.a,M.c,A.a,l.o,u.E,u.q,u.j,N.a,d.a,u.b,u.p,u.h,b.k,u.a,b.i,pe.a,U.a],pipes:[l.b,g.d,p.a],styles:[""]});var Ze=c("vkgz"),Be=c("2/wi");const qe=function(){return["./create"]};function He(e,t){1&e&&(s.hc(0,"a",5),s.cc(1,"clr-icon",6),s.Vc(2),s.sc(3,"translate"),s.gc()),2&e&&(s.yc("routerLink",s.Bc(4,qe)),s.Qb(2),s.Xc(" ",s.tc(3,2,"settings.create-new-country")," "))}const Ke=function(e){return{contents:e}},Ye=function(e){return["/settings","zones",e]};function Je(e,t){if(1&e&&(s.hc(0,"a",16),s.hc(1,"vdr-chip",17),s.Vc(2),s.gc(),s.gc()),2&e){const e=t.$implicit;s.yc("routerLink",s.Cc(5,Ye,s.Cc(3,Ke,e.id))),s.Qb(1),s.yc("colorFrom",e.name),s.Qb(1),s.Wc(e.name)}}const et=function(e){return["./",e]},tt=function(){return["DeleteSettings","DeleteCountry"]};function ct(e,t){if(1&e){const e=s.ic();s.hc(0,"td",7),s.Vc(1),s.gc(),s.hc(2,"td",7),s.Vc(3),s.gc(),s.hc(4,"td",7),s.Tc(5,Je,3,7,"a",8),s.gc(),s.hc(6,"td",7),s.cc(7,"clr-icon"),s.gc(),s.hc(8,"td",9),s.cc(9,"vdr-table-row-action",10),s.sc(10,"translate"),s.gc(),s.hc(11,"td",9),s.hc(12,"vdr-dropdown"),s.hc(13,"button",11),s.Vc(14),s.sc(15,"translate"),s.cc(16,"clr-icon",12),s.gc(),s.hc(17,"vdr-dropdown-menu",13),s.hc(18,"button",14),s.pc("click",function(){s.Lc(e);const c=t.item;return s.rc().deleteCountry(c.id)}),s.sc(19,"hasPermission"),s.cc(20,"clr-icon",15),s.Vc(21),s.sc(22,"translate"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.item;s.Qb(1),s.Wc(e.code),s.Qb(2),s.Wc(e.name),s.Qb(2),s.yc("ngForOf",e.zones),s.Qb(2),s.Tb("is-success",e.enabled),s.Rb("shape",e.enabled?"check":"times"),s.Qb(2),s.yc("label",s.tc(10,11,"common.edit"))("linkTo",s.Cc(19,et,e.id)),s.Qb(5),s.Xc(" ",s.tc(15,13,"common.actions")," "),s.Qb(4),s.yc("disabled",!s.tc(19,15,s.Bc(21,tt))),s.Qb(3),s.Xc(" ",s.tc(22,17,"common.delete")," ")}}const nt=function(){return["CreateSettings","CreateCountry"]};class it{constructor(e,t,c){this.dataService=e,this.notificationService=t,this.modalService=c,this.searchTerm=new u.f(""),this.countries=[],this.destroy$=new we.a}ngOnInit(){const e=this.searchTerm.valueChanges.pipe(Object(xe.a)(null),Object(se.a)(e=>this.dataService.settings.getCountries(999,0,e).stream$),Object(Ze.a)(e=>this.countries=e.countries.items),Object(i.a)(e=>e.countries.items));this.zones$=this.dataService.settings.getZones().mapStream(e=>e.zones),this.countriesWithZones$=Object(We.a)(e,this.zones$).pipe(Object(i.a)(([e,t])=>e.map(e=>Object.assign(Object.assign({},e),{zones:t.filter(t=>!!t.members.find(t=>t.id===e.id))}))))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}deleteCountry(e){this.modalService.dialog({title:Object(j.a)("catalog.confirm-delete-country"),buttons:[{type:"secondary",label:Object(j.a)("common.cancel")},{type:"danger",label:Object(j.a)("common.delete"),returnValue:!0}]}).pipe(Object(se.a)(t=>t?this.dataService.settings.deleteCountry(e):ie.a)).subscribe(e=>{e.deleteCountry.result===n.t.DELETED?(this.notificationService.success(Object(j.a)("common.notify-delete-success"),{entity:"Country"}),this.dataService.settings.getCountries(999,0).single$.subscribe()):this.notificationService.error(e.deleteCountry.message||"")},e=>{this.notificationService.error(Object(j.a)("common.notify-delete-error"),{entity:"Country"})})}isZone(e){return e.hasOwnProperty("id")}}function st(e,t){if(1&e){const e=s.ic();s.hc(0,"button",12),s.pc("click",function(){s.Lc(e);return s.rc().save()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc();s.yc("disabled",e.detailForm.invalid||e.detailForm.pristine),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.update")," ")}}function rt(e,t){if(1&e&&(s.hc(0,"span",13),s.pc("click",function(){const e=t.item;return t.clear.call(null,e)}),s.Vc(1," \xd7 "),s.gc(),s.hc(2,"span",14),s.Vc(3),s.sc(4,"translate"),s.gc()),2&e){const e=t.item;s.Qb(3),s.Yc("",s.tc(4,2,"lang."+e)," (",e,")")}}function at(e,t){if(1&e&&(s.Vc(0),s.sc(1,"translate")),2&e){const e=t.item;s.Yc(" ",s.tc(1,2,"lang."+e)," (",e,") ")}}function ot(e,t){if(1&e&&s.cc(0,"vdr-custom-field-control",18),2&e){const e=s.rc().$implicit,t=s.rc(2);s.yc("customFieldsFormGroup",t.detailForm.get("customFields"))("customField",e)}}function lt(e,t){if(1&e&&(s.fc(0),s.Tc(1,ot,1,2,"vdr-custom-field-control",17),s.ec()),2&e){const e=t.$implicit,c=s.rc(2);s.Qb(1),s.yc("ngIf",c.customFieldIsSet(e.name))}}function dt(e,t){if(1&e&&(s.hc(0,"section",15),s.hc(1,"label"),s.Vc(2),s.sc(3,"translate"),s.gc(),s.Tc(4,lt,2,1,"ng-container",16),s.gc()),2&e){const e=s.rc();s.Qb(2),s.Wc(s.tc(3,2,"common.custom-fields")),s.Qb(2),s.yc("ngForOf",e.customFields)}}it.\u0275fac=function(e){return new(e||it)(s.bc(n.s),s.bc(n.G),s.bc(n.F))},it.\u0275cmp=s.Vb({type:it,selectors:[["vdr-country-list"]],decls:24,vars:22,consts:[["type","text","name","searchTerm",1,"search-input",3,"formControl","placeholder"],["locationId","country-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items"],[3,"expand"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[3,"routerLink",4,"ngFor","ngForOf"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"routerLink"],[3,"colorFrom"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.cc(2,"input",0),s.sc(3,"translate"),s.gc(),s.hc(4,"vdr-ab-right"),s.cc(5,"vdr-action-bar-items",1),s.Tc(6,He,4,5,"a",2),s.gc(),s.gc(),s.hc(7,"vdr-data-table",3),s.sc(8,"async"),s.hc(9,"vdr-dt-column"),s.Vc(10),s.sc(11,"translate"),s.gc(),s.hc(12,"vdr-dt-column",4),s.Vc(13),s.sc(14,"translate"),s.gc(),s.hc(15,"vdr-dt-column"),s.Vc(16),s.sc(17,"translate"),s.gc(),s.hc(18,"vdr-dt-column"),s.Vc(19),s.sc(20,"translate"),s.gc(),s.cc(21,"vdr-dt-column"),s.cc(22,"vdr-dt-column"),s.Tc(23,ct,23,22,"ng-template"),s.gc()),2&e&&(s.Qb(2),s.yc("formControl",t.searchTerm)("placeholder",s.tc(3,9,"settings.search-country-by-name")),s.Qb(4),s.yc("vdrIfPermissions",s.Bc(21,nt)),s.Qb(1),s.yc("items",s.tc(8,11,t.countriesWithZones$)),s.Qb(3),s.Wc(s.tc(11,13,"common.code")),s.Qb(2),s.yc("expand",!0),s.Qb(1),s.Wc(s.tc(14,15,"common.name")),s.Qb(3),s.Wc(s.tc(17,17,"settings.zone")),s.Qb(3),s.Wc(s.tc(20,19,"common.enabled")))},directives:[M.a,M.b,d.a,u.b,u.p,u.g,M.c,A.a,U.a,m.a,h.a,L.h,b.o,l.n,re.a,ae.a,oe.a,le.a,de.a,Be.a],pipes:[g.d,l.b,p.a],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"],changeDetection:0});class ut extends n.l{constructor(e,t,c,i,s,r,a){super(t,e,c,s),this.changeDetector=i,this.dataService=s,this.formBuilder=r,this.notificationService=a,this.languageCodes=Object.values(n.C),this.updatePermission=[n.H.UpdateSettings,n.H.UpdateGlobalSettings],this.customFields=this.getCustomFieldConfig("GlobalSettings"),this.detailForm=this.formBuilder.group({availableLanguages:[""],trackInventory:!1,outOfStockThreshold:[0,u.C.required],customFields:this.formBuilder.group(this.customFields.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:""}),{}))})}ngOnInit(){this.init(),this.dataService.client.userStatus().single$.subscribe(({userStatus:e})=>{if(!e.permissions.includes(n.H.UpdateSettings)){const e=this.detailForm.get("availableLanguages");e&&e.disable()}})}customFieldIsSet(e){return!!this.detailForm.get(["customFields",e])}save(){this.detailForm.dirty&&this.dataService.settings.updateGlobalSettings(this.detailForm.value).pipe(Object(Ze.a)(({updateGlobalSettings:e})=>{switch(e.__typename){case"GlobalSettings":this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"Settings"});break;case"ChannelDefaultLanguageError":this.notificationService.error(e.message)}}),Object(se.a)(()=>this.serverConfigService.refreshGlobalSettings())).subscribe()}setFormValues(e,t){if(this.detailForm.patchValue({availableLanguages:e.availableLanguages,trackInventory:e.trackInventory,outOfStockThreshold:e.outOfStockThreshold}),this.customFields.length){const t=this.detailForm.get("customFields");for(const c of this.customFields){const n=c.name,i=e.customFields[n],s=t.get(n);s&&s.patchValue(i)}}}}ut.\u0275fac=function(e){return new(e||ut)(s.bc(L.e),s.bc(L.a),s.bc(n.I),s.bc(s.j),s.bc(n.s),s.bc(u.e),s.bc(n.G))},ut.\u0275cmp=s.Vb({type:ut,selectors:[["vdr-global-settings"]],features:[s.Nb],decls:22,vars:27,consts:[["locationId","global-settings-detail"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],["for","availableLanguages",3,"label"],["multiple","true","appendTo","body","formControlName","availableLanguages",3,"items","addTag","hideSelected"],["ng-label-tmp",""],["ng-option-tmp",""],["for","outOfStockThreshold",3,"label","tooltip"],["id","outOfStockThreshold","type","number","formControlName","outOfStockThreshold",3,"readonly"],["for","enabled",3,"label","tooltip"],["type","checkbox","clrToggle","","name","enabled","formControlName","trackInventory",3,"vdrDisabled"],["formGroupName","customFields",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["aria-hidden","true",1,"ng-value-icon","left",3,"click"],[1,"ng-value-label"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","GlobalSettings",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","GlobalSettings",3,"customFieldsFormGroup","customField"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-right"),s.cc(2,"vdr-action-bar-items",0),s.Tc(3,st,3,4,"button",1),s.gc(),s.gc(),s.hc(4,"form",2),s.hc(5,"vdr-form-field",3),s.sc(6,"translate"),s.hc(7,"ng-select",4),s.Tc(8,rt,5,4,"ng-template",5),s.Tc(9,at,2,4,"ng-template",6),s.gc(),s.gc(),s.hc(10,"vdr-form-field",7),s.sc(11,"translate"),s.sc(12,"translate"),s.cc(13,"input",8),s.sc(14,"hasPermission"),s.gc(),s.hc(15,"vdr-form-field",9),s.sc(16,"translate"),s.sc(17,"translate"),s.hc(18,"clr-toggle-wrapper"),s.cc(19,"input",10),s.sc(20,"hasPermission"),s.gc(),s.gc(),s.Tc(21,dt,5,4,"section",11),s.gc()),2&e&&(s.Qb(3),s.yc("vdrIfPermissions",t.updatePermission),s.Qb(1),s.yc("formGroup",t.detailForm),s.Qb(1),s.yc("label",s.tc(6,13,"common.available-languages")),s.Qb(2),s.yc("items",t.languageCodes)("addTag",!1)("hideSelected",!0),s.Qb(3),s.yc("label",s.tc(11,15,"settings.global-out-of-stock-threshold"))("tooltip",s.tc(12,17,"settings.global-out-of-stock-threshold-tooltip")),s.Qb(3),s.yc("readonly",!s.tc(14,19,t.updatePermission)),s.Qb(2),s.yc("label",s.tc(16,21,"settings.track-inventory-default"))("tooltip",s.tc(17,23,"catalog.track-inventory-tooltip")),s.Qb(4),s.yc("vdrDisabled",!s.tc(20,25,t.updatePermission)),s.Qb(2),s.yc("ngIf",t.customFields.length))},directives:[M.a,M.c,A.a,U.a,u.E,u.q,u.j,N.a,R.a,u.p,u.h,R.e,R.d,d.a,u.v,u.b,b.k,u.a,b.i,pe.a,l.o,u.k,b.u,l.n,_.a],pipes:[g.d,p.a],styles:["ng-select .ng-arrow-wrapper .ng-arrow,   ng-select .ng-select-container>span,   ng-select .ng-value>span{margin:0!important}"],changeDetection:0});var mt=c("Mb15"),ht=c("6y1o"),bt=c("7xiD");function gt(e,t){if(1&e){const e=s.ic();s.hc(0,"button",5),s.pc("click",function(){s.Lc(e);return s.rc().create()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc();s.yc("disabled",e.detailForm.pristine||e.detailForm.invalid),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.create")," ")}}function pt(e,t){if(1&e){const e=s.ic();s.hc(0,"button",5),s.pc("click",function(){s.Lc(e);return s.rc(2).save()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc(2);s.yc("disabled",e.detailForm.pristine||e.detailForm.invalid||!e.selectedHandler),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.update")," ")}}function ft(e,t){if(1&e&&s.Tc(0,pt,3,4,"button",6),2&e){const e=s.rc();s.yc("vdrIfPermissions",e.updatePermission)}}function yt(e,t){if(1&e){const e=s.ic();s.hc(0,"vdr-configurable-input",21),s.pc("remove",function(){s.Lc(e);return s.rc(2).removeChecker()}),s.sc(1,"hasPermission"),s.gc()}if(2&e){const e=s.rc(2);s.yc("operation",e.selectedChecker)("operationDefinition",e.selectedCheckerDefinition)("readonly",!s.tc(1,3,e.updatePermission))}}function vt(e,t){if(1&e){const e=s.ic();s.hc(0,"button",26),s.pc("click",function(){s.Lc(e);const c=t.$implicit;return s.rc(3).selectChecker(c)}),s.Vc(1),s.gc()}if(2&e){const e=t.$implicit;s.Qb(1),s.Xc(" ",e.description," ")}}function Ct(e,t){if(1&e&&(s.hc(0,"div"),s.hc(1,"vdr-dropdown"),s.hc(2,"button",22),s.cc(3,"clr-icon",23),s.Vc(4),s.sc(5,"translate"),s.gc(),s.hc(6,"vdr-dropdown-menu",24),s.Tc(7,vt,2,1,"button",25),s.gc(),s.gc(),s.gc()),2&e){const e=s.rc(2);s.Qb(4),s.Xc(" ",s.tc(5,2,"common.select")," "),s.Qb(3),s.yc("ngForOf",e.checkers)}}function Ot(e,t){if(1&e){const e=s.ic();s.hc(0,"vdr-configurable-input",27),s.pc("remove",function(){s.Lc(e);return s.rc(2).removeHandler()}),s.sc(1,"hasPermission"),s.gc()}if(2&e){const e=s.rc(2);s.yc("operation",e.selectedHandler)("operationDefinition",e.selectedHandlerDefinition)("readonly",!s.tc(1,3,e.updatePermission))}}function Qt(e,t){if(1&e){const e=s.ic();s.hc(0,"button",26),s.pc("click",function(){s.Lc(e);const c=t.$implicit;return s.rc(3).selectHandler(c)}),s.Vc(1),s.gc()}if(2&e){const e=t.$implicit;s.Qb(1),s.Xc(" ",e.description," ")}}function kt(e,t){if(1&e&&(s.hc(0,"div"),s.hc(1,"vdr-dropdown"),s.hc(2,"button",22),s.cc(3,"clr-icon",23),s.Vc(4),s.sc(5,"translate"),s.gc(),s.hc(6,"vdr-dropdown-menu",24),s.Tc(7,Qt,2,1,"button",25),s.gc(),s.gc(),s.gc()),2&e){const e=s.rc(2);s.Qb(4),s.Xc(" ",s.tc(5,2,"common.select")," "),s.Qb(3),s.yc("ngForOf",e.handlers)}}function Ft(e,t){if(1&e){const e=s.ic();s.hc(0,"form",7),s.hc(1,"vdr-form-field",8),s.sc(2,"translate"),s.hc(3,"input",9),s.pc("input",function(c){s.Lc(e);const n=t.ngIf;return s.rc().updateCode(n.code,c.target.value)}),s.sc(4,"hasPermission"),s.gc(),s.gc(),s.hc(5,"vdr-form-field",10),s.sc(6,"translate"),s.sc(7,"hasPermission"),s.cc(8,"input",11),s.sc(9,"hasPermission"),s.gc(),s.cc(10,"vdr-rich-text-editor",12),s.sc(11,"hasPermission"),s.sc(12,"translate"),s.hc(13,"vdr-form-field",13),s.sc(14,"translate"),s.hc(15,"clr-toggle-wrapper"),s.cc(16,"input",14),s.sc(17,"hasPermission"),s.gc(),s.gc(),s.hc(18,"div",15),s.hc(19,"div",16),s.hc(20,"label",17),s.Vc(21),s.sc(22,"translate"),s.gc(),s.Tc(23,yt,2,5,"vdr-configurable-input",18),s.Tc(24,Ct,8,4,"div",19),s.gc(),s.hc(25,"div",16),s.hc(26,"label",17),s.Vc(27),s.sc(28,"translate"),s.gc(),s.Tc(29,Ot,2,5,"vdr-configurable-input",20),s.Tc(30,kt,8,4,"div",19),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.rc();s.yc("formGroup",e.detailForm),s.Qb(1),s.yc("label",s.tc(2,16,"common.name")),s.Qb(2),s.yc("readonly",!s.tc(4,18,e.updatePermission)),s.Qb(2),s.yc("label",s.tc(6,20,"common.code"))("readOnlyToggle",s.tc(7,22,e.updatePermission)),s.Qb(3),s.yc("readonly",!s.tc(9,24,e.updatePermission)),s.Qb(2),s.yc("readonly",!s.tc(11,26,e.updatePermission))("label",s.tc(12,28,"common.description")),s.Qb(3),s.yc("label",s.tc(14,30,"common.enabled")),s.Qb(3),s.yc("vdrDisabled",!s.tc(17,32,e.updatePermission)),s.Qb(5),s.Wc(s.tc(22,34,"settings.payment-eligibility-checker")),s.Qb(2),s.yc("ngIf",e.selectedChecker&&e.selectedCheckerDefinition),s.Qb(1),s.yc("ngIf",!e.selectedChecker||!e.selectedCheckerDefinition),s.Qb(3),s.Wc(s.tc(28,36,"settings.payment-handler")),s.Qb(2),s.yc("ngIf",e.selectedHandler&&e.selectedHandlerDefinition),s.Qb(1),s.yc("ngIf",!e.selectedHandler||!e.selectedHandlerDefinition)}}class St extends n.l{constructor(e,t,c,i,s,r,a){super(t,e,c,s),this.changeDetector=i,this.dataService=s,this.formBuilder=r,this.notificationService=a,this.checkers=[],this.handlers=[],this.updatePermission=[n.H.UpdateSettings,n.H.UpdatePaymentMethod],this.detailForm=this.formBuilder.group({code:["",u.C.required],name:["",u.C.required],description:"",enabled:[!0,u.C.required],checker:{},handler:{}})}ngOnInit(){this.init(),Object(We.a)([this.dataService.settings.getPaymentMethodOperations().single$,this.entity$.pipe(Object(w.a)(1))]).subscribe(([e,t])=>{this.checkers=e.paymentMethodEligibilityCheckers,this.handlers=e.paymentMethodHandlers,this.changeDetector.markForCheck(),this.selectedCheckerDefinition=e.paymentMethodEligibilityCheckers.find(e=>e.code===(t.checker&&t.checker.code)),this.selectedHandlerDefinition=e.paymentMethodHandlers.find(e=>e.code===(t.handler&&t.handler.code))})}ngOnDestroy(){this.destroy()}updateCode(e,t){if(!e){const e=this.detailForm.get(["code"]);e&&e.pristine&&e.setValue(Object(mt.normalizeString)(t,"-"))}}configArgsIsPopulated(){const e=this.detailForm.get("configArgs");return!!e&&0<Object.keys(e.controls).length}selectChecker(e){this.selectedCheckerDefinition=e,this.selectedChecker=Object(n.M)(e);const t=this.detailForm.get("checker");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedChecker)),this.detailForm.markAsDirty()}selectHandler(e){this.selectedHandlerDefinition=e,this.selectedHandler=Object(n.M)(e);const t=this.detailForm.get("handler");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedHandler)),this.detailForm.markAsDirty()}removeChecker(){this.selectedChecker=null,this.detailForm.markAsDirty()}removeHandler(){this.selectedHandler=null,this.detailForm.markAsDirty()}create(){const e=this.selectedChecker,t=this.selectedHandler;t&&this.entity$.pipe(Object(w.a)(1),Object(x.a)(({id:c})=>{const i=this.detailForm.value,s={name:i.name,code:i.code,description:i.description,enabled:i.enabled,checker:e?Object(n.Z)(e,i.checker):null,handler:Object(n.Z)(t,i.handler)};return this.dataService.settings.createPaymentMethod(s)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-create-success"),{entity:"PaymentMethod"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",e.createPaymentMethod.id],{relativeTo:this.route})},e=>{this.notificationService.error(Object(j.a)("common.notify-create-error"),{entity:"PaymentMethod"})})}save(){const e=this.selectedChecker,t=this.selectedHandler;t&&this.entity$.pipe(Object(w.a)(1),Object(x.a)(({id:c})=>{const i=this.detailForm.value,s={id:c,name:i.name,code:i.code,description:i.description,enabled:i.enabled,checker:e?Object(n.Z)(e,i.checker):null,handler:Object(n.Z)(t,i.handler)};return this.dataService.settings.updatePaymentMethod(s)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"PaymentMethod"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},e=>{this.notificationService.error(Object(j.a)("common.notify-update-error"),{entity:"PaymentMethod"})})}setFormValues(e){this.detailForm.patchValue({name:e.name,code:e.code,description:e.description,enabled:e.enabled,checker:e.checker||{},handler:e.handler||{}}),this.selectedChecker||(this.selectedChecker=e.checker&&{code:e.checker.code,args:e.checker.args.map(e=>Object.assign(Object.assign({},e),{value:Object(n.V)(e.value)}))}),this.selectedHandler||(this.selectedHandler=e.handler&&{code:e.handler.code,args:e.handler.args.map(e=>Object.assign(Object.assign({},e),{value:Object(n.V)(e.value)}))})}}St.\u0275fac=function(e){return new(e||St)(s.bc(L.e),s.bc(L.a),s.bc(n.I),s.bc(s.j),s.bc(n.s),s.bc(u.e),s.bc(n.G))},St.\u0275cmp=s.Vb({type:St,selectors:[["vdr-payment-method-detail"]],features:[s.Nb],decls:12,vars:10,consts:[[3,"entity"],["locationId","payment-method-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","code",3,"label","readOnlyToggle"],["id","code","type","text","formControlName","code",3,"readonly"],["formControlName","description",3,"readonly","label"],["for","description",3,"label"],["type","checkbox","clrToggle","","id","enabled","formControlName","enabled",3,"vdrDisabled"],[1,"clr-row","mt4"],[1,"clr-col"],[1,"clr-control-label"],["formControlName","checker",3,"operation","operationDefinition","readonly","remove",4,"ngIf"],[4,"ngIf"],["formControlName","handler",3,"operation","operationDefinition","readonly","remove",4,"ngIf"],["formControlName","checker",3,"operation","operationDefinition","readonly","remove"],["vdrDropdownTrigger","",1,"btn","btn-outline"],["shape","plus"],["vdrPosition","bottom-left"],["type","button","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["type","button","vdrDropdownItem","",3,"click"],["formControlName","handler",3,"operation","operationDefinition","readonly","remove"]],template:function(e,t){if(1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.cc(2,"vdr-entity-info",0),s.sc(3,"async"),s.gc(),s.hc(4,"vdr-ab-right"),s.cc(5,"vdr-action-bar-items",1),s.Tc(6,gt,3,4,"button",2),s.sc(7,"async"),s.Tc(8,ft,1,1,"ng-template",null,3,s.Uc),s.gc(),s.gc(),s.Tc(10,Ft,31,38,"form",4),s.sc(11,"async")),2&e){const e=s.Ic(9);s.Qb(2),s.yc("entity",s.tc(3,4,t.entity$)),s.Qb(4),s.yc("ngIf",s.tc(7,6,t.isNew$))("ngIfElse",e),s.Qb(4),s.yc("ngIf",s.tc(11,8,t.entity$))}},directives:[M.a,M.b,$.a,M.c,A.a,l.o,U.a,u.E,u.q,u.j,N.a,d.a,u.b,u.p,u.h,ht.a,b.k,u.a,b.i,pe.a,b.u,bt.a,ae.a,oe.a,b.o,le.a,l.n,de.a],pipes:[l.b,g.d,p.a],styles:[""],changeDetection:0});const It=function(){return["./create"]};function Tt(e,t){1&e&&(s.hc(0,"a",3),s.cc(1,"clr-icon",4),s.Vc(2),s.sc(3,"translate"),s.gc()),2&e&&(s.yc("routerLink",s.Bc(4,It)),s.Qb(2),s.Xc(" ",s.tc(3,2,"settings.create-new-payment-method")," "))}const Pt=function(e){return["./",e]},Dt=function(){return["DeleteSettings","DeletePaymentMethod"]};function jt(e,t){if(1&e){const e=s.ic();s.hc(0,"td",5),s.Vc(1),s.gc(),s.hc(2,"td",5),s.Vc(3),s.gc(),s.hc(4,"td",6),s.cc(5,"vdr-table-row-action",7),s.sc(6,"translate"),s.gc(),s.hc(7,"td",6),s.hc(8,"vdr-dropdown"),s.hc(9,"button",8),s.Vc(10),s.sc(11,"translate"),s.cc(12,"clr-icon",9),s.gc(),s.hc(13,"vdr-dropdown-menu",10),s.hc(14,"button",11),s.pc("click",function(){s.Lc(e);const c=t.item;return s.rc().deletePaymentMethod(c.id)}),s.sc(15,"hasPermission"),s.cc(16,"clr-icon",12),s.Vc(17),s.sc(18,"translate"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.item;s.Qb(1),s.Wc(e.code),s.Qb(2),s.Wc(e.enabled),s.Qb(2),s.yc("label",s.tc(6,7,"common.edit"))("linkTo",s.Cc(15,Pt,e.id)),s.Qb(5),s.Xc(" ",s.tc(11,9,"common.actions")," "),s.Qb(4),s.yc("disabled",!s.tc(15,11,s.Bc(17,Dt))),s.Qb(3),s.Xc(" ",s.tc(18,13,"common.delete")," ")}}const Vt=function(){return["CreateSettings","CreatePaymentMethod"]};class wt extends n.n{constructor(e,t,c,n,i){super(t,c),this.dataService=e,this.modalService=n,this.notificationService=i,super.setQueryFn((...e)=>this.dataService.settings.getPaymentMethods(...e).refetchOnChannelChange(),e=>e.paymentMethods)}deletePaymentMethod(e){this.showModalAndDelete(e).pipe(Object(se.a)(t=>t.result===n.t.DELETED?[!0]:this.showModalAndDelete(e,t.message||"").pipe(Object(i.a)(e=>e.result===n.t.DELETED))),Object(se.a)(()=>this.dataService.settings.getPaymentMethods(100).single$)).subscribe(()=>{this.notificationService.success(Object(j.a)("common.notify-delete-success"),{entity:"PaymentMethod"}),this.refresh()},e=>{this.notificationService.error(Object(j.a)("common.notify-delete-error"),{entity:"PaymentMethod"})})}showModalAndDelete(e,t){return this.modalService.dialog({title:Object(j.a)("settings.confirm-delete-payment-method"),body:t,buttons:[{type:"secondary",label:Object(j.a)("common.cancel")},{type:"danger",label:Object(j.a)("common.delete"),returnValue:!0}]}).pipe(Object(se.a)(c=>c?this.dataService.settings.deletePaymentMethod(e,!!t):ie.a),Object(i.a)(e=>e.deletePaymentMethod))}}function xt(e,t){1&e&&(s.hc(0,"vdr-form-field",14),s.sc(1,"translate"),s.cc(2,"input",12),s.gc()),2&e&&s.yc("label",s.tc(1,1,"settings.password"))}function Lt(e,t){if(1&e&&s.cc(0,"vdr-custom-field-control",18),2&e){const e=s.rc().$implicit,t=s.rc(2);s.yc("customFieldsFormGroup",t.detailForm.get("customFields"))("customField",e)}}function Mt(e,t){if(1&e&&(s.fc(0),s.Tc(1,Lt,1,2,"vdr-custom-field-control",17),s.ec()),2&e){const e=t.$implicit,c=s.rc(2);s.Qb(1),s.yc("ngIf",c.customFieldIsSet(e.name))}}function $t(e,t){if(1&e&&(s.hc(0,"section",15),s.hc(1,"label"),s.Vc(2),s.sc(3,"translate"),s.gc(),s.Tc(4,Mt,2,1,"ng-container",16),s.gc()),2&e){const e=s.rc();s.Qb(2),s.Wc(s.tc(3,2,"common.custom-fields")),s.Qb(2),s.yc("ngForOf",e.customFields)}}wt.\u0275fac=function(e){return new(e||wt)(s.bc(n.s),s.bc(L.e),s.bc(L.a),s.bc(n.F),s.bc(n.G))},wt.\u0275cmp=s.Vb({type:wt,selectors:[["vdr-payment-method-list"]],features:[s.Nb],decls:18,vars:20,consts:[["locationId","payment-method-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-right"),s.cc(2,"vdr-action-bar-items",0),s.Tc(3,Tt,4,5,"a",1),s.gc(),s.gc(),s.hc(4,"vdr-data-table",2),s.pc("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),s.sc(5,"async"),s.sc(6,"async"),s.sc(7,"async"),s.sc(8,"async"),s.hc(9,"vdr-dt-column"),s.Vc(10),s.sc(11,"translate"),s.gc(),s.hc(12,"vdr-dt-column"),s.Vc(13),s.sc(14,"translate"),s.gc(),s.cc(15,"vdr-dt-column"),s.cc(16,"vdr-dt-column"),s.Tc(17,jt,19,18,"ng-template"),s.gc()),2&e&&(s.Qb(3),s.yc("vdrIfPermissions",s.Bc(19,Vt)),s.Qb(1),s.yc("items",s.tc(5,7,t.items$))("itemsPerPage",s.tc(6,9,t.itemsPerPage$))("totalItems",s.tc(7,11,t.totalItems$))("currentPage",s.tc(8,13,t.currentPage$)),s.Qb(6),s.Wc(s.tc(11,15,"common.code")),s.Qb(3),s.Wc(s.tc(14,17,"common.enabled")))},directives:[M.a,M.c,A.a,U.a,m.a,h.a,L.h,b.o,re.a,ae.a,oe.a,le.a,de.a],pipes:[l.b,g.d,p.a],styles:[""],changeDetection:0});class At extends n.l{constructor(e,t,c,n,i,s,r){super(t,e,c,i),this.changeDetector=n,this.dataService=i,this.formBuilder=s,this.notificationService=r,this.customFields=this.getCustomFieldConfig("Administrator"),this.detailForm=this.formBuilder.group({emailAddress:["",u.C.required],firstName:["",u.C.required],lastName:["",u.C.required],password:[""],customFields:this.formBuilder.group(this.customFields.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:""}),{}))})}ngOnInit(){this.init()}ngOnDestroy(){this.destroy()}customFieldIsSet(e){return!!this.detailForm.get(["customFields",e])}save(){this.entity$.pipe(Object(w.a)(1),Object(x.a)(({id:e})=>{const t=this.detailForm.value,c={emailAddress:t.emailAddress,firstName:t.firstName,lastName:t.lastName,password:t.password,customFields:t.customFields};return this.dataService.administrator.updateActiveAdministrator(c)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"Administrator"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},e=>{this.notificationService.error(Object(j.a)("common.notify-update-error"),{entity:"Administrator"})})}setFormValues(e,t){if(this.detailForm.patchValue({emailAddress:e.emailAddress,firstName:e.firstName,lastName:e.lastName}),this.customFields.length){const t=this.detailForm.get("customFields");for(const c of this.customFields){const n=c.name,i=e.customFields[n],s=t.get(n);s&&s.patchValue(i)}}}}At.\u0275fac=function(e){return new(e||At)(s.bc(L.e),s.bc(L.a),s.bc(n.I),s.bc(s.j),s.bc(n.s),s.bc(u.e),s.bc(n.G))},At.\u0275cmp=s.Vb({type:At,selectors:[["vdr-profile"]],features:[s.Nb],decls:25,vars:25,consts:[[3,"entity"],["locationId","administrator-detail"],[1,"btn","btn-primary",3,"disabled","click"],[1,"form",3,"formGroup"],["for","emailAddress",3,"label"],["id","emailAddress","type","text","formControlName","emailAddress"],["for","firstName",3,"label"],["id","firstName","type","text","formControlName","firstName"],["for","lastName",3,"label"],["id","lastName","type","text","formControlName","lastName"],["for","password",3,"label",4,"ngIf"],["for","password",3,"label","readOnlyToggle"],["id","password","type","password","formControlName","password"],["formGroupName","customFields",4,"ngIf"],["for","password",3,"label"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","Administrator",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","Administrator",3,"customFieldsFormGroup","customField"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.cc(2,"vdr-entity-info",0),s.sc(3,"async"),s.gc(),s.hc(4,"vdr-ab-right"),s.cc(5,"vdr-action-bar-items",1),s.hc(6,"button",2),s.pc("click",function(){return t.save()}),s.Vc(7),s.sc(8,"translate"),s.gc(),s.gc(),s.gc(),s.hc(9,"form",3),s.hc(10,"vdr-form-field",4),s.sc(11,"translate"),s.cc(12,"input",5),s.gc(),s.hc(13,"vdr-form-field",6),s.sc(14,"translate"),s.cc(15,"input",7),s.gc(),s.hc(16,"vdr-form-field",8),s.sc(17,"translate"),s.cc(18,"input",9),s.gc(),s.Tc(19,xt,3,3,"vdr-form-field",10),s.sc(20,"async"),s.hc(21,"vdr-form-field",11),s.sc(22,"translate"),s.cc(23,"input",12),s.gc(),s.Tc(24,$t,5,4,"section",13),s.gc()),2&e&&(s.Qb(2),s.yc("entity",s.tc(3,11,t.entity$)),s.Qb(4),s.yc("disabled",t.detailForm.invalid||t.detailForm.pristine),s.Qb(1),s.Xc(" ",s.tc(8,13,"common.update")," "),s.Qb(2),s.yc("formGroup",t.detailForm),s.Qb(1),s.yc("label",s.tc(11,15,"settings.email-address")),s.Qb(3),s.yc("label",s.tc(14,17,"settings.first-name")),s.Qb(3),s.yc("label",s.tc(17,19,"settings.last-name")),s.Qb(3),s.yc("ngIf",s.tc(20,21,t.isNew$)),s.Qb(2),s.yc("label",s.tc(22,23,"settings.password"))("readOnlyToggle",!0),s.Qb(3),s.yc("ngIf",t.customFields.length))},directives:[M.a,M.b,$.a,M.c,A.a,u.E,u.q,u.j,N.a,d.a,u.b,u.p,u.h,l.o,u.k,b.u,l.n,_.a],pipes:[l.b,g.d],styles:[""],changeDetection:0});var Nt=c("jEaP"),Rt=c("39yD");function zt(e,t){if(1&e){const e=s.ic();s.hc(0,"button",12),s.pc("click",function(){s.Lc(e);return s.rc().create()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc();s.yc("disabled",e.detailForm.invalid||e.detailForm.pristine),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.create")," ")}}function Wt(e,t){if(1&e){const e=s.ic();s.hc(0,"button",12),s.pc("click",function(){s.Lc(e);return s.rc(2).save()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc(2);s.yc("disabled",e.detailForm.invalid||e.detailForm.pristine),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.update")," ")}}function Xt(e,t){1&e&&s.Tc(0,Wt,3,4,"button",13),2&e&&s.yc("vdrIfPermissions","UpdateAdministrator")}class Gt extends n.l{constructor(e,t,c,n,i,s,r){super(t,e,c,i),this.changeDetector=n,this.dataService=i,this.formBuilder=s,this.notificationService=r,this.detailForm=this.formBuilder.group({code:["",u.C.required],description:["",u.C.required],channelIds:[],permissions:[]})}ngOnInit(){this.init(),this.role$=this.entity$,this.permissionDefinitions=this.serverConfigService.getPermissionDefinitions()}ngOnDestroy(){this.destroy()}updateCode(e){const t=this.detailForm.get(["code"]);t&&t.pristine&&t.setValue(Object(mt.normalizeString)(e,"-"))}setPermission(e){const t=this.detailForm.get("permissions");if(t){const c=t.value,n=!0===e.value?Object(Nt.unique)([...c,e.permission]):c.filter(t=>t!==e.permission);t.setValue(n),t.markAsDirty()}}create(){const e=this.detailForm.value;this.dataService.administrator.createRole(e).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-create-success"),{entity:"Role"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",e.createRole.id],{relativeTo:this.route})},e=>{this.notificationService.error(Object(j.a)("common.notify-create-error"),{entity:"Role"})})}save(){this.role$.pipe(Object(w.a)(1),Object(x.a)(({id:e})=>{const t=this.detailForm.value,c=Object.assign({id:e},t);return this.dataService.administrator.updateRole(c)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"Role"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},e=>{this.notificationService.error(Object(j.a)("common.notify-update-error"),{entity:"Role"})})}setFormValues(e,t){this.detailForm.patchValue({description:e.description,code:e.code,channelIds:e.channels.map(e=>e.id),permissions:e.permissions}),this.changeDetector.detectChanges()}}Gt.\u0275fac=function(e){return new(e||Gt)(s.bc(L.e),s.bc(L.a),s.bc(n.I),s.bc(s.j),s.bc(n.s),s.bc(u.e),s.bc(n.G))},Gt.\u0275cmp=s.Vb({type:Gt,selectors:[["vdr-role-detail"]],features:[s.Nb],decls:29,vars:37,consts:[[3,"entity"],["locationId","role-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","description",3,"label"],["id","description","type","text","formControlName","description",3,"readonly","input"],["for","code",3,"label","readOnlyToggle"],["id","code","type","text","formControlName","code",3,"readonly"],[3,"label"],["formControlName","channelIds",3,"vdrDisabled"],[3,"permissionDefinitions","activePermissions","readonly","permissionChange"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"]],template:function(e,t){if(1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.cc(2,"vdr-entity-info",0),s.sc(3,"async"),s.gc(),s.hc(4,"vdr-ab-right"),s.cc(5,"vdr-action-bar-items",1),s.Tc(6,zt,3,4,"button",2),s.sc(7,"async"),s.Tc(8,Xt,1,1,"ng-template",null,3,s.Uc),s.gc(),s.gc(),s.hc(10,"form",4),s.hc(11,"vdr-form-field",5),s.sc(12,"translate"),s.hc(13,"input",6),s.pc("input",function(e){return t.updateCode(e.target.value)}),s.sc(14,"hasPermission"),s.gc(),s.gc(),s.hc(15,"vdr-form-field",7),s.sc(16,"translate"),s.sc(17,"hasPermission"),s.cc(18,"input",8),s.sc(19,"hasPermission"),s.gc(),s.hc(20,"vdr-form-field",9),s.sc(21,"translate"),s.cc(22,"vdr-channel-assignment-control",10),s.sc(23,"hasPermission"),s.gc(),s.hc(24,"label"),s.Vc(25),s.sc(26,"translate"),s.gc(),s.hc(27,"vdr-permission-grid",11),s.pc("permissionChange",function(e){return t.setPermission(e)}),s.sc(28,"hasPermission"),s.gc(),s.gc()),2&e){const e=s.Ic(9);let c=null;s.Qb(2),s.yc("entity",s.tc(3,15,t.entity$)),s.Qb(4),s.yc("ngIf",s.tc(7,17,t.isNew$))("ngIfElse",e),s.Qb(4),s.yc("formGroup",t.detailForm),s.Qb(1),s.yc("label",s.tc(12,19,"common.description")),s.Qb(2),s.yc("readonly",!s.tc(14,21,"UpdateAdministrator")),s.Qb(2),s.yc("label",s.tc(16,23,"common.code"))("readOnlyToggle",s.tc(17,25,"UpdateAdministrator")),s.Qb(3),s.yc("readonly",!s.tc(19,27,"UpdateAdministrator")),s.Qb(2),s.yc("label",s.tc(21,29,"settings.channel")),s.Qb(2),s.yc("vdrDisabled",!s.tc(23,31,"UpdateAdministrator")),s.Qb(3),s.Wc(s.tc(26,33,"settings.permissions")),s.Qb(2),s.yc("permissionDefinitions",t.permissionDefinitions)("activePermissions",null==(c=t.detailForm.get("permissions"))?null:c.value)("readonly",!s.tc(28,35,"UpdateAdministrator"))}},directives:[M.a,M.b,$.a,M.c,A.a,l.o,u.E,u.q,u.j,N.a,d.a,u.b,u.p,u.h,Rt.a,pe.a,b.u,E,U.a],pipes:[l.b,g.d,p.a],styles:[""],changeDetection:0});const Et=function(){return["./create"]};function Ut(e,t){1&e&&(s.hc(0,"a",3),s.cc(1,"clr-icon",4),s.Vc(2),s.sc(3,"translate"),s.gc()),2&e&&(s.yc("routerLink",s.Bc(4,Et)),s.Qb(2),s.Xc(" ",s.tc(3,2,"settings.create-new-role")," "))}function _t(e,t){if(1&e&&(s.hc(0,"span"),s.Vc(1),s.gc()),2&e){const e=s.rc().item;s.Qb(1),s.Wc(e.code)}}function Zt(e,t){if(1&e&&(s.hc(0,"vdr-chip"),s.cc(1,"vdr-channel-badge",17),s.Vc(2),s.sc(3,"translate"),s.sc(4,"channelCodeToLabel"),s.gc()),2&e){const e=t.$implicit;s.Qb(1),s.yc("channelCode",e.code),s.Qb(1),s.Xc(" ",s.tc(3,2,s.tc(4,4,e.code))," ")}}function Bt(e,t){if(1&e&&(s.fc(0),s.Tc(1,Zt,5,6,"vdr-chip",16),s.ec()),2&e){const e=s.rc().item;s.Qb(1),s.yc("ngForOf",e.channels)}}function qt(e,t){if(1&e&&(s.hc(0,"vdr-chip"),s.Vc(1),s.gc()),2&e){const e=t.$implicit;s.Qb(1),s.Wc(e)}}function Ht(e,t){if(1&e&&(s.fc(0),s.cc(1,"clr-icon",4),s.Vc(2),s.ec()),2&e){const e=s.rc(3).item,t=s.rc();s.Qb(2),s.Xc(" ",e.permissions.length-t.initialLimit," ")}}function Kt(e,t){1&e&&s.cc(0,"clr-icon",21)}function Yt(e,t){if(1&e){const e=s.ic();s.hc(0,"button",19),s.pc("click",function(){s.Lc(e);const t=s.rc(2).item;return s.rc().toggleDisplayLimit(t)}),s.Tc(1,Ht,3,1,"ng-container",7),s.Tc(2,Kt,1,0,"ng-template",null,20,s.Uc),s.gc()}if(2&e){const e=s.Ic(3),t=s.rc(2).item,c=s.rc();s.Qb(1),s.yc("ngIf",(c.displayLimit[t.id]||0)<t.permissions.length)("ngIfElse",e)}}function Jt(e,t){if(1&e&&(s.fc(0),s.Tc(1,qt,2,1,"vdr-chip",16),s.sc(2,"slice"),s.Tc(3,Yt,4,2,"button",18),s.ec()),2&e){const e=s.rc().item,t=s.rc();s.Qb(1),s.yc("ngForOf",s.vc(2,2,e.permissions,0,t.displayLimit[e.id]||3)),s.Qb(2),s.yc("ngIf",e.permissions.length>t.initialLimit)}}function ec(e,t){1&e&&(s.hc(0,"span",22),s.Vc(1),s.sc(2,"translate"),s.gc()),2&e&&(s.Qb(1),s.Wc(s.tc(2,1,"settings.default-role-label")))}const tc=function(e){return["./",e]};function cc(e,t){if(1&e&&(s.cc(0,"vdr-table-row-action",23),s.sc(1,"translate")),2&e){const e=s.rc().item;s.yc("label",s.tc(1,2,"common.edit"))("linkTo",s.Cc(4,tc,e.id))}}function nc(e,t){if(1&e){const e=s.ic();s.hc(0,"td",5),s.Vc(1),s.gc(),s.hc(2,"td",5),s.Tc(3,_t,2,1,"span",6),s.gc(),s.hc(4,"td",5),s.Tc(5,Bt,2,1,"ng-container",6),s.gc(),s.hc(6,"td",5),s.Tc(7,Jt,4,6,"ng-container",7),s.Tc(8,ec,3,3,"ng-template",null,8,s.Uc),s.gc(),s.hc(10,"td",9),s.Tc(11,cc,2,6,"vdr-table-row-action",10),s.gc(),s.hc(12,"td",9),s.hc(13,"vdr-dropdown"),s.hc(14,"button",11),s.Vc(15),s.sc(16,"translate"),s.cc(17,"clr-icon",12),s.gc(),s.hc(18,"vdr-dropdown-menu",13),s.hc(19,"button",14),s.pc("click",function(){s.Lc(e);const c=t.item;return s.rc().deleteRole(c.id)}),s.sc(20,"hasPermission"),s.cc(21,"clr-icon",15),s.Vc(22),s.sc(23,"translate"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.item,c=s.Ic(9),n=s.rc();s.Qb(1),s.Wc(e.description),s.Qb(2),s.yc("ngIf",!n.isDefaultRole(e)),s.Qb(2),s.yc("ngIf",!n.isDefaultRole(e)),s.Qb(2),s.yc("ngIf",!n.isDefaultRole(e))("ngIfElse",c),s.Qb(4),s.yc("ngIf",!n.isDefaultRole(e)),s.Qb(3),s.yc("disabled",n.isDefaultRole(e)),s.Qb(1),s.Xc(" ",s.tc(16,10,"common.actions")," "),s.Qb(4),s.yc("disabled",!s.tc(20,12,"SuperAdmin")),s.Qb(3),s.Xc(" ",s.tc(23,14,"common.delete")," ")}}class ic extends n.n{constructor(e,t,c,n,i){super(n,i),this.modalService=e,this.notificationService=t,this.dataService=c,this.initialLimit=3,this.displayLimit={},super.setQueryFn((...e)=>this.dataService.administrator.getRoles(...e),e=>e.roles)}ngOnInit(){super.ngOnInit(),this.visibleRoles$=this.items$.pipe(Object(i.a)(e=>e.filter(e=>e.code!==V.CUSTOMER_ROLE_CODE)))}toggleDisplayLimit(e){this.displayLimit[e.id]===e.permissions.length?this.displayLimit[e.id]=this.initialLimit:this.displayLimit[e.id]=e.permissions.length}isDefaultRole(e){return e.code===V.SUPER_ADMIN_ROLE_CODE||e.code===V.CUSTOMER_ROLE_CODE}deleteRole(e){this.modalService.dialog({title:Object(j.a)("settings.confirm-delete-role"),buttons:[{type:"secondary",label:Object(j.a)("common.cancel")},{type:"danger",label:Object(j.a)("common.delete"),returnValue:!0}]}).pipe(Object(se.a)(t=>t?this.dataService.administrator.deleteRole(e):ie.a)).subscribe(()=>{this.notificationService.success(Object(j.a)("common.notify-delete-success"),{entity:"Role"}),this.refresh()},e=>{this.notificationService.error(Object(j.a)("common.notify-delete-error"),{entity:"Role"})})}}ic.\u0275fac=function(e){return new(e||ic)(s.bc(n.F),s.bc(n.G),s.bc(n.s),s.bc(L.e),s.bc(L.a))},ic.\u0275cmp=s.Vb({type:ic,selectors:[["vdr-role-list"]],features:[s.Nb],decls:24,vars:25,consts:[["locationId","role-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["defaultRole",""],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo",4,"ngIf"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm",3,"disabled"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[4,"ngFor","ngForOf"],[3,"channelCode"],["class","btn btn-sm btn-secondary btn-icon",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-secondary","btn-icon",3,"click"],["collapse",""],["shape","minus"],[1,"default-role-label"],["iconShape","edit",3,"label","linkTo"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-right"),s.cc(2,"vdr-action-bar-items",0),s.Tc(3,Ut,4,5,"a",1),s.gc(),s.gc(),s.hc(4,"vdr-data-table",2),s.pc("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),s.sc(5,"async"),s.sc(6,"async"),s.sc(7,"async"),s.sc(8,"async"),s.hc(9,"vdr-dt-column"),s.Vc(10),s.sc(11,"translate"),s.gc(),s.hc(12,"vdr-dt-column"),s.Vc(13),s.sc(14,"translate"),s.gc(),s.hc(15,"vdr-dt-column"),s.Vc(16),s.sc(17,"translate"),s.gc(),s.hc(18,"vdr-dt-column"),s.Vc(19),s.sc(20,"translate"),s.gc(),s.cc(21,"vdr-dt-column"),s.cc(22,"vdr-dt-column"),s.Tc(23,nc,24,16,"ng-template"),s.gc()),2&e&&(s.Qb(3),s.yc("vdrIfPermissions","CreateAdministrator"),s.Qb(1),s.yc("items",s.tc(5,9,t.visibleRoles$))("itemsPerPage",s.tc(6,11,t.itemsPerPage$))("totalItems",s.tc(7,13,t.totalItems$))("currentPage",s.tc(8,15,t.currentPage$)),s.Qb(6),s.Wc(s.tc(11,17,"common.description")),s.Qb(3),s.Wc(s.tc(14,19,"common.code")),s.Qb(3),s.Wc(s.tc(17,21,"settings.channel")),s.Qb(3),s.Wc(s.tc(20,23,"settings.permissions")))},directives:[M.a,M.c,A.a,U.a,m.a,h.a,L.h,b.o,l.o,ae.a,oe.a,le.a,de.a,l.n,Be.a,Le.a,re.a],pipes:[l.b,g.d,p.a,Z.a,l.x],styles:[".default-role-label[_ngcontent-%COMP%]{color:var(--color-grey-400)}"],changeDetection:0});var sc=c("0MpJ"),rc=c("2zLM"),ac=c("ZFbG");function oc(e,t){if(1&e&&s.cc(0,"vdr-object-tree",11),2&e){const e=s.rc().$implicit;s.yc("value",e.metadata)}}function lc(e,t){if(1&e&&(s.hc(0,"div",6),s.hc(1,"div",7),s.hc(2,"vdr-labeled-data",8),s.sc(3,"translate"),s.Vc(4),s.gc(),s.hc(5,"div",9),s.hc(6,"vdr-labeled-data",8),s.sc(7,"translate"),s.Vc(8),s.sc(9,"localeCurrency"),s.gc(),s.hc(10,"vdr-labeled-data",8),s.sc(11,"translate"),s.Vc(12),s.sc(13,"localeCurrency"),s.gc(),s.gc(),s.Tc(14,oc,1,1,"vdr-object-tree",10),s.gc(),s.gc()),2&e){const e=t.$implicit,c=s.rc();s.Qb(1),s.Tb("stale",c.testDataUpdated),s.Qb(1),s.yc("label",s.tc(3,9,"settings.shipping-method")),s.Qb(2),s.Xc(" ",e.name," "),s.Qb(2),s.yc("label",s.tc(7,11,"common.price")),s.Qb(2),s.Xc(" ",s.uc(9,13,e.price,c.currencyCode)," "),s.Qb(2),s.yc("label",s.tc(11,16,"common.price-with-tax")),s.Qb(2),s.Xc(" ",s.uc(13,18,e.priceWithTax,c.currencyCode)," "),s.Qb(2),s.yc("ngIf",e.metadata)}}function dc(e,t){1&e&&(s.hc(0,"div",6),s.cc(1,"clr-icon",12),s.Vc(2),s.sc(3,"translate"),s.gc()),2&e&&(s.Qb(2),s.Xc(" ",s.tc(3,1,"settings.no-eligible-shipping-methods")," "))}class uc{constructor(){this.okToRun=!1,this.testDataUpdated=!1,this.runTest=new s.t}}uc.\u0275fac=function(e){return new(e||uc)},uc.\u0275cmp=s.Vb({type:uc,selectors:[["vdr-shipping-eligibility-test-result"]],inputs:{testResult:"testResult",okToRun:"okToRun",testDataUpdated:"testDataUpdated",currencyCode:"currencyCode"},outputs:{runTest:"runTest"},decls:10,vars:9,consts:[[1,"test-result","card"],[1,"card-header"],["class","card-block",4,"ngFor","ngForOf"],["class","card-block",4,"ngIf"],[1,"card-footer"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"card-block"],[1,"result-details"],[3,"label"],[1,"price-row"],[3,"value",4,"ngIf"],[3,"value"],["shape","ban",1,"is-solid","error"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.Vc(2),s.sc(3,"translate"),s.gc(),s.Tc(4,lc,15,21,"div",2),s.Tc(5,dc,4,3,"div",3),s.hc(6,"div",4),s.hc(7,"button",5),s.pc("click",function(){return t.runTest.emit()}),s.Vc(8),s.sc(9,"translate"),s.gc(),s.gc(),s.gc()),2&e&&(s.Qb(2),s.Xc(" ",s.tc(3,5,"settings.test-result")," "),s.Qb(2),s.yc("ngForOf",t.testResult),s.Qb(1),s.yc("ngIf",0===(null==t.testResult?null:t.testResult.length)),s.Qb(2),s.yc("disabled",!t.okToRun),s.Qb(1),s.Xc(" ",s.tc(9,7,"settings.test-shipping-methods")," "))},directives:[l.n,l.o,sc.a,rc.a,b.o],pipes:[g.d,ac.a],styles:[".result-details[_ngcontent-%COMP%]{transition:opacity .2s}.result-details.stale[_ngcontent-%COMP%]{opacity:.5}.price-row[_ngcontent-%COMP%]{display:flex}.price-row[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child){margin-left:24px}clr-icon.error[_ngcontent-%COMP%]{color:var(--color-error-500)}"],changeDetection:0});var mc=c("LRne"),hc=c("VRyK"),bc=c("1G5W"),gc=c("c+KD"),pc=c("cH1L");function fc(e,t){if(1&e){const e=s.ic();s.hc(0,"tr",10),s.hc(1,"td",11),s.cc(2,"img",12),s.gc(),s.hc(3,"td",13),s.Vc(4),s.gc(),s.hc(5,"td",14),s.Vc(6),s.gc(),s.hc(7,"td",15),s.Vc(8),s.sc(9,"localeCurrency"),s.gc(),s.hc(10,"td",16),s.hc(11,"input",17),s.pc("ngModelChange",function(e){return t.$implicit.quantity=e})("change",function(){s.Lc(e);return s.rc(2).updateQuantity()}),s.gc(),s.hc(12,"button",18),s.pc("click",function(){s.Lc(e);const c=t.$implicit;return s.rc(2).removeLine(c)}),s.cc(13,"clr-icon",19),s.gc(),s.gc(),s.hc(14,"td",20),s.Vc(15),s.sc(16,"localeCurrency"),s.gc(),s.gc()}if(2&e){const e=t.$implicit,c=s.rc(2);s.Qb(2),s.yc("src",e.preview+"?preset=tiny",s.Nc),s.Qb(2),s.Wc(e.name),s.Qb(2),s.Wc(e.sku),s.Qb(2),s.Xc(" ",s.uc(9,6,e.unitPriceWithTax,c.currencyCode)," "),s.Qb(3),s.yc("ngModel",e.quantity),s.Qb(4),s.Xc(" ",s.uc(16,9,e.unitPriceWithTax*e.quantity,c.currencyCode)," ")}}function yc(e,t){if(1&e&&(s.hc(0,"table",6),s.hc(1,"thead"),s.hc(2,"tr"),s.cc(3,"th"),s.hc(4,"th"),s.Vc(5),s.sc(6,"translate"),s.gc(),s.hc(7,"th"),s.Vc(8),s.sc(9,"translate"),s.gc(),s.hc(10,"th"),s.Vc(11),s.sc(12,"translate"),s.gc(),s.hc(13,"th"),s.Vc(14),s.sc(15,"translate"),s.gc(),s.hc(16,"th"),s.Vc(17),s.sc(18,"translate"),s.gc(),s.gc(),s.gc(),s.Tc(19,fc,17,12,"tr",7),s.hc(20,"tr",8),s.hc(21,"td",9),s.Vc(22),s.sc(23,"translate"),s.gc(),s.cc(24,"td"),s.cc(25,"td"),s.cc(26,"td"),s.cc(27,"td"),s.hc(28,"td"),s.Vc(29),s.sc(30,"localeCurrency"),s.gc(),s.gc(),s.gc()),2&e){const e=s.rc();s.Qb(5),s.Wc(s.tc(6,8,"order.product-name")),s.Qb(3),s.Wc(s.tc(9,10,"order.product-sku")),s.Qb(3),s.Wc(s.tc(12,12,"order.unit-price")),s.Qb(3),s.Wc(s.tc(15,14,"order.quantity")),s.Qb(3),s.Wc(s.tc(18,16,"order.total")),s.Qb(2),s.yc("ngForOf",e.lines),s.Qb(3),s.Wc(s.tc(23,18,"order.sub-total")),s.Qb(7),s.Wc(s.uc(30,20,e.subTotal,e.currencyCode))}}function vc(e,t){1&e&&(s.hc(0,"div",21),s.hc(1,"div",22),s.Vc(2),s.sc(3,"translate"),s.gc(),s.cc(4,"clr-icon",23),s.gc()),2&e&&(s.Qb(2),s.Wc(s.tc(3,1,"settings.add-products-to-test-order")))}class Cc{constructor(e,t){this.dataService=e,this.localStorageService=t,this.orderLinesChange=new s.t,this.lines=[]}get subTotal(){return this.lines.reduce((e,t)=>e+t.unitPriceWithTax*t.quantity,0)}ngOnInit(){this.lines=this.loadFromLocalStorage(),this.lines&&this.orderLinesChange.emit(this.lines),this.dataService.settings.getActiveChannel("cache-first").single$.subscribe(e=>{this.currencyCode=e.activeChannel.currencyCode})}selectResult(e){e&&this.addToLines(e)}addToLines(e){var t,c;this.lines.find(t=>t.id===e.productVariantId)||(this.lines.push({id:e.productVariantId,name:e.productVariantName,preview:null!==(c=null===(t=e.productAsset)||void 0===t?void 0:t.preview)&&void 0!==c?c:"",quantity:1,sku:e.sku,unitPriceWithTax:"SinglePrice"===e.priceWithTax.__typename&&e.priceWithTax.value||0}),this.persistToLocalStorage(),this.orderLinesChange.emit(this.lines))}updateQuantity(){this.persistToLocalStorage(),this.orderLinesChange.emit(this.lines)}removeLine(e){this.lines=this.lines.filter(t=>t.id!==e.id),this.persistToLocalStorage(),this.orderLinesChange.emit(this.lines)}persistToLocalStorage(){this.localStorageService.setForCurrentLocation("shippingTestOrder",this.lines)}loadFromLocalStorage(){return this.localStorageService.getForCurrentLocation("shippingTestOrder")||[]}}function Oc(e,t){if(1&e&&(s.hc(0,"option",9),s.Vc(1),s.gc()),2&e){const e=t.$implicit;s.yc("value",e.code),s.Qb(1),s.Xc(" ",e.name," ")}}Cc.\u0275fac=function(e){return new(e||Cc)(s.bc(n.s),s.bc(n.D))},Cc.\u0275cmp=s.Vb({type:Cc,selectors:[["vdr-test-order-builder"]],outputs:{orderLinesChange:"orderLinesChange"},decls:9,vars:5,consts:[[1,"card"],[1,"card-header"],["class","order-table table",4,"ngIf","ngIfElse"],["emptyPlaceholder",""],[1,"card-block"],[3,"productSelected"],[1,"order-table","table"],["class","order-line",4,"ngFor","ngForOf"],[1,"sub-total"],[1,"left"],[1,"order-line"],[1,"align-middle","thumb"],[3,"src"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","unit-price"],[1,"align-middle","quantity"],["type","number","max","9999","min","1",3,"ngModel","ngModelChange","change"],[1,"icon-button",3,"click"],["shape","trash"],[1,"align-middle","total"],[1,"card-block","empty-placeholder"],[1,"empty-text"],["shape","arrow","dir","down","size","96"]],template:function(e,t){if(1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.Vc(2),s.sc(3,"translate"),s.gc(),s.Tc(4,yc,31,23,"table",2),s.Tc(5,vc,5,3,"ng-template",null,3,s.Uc),s.hc(7,"div",4),s.hc(8,"vdr-product-selector",5),s.pc("productSelected",function(e){return t.selectResult(e)}),s.gc(),s.gc(),s.gc()),2&e){const e=s.Ic(6);s.Qb(2),s.Xc(" ",s.tc(3,3,"settings.test-order")," "),s.Qb(2),s.yc("ngIf",t.lines.length)("ngIfElse",e)}},directives:[l.o,gc.a,l.n,d.a,u.v,u.b,u.p,u.s,b.o,pc.b],pipes:[g.d,ac.a],styles:[".empty-placeholder[_ngcontent-%COMP%]{color:var(--color-grey-400);text-align:center}.empty-text[_ngcontent-%COMP%]{font-size:22px}"],changeDetection:0});class Qc{constructor(e,t,c){this.formBuilder=e,this.dataService=t,this.localStorageService=c,this.addressChange=new s.t}ngOnInit(){this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(e=>e.countries.items);const e=this.localStorageService.getForCurrentLocation("shippingTestAddress"),t=e||{city:"",countryCode:"",postalCode:"",province:""};this.addressChange.emit(t),this.form=this.formBuilder.group(t),this.subscription=this.form.valueChanges.subscribe(e=>{this.localStorageService.setForCurrentLocation("shippingTestAddress",e),this.addressChange.emit(e)})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}function kc(e,t){1&e&&s.cc(0,"clr-icon",14)}function Fc(e,t){1&e&&s.cc(0,"clr-icon",15)}function Sc(e,t){1&e&&s.cc(0,"clr-icon",16)}function Ic(e,t){if(1&e&&(s.hc(0,"vdr-labeled-data",4),s.sc(1,"translate"),s.Vc(2),s.sc(3,"localeCurrency"),s.gc()),2&e){const e=s.rc();s.yc("label",s.tc(1,2,"common.price")),s.Qb(2),s.Xc(" ",s.uc(3,4,null==e.testResult.quote?null:e.testResult.quote.price,e.currencyCode)," ")}}function Tc(e,t){if(1&e&&(s.hc(0,"vdr-labeled-data",4),s.sc(1,"translate"),s.Vc(2),s.sc(3,"localeCurrency"),s.gc()),2&e){const e=s.rc();s.yc("label",s.tc(1,2,"common.price-with-tax")),s.Qb(2),s.Xc(" ",s.uc(3,4,null==e.testResult.quote?null:e.testResult.quote.priceWithTax,e.currencyCode)," ")}}function Pc(e,t){if(1&e&&s.cc(0,"vdr-object-tree",17),2&e){const e=s.rc();s.yc("value",null==e.testResult||null==e.testResult.quote?null:e.testResult.quote.metadata)}}Qc.\u0275fac=function(e){return new(e||Qc)(s.bc(u.e),s.bc(n.s),s.bc(n.D))},Qc.\u0275cmp=s.Vb({type:Qc,selectors:[["vdr-test-address-form"]],outputs:{addressChange:"addressChange"},decls:28,vars:19,consts:[[1,"card"],[1,"card-header"],[1,"card-block"],[3,"formGroup"],["formControlName","city","type","text","clrInput",""],["formControlName","province","type","text","clrInput",""],["formControlName","postalCode","type","text","clrInput",""],["name","countryCode","formControlName","countryCode","clrInput","","clrSelect",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.Vc(2),s.sc(3,"translate"),s.gc(),s.hc(4,"div",2),s.hc(5,"form",3),s.hc(6,"clr-input-container"),s.hc(7,"label"),s.Vc(8),s.sc(9,"translate"),s.gc(),s.cc(10,"input",4),s.gc(),s.hc(11,"clr-input-container"),s.hc(12,"label"),s.Vc(13),s.sc(14,"translate"),s.gc(),s.cc(15,"input",5),s.gc(),s.hc(16,"clr-input-container"),s.hc(17,"label"),s.Vc(18),s.sc(19,"translate"),s.gc(),s.cc(20,"input",6),s.gc(),s.hc(21,"clr-input-container"),s.hc(22,"label"),s.Vc(23),s.sc(24,"translate"),s.gc(),s.hc(25,"select",7),s.Tc(26,Oc,2,2,"option",8),s.sc(27,"async"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()),2&e&&(s.Qb(2),s.Xc(" ",s.tc(3,7,"settings.test-address")," "),s.Qb(3),s.yc("formGroup",t.form),s.Qb(3),s.Wc(s.tc(9,9,"customer.city")),s.Qb(5),s.Wc(s.tc(14,11,"customer.province")),s.Qb(5),s.Wc(s.tc(19,13,"customer.postal-code")),s.Qb(5),s.Wc(s.tc(24,15,"customer.country")),s.Qb(3),s.yc("ngForOf",s.tc(27,17,t.availableCountries$)))},directives:[u.E,u.q,u.j,b.t,b.u,d.a,u.b,u.p,u.h,b.s,u.A,b.A,l.n,u.u,u.D],pipes:[g.d,l.b],styles:["clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}"],changeDetection:0});const Dc=function(e,t,c){return{success:e,error:t,unknown:c}};class jc{constructor(){this.okToRun=!1,this.testDataUpdated=!1,this.runTest=new s.t}}function Vc(e,t){if(1&e){const e=s.ic();s.hc(0,"button",8),s.pc("click",function(){s.Lc(e);return s.rc().create()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc();s.yc("disabled",e.detailForm.pristine||e.detailForm.invalid||!e.selectedChecker||!e.selectedCalculator),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.create")," ")}}function wc(e,t){if(1&e){const e=s.ic();s.hc(0,"button",8),s.pc("click",function(){s.Lc(e);return s.rc(2).save()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc(2);s.yc("disabled",e.detailForm.pristine||e.detailForm.invalid||!e.selectedChecker||!e.selectedCalculator),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.update")," ")}}function xc(e,t){if(1&e&&s.Tc(0,wc,3,4,"button",9),2&e){const e=s.rc();s.yc("vdrIfPermissions",e.updatePermission)}}function Lc(e,t){if(1&e&&(s.hc(0,"option",26),s.Vc(1),s.gc()),2&e){const e=t.$implicit;s.yc("value",e.code),s.Qb(1),s.Yc(" ",e.code,": ",e.description," ")}}function Mc(e,t){if(1&e&&s.cc(0,"vdr-custom-field-control",30),2&e){const e=s.rc().$implicit,t=s.rc(3);s.yc("customFieldsFormGroup",t.detailForm.get("customFields"))("customField",e)}}function $c(e,t){if(1&e&&(s.fc(0),s.Tc(1,Mc,1,2,"vdr-custom-field-control",29),s.ec()),2&e){const e=t.$implicit,c=s.rc(3);s.Qb(1),s.yc("ngIf",c.customFieldIsSet(e.name))}}function Ac(e,t){if(1&e&&(s.hc(0,"section",27),s.hc(1,"label"),s.Vc(2),s.sc(3,"translate"),s.gc(),s.Tc(4,$c,2,1,"ng-container",28),s.gc()),2&e){const e=s.rc(2);s.Qb(2),s.Wc(s.tc(3,2,"common.custom-fields")),s.Qb(2),s.yc("ngForOf",e.customFields)}}function Nc(e,t){if(1&e){const e=s.ic();s.hc(0,"vdr-configurable-input",31),s.pc("remove",function(){s.Lc(e);return s.rc(2).selectedChecker=null}),s.sc(1,"hasPermission"),s.gc()}if(2&e){const e=s.rc(2);s.yc("operation",e.selectedChecker)("operationDefinition",e.selectedCheckerDefinition)("readonly",!s.tc(1,3,e.updatePermission))}}function Rc(e,t){if(1&e){const e=s.ic();s.hc(0,"button",36),s.pc("click",function(){s.Lc(e);const c=t.$implicit;return s.rc(3).selectChecker(c)}),s.Vc(1),s.gc()}if(2&e){const e=t.$implicit;s.Qb(1),s.Xc(" ",e.description," ")}}function zc(e,t){if(1&e&&(s.hc(0,"div"),s.hc(1,"vdr-dropdown"),s.hc(2,"button",32),s.cc(3,"clr-icon",33),s.Vc(4),s.sc(5,"translate"),s.gc(),s.hc(6,"vdr-dropdown-menu",34),s.Tc(7,Rc,2,1,"button",35),s.gc(),s.gc(),s.gc()),2&e){const e=s.rc(2);s.Qb(4),s.Xc(" ",s.tc(5,2,"common.select")," "),s.Qb(3),s.yc("ngForOf",e.checkers)}}function Wc(e,t){if(1&e){const e=s.ic();s.hc(0,"vdr-configurable-input",37),s.pc("remove",function(){s.Lc(e);return s.rc(2).selectedCalculator=null}),s.sc(1,"hasPermission"),s.gc()}if(2&e){const e=s.rc(2);s.yc("operation",e.selectedCalculator)("operationDefinition",e.selectedCalculatorDefinition)("readonly",!s.tc(1,3,e.updatePermission))}}function Xc(e,t){if(1&e){const e=s.ic();s.hc(0,"button",36),s.pc("click",function(){s.Lc(e);const c=t.$implicit;return s.rc(3).selectCalculator(c)}),s.Vc(1),s.gc()}if(2&e){const e=t.$implicit;s.Qb(1),s.Xc(" ",e.description," ")}}function Gc(e,t){if(1&e&&(s.hc(0,"div"),s.hc(1,"vdr-dropdown"),s.hc(2,"button",32),s.cc(3,"clr-icon",33),s.Vc(4),s.sc(5,"translate"),s.gc(),s.hc(6,"vdr-dropdown-menu",34),s.Tc(7,Xc,2,1,"button",35),s.gc(),s.gc(),s.gc()),2&e){const e=s.rc(2);s.Qb(4),s.Xc(" ",s.tc(5,2,"common.select")," "),s.Qb(3),s.yc("ngForOf",e.calculators)}}function Ec(e,t){if(1&e){const e=s.ic();s.hc(0,"form",10),s.hc(1,"vdr-form-field",11),s.sc(2,"translate"),s.hc(3,"input",12),s.pc("input",function(c){s.Lc(e);const n=t.ngIf;return s.rc().updateCode(n.code,c.target.value)}),s.sc(4,"hasPermission"),s.gc(),s.gc(),s.hc(5,"vdr-form-field",13),s.sc(6,"translate"),s.sc(7,"hasPermission"),s.cc(8,"input",14),s.sc(9,"hasPermission"),s.gc(),s.cc(10,"vdr-rich-text-editor",15),s.sc(11,"hasPermission"),s.sc(12,"translate"),s.hc(13,"vdr-form-field",16),s.sc(14,"translate"),s.hc(15,"select",17),s.sc(16,"hasPermission"),s.Tc(17,Lc,2,3,"option",18),s.gc(),s.gc(),s.Tc(18,Ac,5,4,"section",19),s.hc(19,"div",20),s.hc(20,"div",21),s.hc(21,"label",22),s.Vc(22),s.sc(23,"translate"),s.gc(),s.Tc(24,Nc,2,5,"vdr-configurable-input",23),s.Tc(25,zc,8,4,"div",24),s.gc(),s.hc(26,"div",21),s.hc(27,"label",22),s.Vc(28),s.sc(29,"translate"),s.gc(),s.Tc(30,Wc,2,5,"vdr-configurable-input",25),s.Tc(31,Gc,8,4,"div",24),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.rc();s.yc("formGroup",e.detailForm),s.Qb(1),s.yc("label",s.tc(2,18,"common.name")),s.Qb(2),s.yc("readonly",!s.tc(4,20,e.updatePermission)),s.Qb(2),s.yc("label",s.tc(6,22,"common.code"))("readOnlyToggle",s.tc(7,24,e.updatePermission)),s.Qb(3),s.yc("readonly",!s.tc(9,26,e.updatePermission)),s.Qb(2),s.yc("readonly",!s.tc(11,28,e.updatePermission))("label",s.tc(12,30,"common.description")),s.Qb(3),s.yc("label",s.tc(14,32,"settings.fulfillment-handler")),s.Qb(2),s.yc("vdrDisabled",!s.tc(16,34,e.updatePermission)),s.Qb(2),s.yc("ngForOf",e.fulfillmentHandlers),s.Qb(1),s.yc("ngIf",e.customFields.length),s.Qb(4),s.Wc(s.tc(23,36,"settings.shipping-eligibility-checker")),s.Qb(2),s.yc("ngIf",e.selectedChecker&&e.selectedCheckerDefinition),s.Qb(1),s.yc("ngIf",!e.selectedChecker||!e.selectedCheckerDefinition),s.Qb(3),s.Wc(s.tc(29,38,"settings.shipping-calculator")),s.Qb(2),s.yc("ngIf",e.selectedCalculator&&e.selectedCalculatorDefinition),s.Qb(1),s.yc("ngIf",!e.selectedCalculator||!e.selectedCalculatorDefinition)}}function Uc(e,t){if(1&e){const e=s.ic();s.hc(0,"clr-accordion-content"),s.hc(1,"div",38),s.hc(2,"div",21),s.hc(3,"vdr-test-order-builder",39),s.pc("orderLinesChange",function(t){s.Lc(e);return s.rc().setTestOrderLines(t)}),s.gc(),s.gc(),s.hc(4,"div",21),s.hc(5,"vdr-test-address-form",40),s.pc("addressChange",function(t){s.Lc(e);return s.rc().setTestAddress(t)}),s.gc(),s.hc(6,"vdr-shipping-method-test-result",41),s.pc("runTest",function(){s.Lc(e);return s.rc().runTest()}),s.sc(7,"async"),s.sc(8,"async"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.rc();let t=null;s.Qb(6),s.yc("currencyCode",null==(t=s.tc(7,4,e.activeChannel$))?null:t.currencyCode)("okToRun",e.allTestDataPresent()&&e.testDataUpdated&&e.detailForm.valid)("testDataUpdated",e.testDataUpdated)("testResult",s.tc(8,6,e.testResult$))}}jc.\u0275fac=function(e){return new(e||jc)},jc.\u0275cmp=s.Vb({type:jc,selectors:[["vdr-shipping-method-test-result"]],inputs:{testResult:"testResult",okToRun:"okToRun",testDataUpdated:"testDataUpdated",currencyCode:"currencyCode"},outputs:{runTest:"runTest"},decls:21,vars:24,consts:[[1,"test-result","card",3,"ngClass"],[1,"card-header"],[1,"card-block"],[1,"result-details"],[3,"label"],[1,"eligible-icon"],["shape","success-standard","class","is-solid success",4,"ngIf"],["shape","ban","class","is-solid error",4,"ngIf"],["shape","unknown-status",4,"ngIf"],[1,"price-row"],[3,"label",4,"ngIf"],[3,"value",4,"ngIf"],[1,"card-footer"],[1,"btn","btn-secondary",3,"disabled","click"],["shape","success-standard",1,"is-solid","success"],["shape","ban",1,"is-solid","error"],["shape","unknown-status"],[3,"value"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.Vc(2),s.sc(3,"translate"),s.gc(),s.hc(4,"div",2),s.hc(5,"div",3),s.hc(6,"vdr-labeled-data",4),s.sc(7,"translate"),s.hc(8,"div",5),s.Tc(9,kc,1,0,"clr-icon",6),s.Tc(10,Fc,1,0,"clr-icon",7),s.Tc(11,Sc,1,0,"clr-icon",8),s.gc(),s.Vc(12),s.gc(),s.hc(13,"div",9),s.Tc(14,Ic,4,7,"vdr-labeled-data",10),s.Tc(15,Tc,4,7,"vdr-labeled-data",10),s.gc(),s.Tc(16,Pc,1,1,"vdr-object-tree",11),s.gc(),s.gc(),s.hc(17,"div",12),s.hc(18,"button",13),s.pc("click",function(){return t.runTest.emit()}),s.Vc(19),s.sc(20,"translate"),s.gc(),s.gc(),s.gc()),2&e&&(s.yc("ngClass",s.Ec(20,Dc,!0===(null==t.testResult?null:t.testResult.eligible),!1===(null==t.testResult?null:t.testResult.eligible),!t.testResult)),s.Qb(2),s.Xc(" ",s.tc(3,14,"settings.test-result")," "),s.Qb(3),s.Tb("stale",t.testDataUpdated),s.Qb(1),s.yc("label",s.tc(7,16,"settings.eligible")),s.Qb(3),s.yc("ngIf",null==t.testResult?null:t.testResult.eligible),s.Qb(1),s.yc("ngIf",!1===(null==t.testResult?null:t.testResult.eligible)),s.Qb(1),s.yc("ngIf",!t.testResult),s.Qb(1),s.Xc(" ",null==t.testResult?null:t.testResult.eligible," "),s.Qb(2),s.yc("ngIf",null!=(null==t.testResult||null==t.testResult.quote?null:t.testResult.quote.price)),s.Qb(1),s.yc("ngIf",null!=(null==t.testResult||null==t.testResult.quote?null:t.testResult.quote.priceWithTax)),s.Qb(1),s.yc("ngIf",null==t.testResult||null==t.testResult.quote?null:t.testResult.quote.metadata),s.Qb(2),s.yc("disabled",!t.okToRun),s.Qb(1),s.Xc(" ",s.tc(20,18,"settings.test-shipping-method")," "))},directives:[l.m,sc.a,l.o,b.o,rc.a],pipes:[g.d,ac.a],styles:[".test-result.success[_ngcontent-%COMP%]   .card-block[_ngcontent-%COMP%]{background-color:var(--color-success-100)}.test-result.error[_ngcontent-%COMP%]   .card-block[_ngcontent-%COMP%]{background-color:var(--color-error-100)}.test-result.unknown[_ngcontent-%COMP%]   .card-block[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}.result-details[_ngcontent-%COMP%]{transition:opacity .2s}.result-details.stale[_ngcontent-%COMP%]{opacity:.5}.eligible-icon[_ngcontent-%COMP%]{display:inline-block}.eligible-icon[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{color:var(--color-success-500)}.eligible-icon[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:var(--color-error-500)}.price-row[_ngcontent-%COMP%]{display:flex}.price-row[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child){margin-left:24px}"],changeDetection:0});class _c extends n.l{constructor(e,t,c,i,s,r,a){super(t,e,c,s),this.changeDetector=i,this.dataService=s,this.formBuilder=r,this.notificationService=a,this.checkers=[],this.calculators=[],this.fulfillmentHandlers=[],this.testDataUpdated=!1,this.updatePermission=[n.H.UpdateSettings,n.H.UpdateShippingMethod],this.fetchTestResult$=new we.a,this.customFields=this.getCustomFieldConfig("ShippingMethod"),this.detailForm=this.formBuilder.group({code:["",u.C.required],name:["",u.C.required],description:"",fulfillmentHandler:["",u.C.required],checker:{},calculator:{},customFields:this.formBuilder.group(this.customFields.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:""}),{}))})}ngOnInit(){this.init(),Object(We.a)([this.dataService.shippingMethod.getShippingMethodOperations().single$,this.entity$.pipe(Object(w.a)(1))]).subscribe(([e,t])=>{this.checkers=e.shippingEligibilityCheckers,this.calculators=e.shippingCalculators,this.fulfillmentHandlers=e.fulfillmentHandlers,this.changeDetector.markForCheck(),this.selectedCheckerDefinition=e.shippingEligibilityCheckers.find(e=>e.code===(t.checker&&t.checker.code)),this.selectedCalculatorDefinition=e.shippingCalculators.find(e=>e.code===(t.calculator&&t.calculator.code))}),this.activeChannel$=this.dataService.settings.getActiveChannel().mapStream(e=>e.activeChannel),this.testResult$=this.fetchTestResult$.pipe(Object(se.a)(([e,t])=>{if(!this.selectedChecker||!this.selectedCalculator)return Object(mc.a)(void 0);const c=this.detailForm.value,i={shippingAddress:Object.assign(Object.assign({},e),{streetLine1:"test"}),lines:t.map(e=>({productVariantId:e.id,quantity:e.quantity})),checker:Object(n.Z)(this.selectedChecker,c.checker),calculator:Object(n.Z)(this.selectedCalculator,c.calculator)};return this.dataService.shippingMethod.testShippingMethod(i).mapSingle(e=>e.testShippingMethod)})),Object(hc.a)(this.detailForm.get(["checker"]).valueChanges,this.detailForm.get(["calculator"]).valueChanges).pipe(Object(bc.a)(this.destroy$)).subscribe(()=>this.testDataUpdated=!0)}ngOnDestroy(){this.destroy()}customFieldIsSet(e){return!!this.detailForm.get(["customFields",e])}updateCode(e,t){if(!e){const e=this.detailForm.get(["code"]);e&&e.pristine&&e.setValue(Object(mt.normalizeString)(t,"-"))}}selectChecker(e){this.selectedCheckerDefinition=e,this.selectedChecker=Object(n.M)(e);const t=this.detailForm.get("checker");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedChecker)),this.detailForm.markAsDirty()}selectCalculator(e){this.selectedCalculatorDefinition=e,this.selectedCalculator=Object(n.M)(e);const t=this.detailForm.get("calculator");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedCalculator)),this.detailForm.markAsDirty()}create(){const e=this.selectedChecker,t=this.selectedCalculator;e&&t&&Object(We.a)([this.entity$,this.languageCode$]).pipe(Object(w.a)(1),Object(x.a)(([c,i])=>{const s=this.detailForm.value,r=Object.assign(Object.assign({},this.getUpdatedShippingMethod(c,this.detailForm,i)),{checker:Object(n.Z)(e,s.checker),calculator:Object(n.Z)(t,s.calculator)});return this.dataService.shippingMethod.createShippingMethod(r)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-create-success"),{entity:"ShippingMethod"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",e.createShippingMethod.id],{relativeTo:this.route})},e=>{this.notificationService.error(Object(j.a)("common.notify-create-error"),{entity:"ShippingMethod"})})}save(){const e=this.selectedChecker,t=this.selectedCalculator;e&&t&&Object(We.a)([this.entity$,this.languageCode$]).pipe(Object(w.a)(1),Object(x.a)(([c,i])=>{const s=this.detailForm.value,r=Object.assign(Object.assign({},this.getUpdatedShippingMethod(c,this.detailForm,i)),{checker:Object(n.Z)(e,s.checker),calculator:Object(n.Z)(t,s.calculator)});return this.dataService.shippingMethod.updateShippingMethod(r)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"ShippingMethod"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},e=>{this.notificationService.error(Object(j.a)("common.notify-update-error"),{entity:"ShippingMethod"})})}setTestOrderLines(e){this.testOrderLines=e,this.testDataUpdated=!0}setTestAddress(e){this.testAddress=e,this.testDataUpdated=!0}allTestDataPresent(){return!!(this.testAddress&&this.testOrderLines&&this.testOrderLines.length&&this.selectedChecker&&this.selectedCalculator)}runTest(){this.fetchTestResult$.next([this.testAddress,this.testOrderLines]),this.testDataUpdated=!1}getUpdatedShippingMethod(e,t,c){const i=t.value,s=Object(n.P)({translatable:e,updatedFields:i,customFieldConfig:this.customFields,languageCode:c,defaultTranslation:{languageCode:c,name:e.name||"",description:e.description||""}});return Object.assign(Object.assign({},s),{fulfillmentHandler:i.fulfillmentHandler})}setFormValues(e,t){var c,i,s,r;const a=Object(n.S)(e,t);if(this.detailForm.patchValue({name:null!==(c=null==a?void 0:a.name)&&void 0!==c?c:"",description:null!==(i=null==a?void 0:a.description)&&void 0!==i?i:"",code:e.code,fulfillmentHandler:e.fulfillmentHandlerCode,checker:e.checker||{},calculator:e.calculator||{}}),this.selectedChecker||(this.selectedChecker=e.checker&&{code:e.checker.code,args:e.checker.args.map(e=>Object.assign(Object.assign({},e),{value:Object(n.V)(e.value)}))}),this.selectedCalculator||(this.selectedCalculator=e.calculator&&{code:null===(s=e.calculator)||void 0===s?void 0:s.code,args:null===(r=e.calculator)||void 0===r?void 0:r.args.map(e=>Object.assign(Object.assign({},e),{value:Object(n.V)(e.value)}))}),this.customFields.length){const t=this.detailForm.get("customFields");for(const c of this.customFields){const n=c.name,i="localeString"===c.type?a.customFields[n]:e.customFields[n],s=t.get(n);s&&s.patchValue(i)}}}}_c.\u0275fac=function(e){return new(e||_c)(s.bc(L.e),s.bc(L.a),s.bc(n.I),s.bc(s.j),s.bc(n.s),s.bc(u.e),s.bc(n.G))},_c.\u0275cmp=s.Vb({type:_c,selectors:[["vdr-shipping-method-detail"]],features:[s.Nb],decls:23,vars:22,consts:[[3,"entity"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","shipping-method-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup",4,"ngIf"],[1,"testing-tool"],[4,"clrIfExpanded"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","code",3,"label","readOnlyToggle"],["id","code","type","text","formControlName","code",3,"readonly"],["formControlName","description",3,"readonly","label"],["for","fulfillmentHandler",1,"mb2",3,"label"],["name","fulfillmentHandler","formControlName","fulfillmentHandler",3,"vdrDisabled"],[3,"value",4,"ngFor","ngForOf"],["formGroupName","customFields",4,"ngIf"],[1,"clr-row","mt4"],[1,"clr-col"],[1,"clr-control-label"],["formControlName","checker",3,"operation","operationDefinition","readonly","remove",4,"ngIf"],[4,"ngIf"],["formControlName","calculator",3,"operation","operationDefinition","readonly","remove",4,"ngIf"],[3,"value"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","ShippingMethod",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","ShippingMethod",3,"customFieldsFormGroup","customField"],["formControlName","checker",3,"operation","operationDefinition","readonly","remove"],["vdrDropdownTrigger","",1,"btn","btn-outline"],["shape","plus"],["vdrPosition","bottom-left"],["type","button","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["type","button","vdrDropdownItem","",3,"click"],["formControlName","calculator",3,"operation","operationDefinition","readonly","remove"],[1,"clr-row"],[3,"orderLinesChange"],[3,"addressChange"],[3,"currencyCode","okToRun","testDataUpdated","testResult","runTest"]],template:function(e,t){if(1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.cc(2,"vdr-entity-info",0),s.sc(3,"async"),s.hc(4,"vdr-language-selector",1),s.pc("languageCodeChange",function(e){return t.setLanguage(e)}),s.sc(5,"async"),s.sc(6,"async"),s.sc(7,"async"),s.gc(),s.gc(),s.hc(8,"vdr-ab-right"),s.cc(9,"vdr-action-bar-items",2),s.Tc(10,Vc,3,4,"button",3),s.sc(11,"async"),s.Tc(12,xc,1,1,"ng-template",null,4,s.Uc),s.gc(),s.gc(),s.Tc(14,Ec,32,40,"form",5),s.sc(15,"async"),s.hc(16,"div",6),s.hc(17,"clr-accordion"),s.hc(18,"clr-accordion-panel"),s.hc(19,"clr-accordion-title"),s.Vc(20),s.sc(21,"translate"),s.gc(),s.Tc(22,Uc,9,8,"clr-accordion-content",7),s.gc(),s.gc(),s.gc()),2&e){const e=s.Ic(13);s.Qb(2),s.yc("entity",s.tc(3,8,t.entity$)),s.Qb(2),s.yc("disabled",s.tc(5,10,t.isNew$))("availableLanguageCodes",s.tc(6,12,t.availableLanguages$))("currentLanguageCode",s.tc(7,14,t.languageCode$)),s.Qb(6),s.yc("ngIf",s.tc(11,16,t.isNew$))("ngIfElse",e),s.Qb(4),s.yc("ngIf",s.tc(15,18,t.entity$)),s.Qb(6),s.Wc(s.tc(21,20,"settings.test-shipping-method"))}},directives:[M.a,M.b,$.a,Xe.a,M.c,A.a,l.o,b.b,b.O,b.d,b.N,b.e,b.Q,b.q,U.a,u.E,u.q,u.j,N.a,d.a,u.b,u.p,u.h,ht.a,u.A,pe.a,l.n,b.u,u.u,u.D,u.k,_.a,bt.a,ae.a,oe.a,b.o,le.a,de.a,b.c,Cc,Qc,jc],pipes:[l.b,g.d,p.a],styles:[".testing-tool[_ngcontent-%COMP%]{margin-top:48px;margin-bottom:128px}.testing-tool[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:12px}"],changeDetection:0});const Zc=function(){return["./create"]};function Bc(e,t){1&e&&(s.hc(0,"a",5),s.cc(1,"clr-icon",6),s.Vc(2),s.sc(3,"translate"),s.gc()),2&e&&(s.yc("routerLink",s.Bc(4,Zc)),s.Qb(2),s.Xc(" ",s.tc(3,2,"settings.create-new-shipping-method")," "))}const qc=function(e){return["./",e]},Hc=function(){return["DeleteSettings","DeleteShippingMethod"]};function Kc(e,t){if(1&e){const e=s.ic();s.hc(0,"td",7),s.Vc(1),s.gc(),s.hc(2,"td",7),s.Vc(3),s.gc(),s.hc(4,"td",8),s.cc(5,"vdr-table-row-action",9),s.sc(6,"translate"),s.gc(),s.hc(7,"td",8),s.hc(8,"vdr-dropdown"),s.hc(9,"button",10),s.Vc(10),s.sc(11,"translate"),s.cc(12,"clr-icon",11),s.gc(),s.hc(13,"vdr-dropdown-menu",12),s.hc(14,"button",13),s.pc("click",function(){s.Lc(e);const c=t.item;return s.rc().deleteShippingMethod(c.id)}),s.sc(15,"hasPermission"),s.cc(16,"clr-icon",14),s.Vc(17),s.sc(18,"translate"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.item;s.Qb(1),s.Wc(e.code),s.Qb(2),s.Wc(e.name),s.Qb(2),s.yc("label",s.tc(6,7,"common.edit"))("linkTo",s.Cc(15,qc,e.id)),s.Qb(5),s.Xc(" ",s.tc(11,9,"common.actions")," "),s.Qb(4),s.yc("disabled",!s.tc(15,11,s.Bc(17,Hc))),s.Qb(3),s.Xc(" ",s.tc(18,13,"common.delete")," ")}}function Yc(e,t){if(1&e){const e=s.ic();s.hc(0,"clr-accordion-content"),s.hc(1,"div",15),s.hc(2,"div",16),s.hc(3,"vdr-test-order-builder",17),s.pc("orderLinesChange",function(t){s.Lc(e);return s.rc().setTestOrderLines(t)}),s.gc(),s.gc(),s.hc(4,"div",16),s.hc(5,"vdr-test-address-form",18),s.pc("addressChange",function(t){s.Lc(e);return s.rc().setTestAddress(t)}),s.gc(),s.hc(6,"vdr-shipping-eligibility-test-result",19),s.pc("runTest",function(){s.Lc(e);return s.rc().runTest()}),s.sc(7,"async"),s.sc(8,"async"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.rc();let t=null;s.Qb(6),s.yc("currencyCode",null==(t=s.tc(7,4,e.activeChannel$))?null:t.currencyCode)("okToRun",e.allTestDataPresent())("testDataUpdated",e.testDataUpdated)("testResult",s.tc(8,6,e.testResult$))}}const Jc=function(){return["CreateSettings","CreateShippingMethod"]};class en extends n.n{constructor(e,t,c,n,i){super(n,i),this.modalService=e,this.notificationService=t,this.dataService=c,this.testDataUpdated=!1,this.fetchTestResult$=new we.a,super.setQueryFn((...e)=>this.dataService.shippingMethod.getShippingMethods(...e).refetchOnChannelChange(),e=>e.shippingMethods)}ngOnInit(){super.ngOnInit(),this.testResult$=this.fetchTestResult$.pipe(Object(se.a)(([e,t])=>{const c={shippingAddress:Object.assign(Object.assign({},e),{streetLine1:"test"}),lines:t.map(e=>({productVariantId:e.id,quantity:e.quantity}))};return this.dataService.shippingMethod.testEligibleShippingMethods(c).mapSingle(e=>e.testEligibleShippingMethods)})),this.activeChannel$=this.dataService.settings.getActiveChannel().mapStream(e=>e.activeChannel)}deleteShippingMethod(e){this.modalService.dialog({title:Object(j.a)("catalog.confirm-delete-shipping-method"),buttons:[{type:"secondary",label:Object(j.a)("common.cancel")},{type:"danger",label:Object(j.a)("common.delete"),returnValue:!0}]}).pipe(Object(se.a)(t=>t?this.dataService.shippingMethod.deleteShippingMethod(e):ie.a)).subscribe(()=>{this.notificationService.success(Object(j.a)("common.notify-delete-success"),{entity:"ShippingMethod"}),this.refresh()},e=>{this.notificationService.error(Object(j.a)("common.notify-delete-error"),{entity:"ShippingMethod"})})}setTestOrderLines(e){this.testOrderLines=e,this.testDataUpdated=!0}setTestAddress(e){this.testAddress=e,this.testDataUpdated=!0}allTestDataPresent(){return!!(this.testAddress&&this.testOrderLines&&this.testOrderLines.length)}runTest(){this.fetchTestResult$.next([this.testAddress,this.testOrderLines]),this.testDataUpdated=!1}}function tn(e,t){if(1&e){const e=s.ic();s.hc(0,"button",9),s.pc("click",function(){s.Lc(e);return s.rc().create()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc();s.yc("disabled",!e.saveButtonEnabled()),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.create")," ")}}function cn(e,t){if(1&e){const e=s.ic();s.hc(0,"button",9),s.pc("click",function(){s.Lc(e);return s.rc(2).save()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc(2);s.yc("disabled",!e.saveButtonEnabled()),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.update")," ")}}function nn(e,t){if(1&e&&s.Tc(0,cn,3,4,"button",10),2&e){const e=s.rc();s.yc("vdrIfPermissions",e.updatePermission)}}en.\u0275fac=function(e){return new(e||en)(s.bc(n.F),s.bc(n.G),s.bc(n.s),s.bc(L.e),s.bc(L.a))},en.\u0275cmp=s.Vb({type:en,selectors:[["vdr-shipping-method-list"]],features:[s.Nb],decls:25,vars:23,consts:[["locationId","shipping-method-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"testing-tool"],[4,"clrIfExpanded"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[1,"clr-row"],[1,"clr-col"],[3,"orderLinesChange"],[3,"addressChange"],[3,"currencyCode","okToRun","testDataUpdated","testResult","runTest"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-right"),s.cc(2,"vdr-action-bar-items",0),s.Tc(3,Bc,4,5,"a",1),s.gc(),s.gc(),s.hc(4,"vdr-data-table",2),s.pc("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),s.sc(5,"async"),s.sc(6,"async"),s.sc(7,"async"),s.sc(8,"async"),s.hc(9,"vdr-dt-column"),s.Vc(10),s.sc(11,"translate"),s.gc(),s.hc(12,"vdr-dt-column"),s.Vc(13),s.sc(14,"translate"),s.gc(),s.cc(15,"vdr-dt-column"),s.cc(16,"vdr-dt-column"),s.Tc(17,Kc,19,18,"ng-template"),s.gc(),s.hc(18,"div",3),s.hc(19,"clr-accordion"),s.hc(20,"clr-accordion-panel"),s.hc(21,"clr-accordion-title"),s.Vc(22),s.sc(23,"translate"),s.gc(),s.Tc(24,Yc,9,8,"clr-accordion-content",4),s.gc(),s.gc(),s.gc()),2&e&&(s.Qb(3),s.yc("vdrIfPermissions",s.Bc(22,Jc)),s.Qb(1),s.yc("items",s.tc(5,8,t.items$))("itemsPerPage",s.tc(6,10,t.itemsPerPage$))("totalItems",s.tc(7,12,t.totalItems$))("currentPage",s.tc(8,14,t.currentPage$)),s.Qb(6),s.Wc(s.tc(11,16,"common.code")),s.Qb(3),s.Wc(s.tc(14,18,"common.name")),s.Qb(9),s.Wc(s.tc(23,20,"settings.test-shipping-methods")))},directives:[M.a,M.c,A.a,U.a,m.a,h.a,b.b,b.O,b.d,b.N,b.e,b.Q,b.q,L.h,b.o,re.a,ae.a,oe.a,le.a,de.a,b.c,Cc,Qc,uc],pipes:[l.b,g.d,p.a],styles:[".testing-tool[_ngcontent-%COMP%]{margin-top:48px}"],changeDetection:0});class sn extends n.l{constructor(e,t,c,i,s,r,a){super(t,e,c,s),this.changeDetector=i,this.dataService=s,this.formBuilder=r,this.notificationService=a,this.updatePermission=[n.H.UpdateSettings,n.H.UpdateTaxCategory],this.detailForm=this.formBuilder.group({name:["",u.C.required],isDefault:!1})}ngOnInit(){this.init(),this.taxCategory$=this.entity$}ngOnDestroy(){this.destroy()}saveButtonEnabled(){return this.detailForm.dirty&&this.detailForm.valid}create(){if(!this.detailForm.dirty)return;const e=this.detailForm.value,t={name:e.name,isDefault:e.isDefault};this.dataService.settings.createTaxCategory(t).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-create-success"),{entity:"TaxCategory"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",e.createTaxCategory.id],{relativeTo:this.route})},e=>{this.notificationService.error(Object(j.a)("common.notify-create-error"),{entity:"TaxCategory"})})}save(){if(!this.detailForm.dirty)return;const e=this.detailForm.value;this.taxCategory$.pipe(Object(w.a)(1),Object(x.a)(t=>{const c={id:t.id,name:e.name,isDefault:e.isDefault};return this.dataService.settings.updateTaxCategory(c)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"TaxCategory"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},e=>{this.notificationService.error(Object(j.a)("common.notify-update-error"),{entity:"TaxCategory"})})}setFormValues(e,t){this.detailForm.patchValue({name:e.name,isDefault:e.isDefault})}}sn.\u0275fac=function(e){return new(e||sn)(s.bc(L.e),s.bc(L.a),s.bc(n.I),s.bc(s.j),s.bc(n.s),s.bc(u.e),s.bc(n.G))},sn.\u0275cmp=s.Vb({type:sn,selectors:[["vdr-tax-detail"]],features:[s.Nb],decls:20,vars:20,consts:[[3,"entity"],["locationId","tax-category-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["for","isDefault",3,"label"],["type","checkbox","clrToggle","","id","isDefault","formControlName","isDefault",3,"vdrDisabled"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"]],template:function(e,t){if(1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.cc(2,"vdr-entity-info",0),s.sc(3,"async"),s.gc(),s.hc(4,"vdr-ab-right"),s.cc(5,"vdr-action-bar-items",1),s.Tc(6,tn,3,4,"button",2),s.sc(7,"async"),s.Tc(8,nn,1,1,"ng-template",null,3,s.Uc),s.gc(),s.gc(),s.hc(10,"form",4),s.hc(11,"vdr-form-field",5),s.sc(12,"translate"),s.cc(13,"input",6),s.sc(14,"hasPermission"),s.gc(),s.hc(15,"vdr-form-field",7),s.sc(16,"translate"),s.hc(17,"clr-toggle-wrapper"),s.cc(18,"input",8),s.sc(19,"hasPermission"),s.gc(),s.gc(),s.gc()),2&e){const e=s.Ic(9);s.Qb(2),s.yc("entity",s.tc(3,8,t.entity$)),s.Qb(4),s.yc("ngIf",s.tc(7,10,t.isNew$))("ngIfElse",e),s.Qb(4),s.yc("formGroup",t.detailForm),s.Qb(1),s.yc("label",s.tc(12,12,"common.name")),s.Qb(2),s.yc("readonly",!s.tc(14,14,t.updatePermission)),s.Qb(2),s.yc("label",s.tc(16,16,"common.default-tax-category")),s.Qb(3),s.yc("vdrDisabled",!s.tc(19,18,t.updatePermission))}},directives:[M.a,M.b,$.a,M.c,A.a,l.o,u.E,u.q,u.j,N.a,d.a,u.b,u.p,u.h,b.k,u.a,b.i,pe.a,U.a],pipes:[l.b,g.d,p.a],styles:[""],changeDetection:0});const rn=function(){return["./create"]};function an(e,t){1&e&&(s.hc(0,"a",3),s.cc(1,"clr-icon",4),s.Vc(2),s.sc(3,"translate"),s.gc()),2&e&&(s.yc("routerLink",s.Bc(4,rn)),s.Qb(2),s.Xc(" ",s.tc(3,2,"settings.create-new-tax-category")," "))}function on(e,t){1&e&&(s.hc(0,"vdr-chip"),s.Vc(1),s.sc(2,"translate"),s.gc()),2&e&&(s.Qb(1),s.Wc(s.tc(2,1,"common.default-tax-category")))}const ln=function(e){return["./",e]},dn=function(){return["DeleteSettings","DeleteTaxCategory"]};function un(e,t){if(1&e){const e=s.ic();s.hc(0,"td",5),s.Vc(1),s.gc(),s.hc(2,"td",5),s.Tc(3,on,3,3,"vdr-chip",6),s.gc(),s.hc(4,"td",7),s.cc(5,"vdr-table-row-action",8),s.sc(6,"translate"),s.gc(),s.hc(7,"td",7),s.hc(8,"vdr-dropdown"),s.hc(9,"button",9),s.Vc(10),s.sc(11,"translate"),s.cc(12,"clr-icon",10),s.gc(),s.hc(13,"vdr-dropdown-menu",11),s.hc(14,"button",12),s.pc("click",function(){s.Lc(e);const c=t.item;return s.rc().deleteTaxCategory(c)}),s.sc(15,"hasPermission"),s.cc(16,"clr-icon",13),s.Vc(17),s.sc(18,"translate"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.item;s.Qb(1),s.Wc(e.name),s.Qb(2),s.yc("ngIf",e.isDefault),s.Qb(2),s.yc("label",s.tc(6,7,"common.edit"))("linkTo",s.Cc(15,ln,e.id)),s.Qb(5),s.Xc(" ",s.tc(11,9,"common.actions")," "),s.Qb(4),s.yc("disabled",!s.tc(15,11,s.Bc(17,dn))),s.Qb(3),s.Xc(" ",s.tc(18,13,"common.delete")," ")}}const mn=function(){return["CreateSettings","CreateTaxCategory"]};class hn{constructor(e,t,c){this.dataService=e,this.notificationService=t,this.modalService=c,this.queryResult=this.dataService.settings.getTaxCategories(),this.taxCategories$=this.queryResult.mapStream(e=>e.taxCategories)}deleteTaxCategory(e){return this.modalService.dialog({title:Object(j.a)("settings.confirm-delete-tax-category"),body:e.name,buttons:[{type:"secondary",label:Object(j.a)("common.cancel")},{type:"danger",label:Object(j.a)("common.delete"),returnValue:!0}]}).pipe(Object(se.a)(t=>t?this.dataService.settings.deleteTaxCategory(e.id):ie.a),Object(i.a)(e=>e.deleteTaxCategory)).subscribe(e=>{e.result===n.t.DELETED?(this.notificationService.success(Object(j.a)("common.notify-delete-success"),{entity:"TaxRate"}),this.queryResult.ref.refetch()):this.notificationService.error(e.message||Object(j.a)("common.notify-delete-error"),{entity:"TaxRate"})},e=>{this.notificationService.error(Object(j.a)("common.notify-delete-error"),{entity:"TaxRate"})})}}hn.\u0275fac=function(e){return new(e||hn)(s.bc(n.s),s.bc(n.G),s.bc(n.F))},hn.\u0275cmp=s.Vb({type:hn,selectors:[["vdr-tax-list"]],decls:13,vars:8,consts:[["locationId","tax-category-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[4,"ngIf"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-right"),s.cc(2,"vdr-action-bar-items",0),s.Tc(3,an,4,5,"a",1),s.gc(),s.gc(),s.hc(4,"vdr-data-table",2),s.sc(5,"async"),s.hc(6,"vdr-dt-column"),s.Vc(7),s.sc(8,"translate"),s.gc(),s.cc(9,"vdr-dt-column"),s.cc(10,"vdr-dt-column"),s.cc(11,"vdr-dt-column"),s.Tc(12,un,19,18,"ng-template"),s.gc()),2&e&&(s.Qb(3),s.yc("vdrIfPermissions",s.Bc(7,mn)),s.Qb(1),s.yc("items",s.tc(5,3,t.taxCategories$)),s.Qb(3),s.Wc(s.tc(8,5,"common.name")))},directives:[M.a,M.c,A.a,U.a,m.a,h.a,L.h,b.o,l.o,re.a,ae.a,oe.a,le.a,de.a,Be.a],pipes:[l.b,g.d,p.a],styles:[""],changeDetection:0});var bn=c("VhYM");function gn(e,t){if(1&e){const e=s.ic();s.hc(0,"button",17),s.pc("click",function(){s.Lc(e);return s.rc().create()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc();s.yc("disabled",!e.saveButtonEnabled()),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.create")," ")}}function pn(e,t){if(1&e){const e=s.ic();s.hc(0,"button",17),s.pc("click",function(){s.Lc(e);return s.rc(2).save()}),s.Vc(1),s.sc(2,"translate"),s.gc()}if(2&e){const e=s.rc(2);s.yc("disabled",!e.saveButtonEnabled()),s.Qb(1),s.Xc(" ",s.tc(2,2,"common.update")," ")}}function fn(e,t){if(1&e&&s.Tc(0,pn,3,4,"button",18),2&e){const e=s.rc();s.yc("vdrIfPermissions",e.updatePermission)}}function yn(e,t){if(1&e&&(s.hc(0,"option",19),s.Vc(1),s.gc()),2&e){const e=t.$implicit;s.yc("value",e.id),s.Qb(1),s.Xc(" ",e.name," ")}}function vn(e,t){if(1&e&&(s.hc(0,"option",19),s.Vc(1),s.gc()),2&e){const e=t.$implicit;s.yc("value",e.id),s.Qb(1),s.Wc(e.name)}}class Cn extends n.l{constructor(e,t,c,i,s,r,a){super(t,e,c,s),this.changeDetector=i,this.dataService=s,this.formBuilder=r,this.notificationService=a,this.updatePermission=[n.H.UpdateSettings,n.H.UpdateTaxRate],this.detailForm=this.formBuilder.group({name:["",u.C.required],enabled:[!0],value:[0,u.C.required],taxCategoryId:[""],zoneId:[""],customerGroupId:[""]})}ngOnInit(){this.init(),this.taxCategories$=this.dataService.settings.getTaxCategories().mapSingle(e=>e.taxCategories),this.zones$=this.dataService.settings.getZones().mapSingle(e=>e.zones)}ngOnDestroy(){this.destroy()}saveButtonEnabled(){return this.detailForm.dirty&&this.detailForm.valid}create(){if(!this.detailForm.dirty)return;const e=this.detailForm.value,t={name:e.name,enabled:e.enabled,value:e.value,categoryId:e.taxCategoryId,zoneId:e.zoneId,customerGroupId:e.customerGroupId};this.dataService.settings.createTaxRate(t).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-create-success"),{entity:"TaxRate"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",e.createTaxRate.id],{relativeTo:this.route})},e=>{this.notificationService.error(Object(j.a)("common.notify-create-error"),{entity:"TaxRate"})})}save(){if(!this.detailForm.dirty)return;const e=this.detailForm.value;this.entity$.pipe(Object(w.a)(1),Object(x.a)(t=>{const c={id:t.id,name:e.name,enabled:e.enabled,value:e.value,categoryId:e.taxCategoryId,zoneId:e.zoneId,customerGroupId:e.customerGroupId};return this.dataService.settings.updateTaxRate(c)})).subscribe(e=>{this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"TaxRate"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},e=>{this.notificationService.error(Object(j.a)("common.notify-update-error"),{entity:"TaxRate"})})}setFormValues(e,t){this.detailForm.patchValue({name:e.name,enabled:e.enabled,value:e.value,taxCategoryId:e.category?e.category.id:"",zoneId:e.zone?e.zone.id:"",customerGroupId:e.customerGroup?e.customerGroup.id:""})}}Cn.\u0275fac=function(e){return new(e||Cn)(s.bc(L.e),s.bc(L.a),s.bc(n.I),s.bc(s.j),s.bc(n.s),s.bc(u.e),s.bc(n.G))},Cn.\u0275cmp=s.Vb({type:Cn,selectors:[["vdr-tax-rate-detail"]],features:[s.Nb],decls:37,vars:44,consts:[[3,"entity"],["locationId","tax-rate-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["for","enabled",3,"label"],["type","checkbox","clrToggle","","id","enabled","formControlName","enabled",3,"vdrDisabled"],["for","value",3,"label"],["suffix","%"],["id","value","type","number","step","0.1","formControlName","value",3,"readonly"],["for","taxCategoryId",3,"label"],["clrSelect","","name","taxCategoryId","formControlName","taxCategoryId",3,"vdrDisabled"],[3,"value",4,"ngFor","ngForOf"],["for","zoneId",3,"label"],["clrSelect","","name","zoneId","formControlName","zoneId",3,"vdrDisabled"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"value"]],template:function(e,t){if(1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-left"),s.cc(2,"vdr-entity-info",0),s.sc(3,"async"),s.gc(),s.hc(4,"vdr-ab-right"),s.cc(5,"vdr-action-bar-items",1),s.Tc(6,gn,3,4,"button",2),s.sc(7,"async"),s.Tc(8,fn,1,1,"ng-template",null,3,s.Uc),s.gc(),s.gc(),s.hc(10,"form",4),s.hc(11,"vdr-form-field",5),s.sc(12,"translate"),s.cc(13,"input",6),s.sc(14,"hasPermission"),s.gc(),s.hc(15,"vdr-form-field",7),s.sc(16,"translate"),s.hc(17,"clr-toggle-wrapper"),s.cc(18,"input",8),s.sc(19,"hasPermission"),s.gc(),s.gc(),s.hc(20,"vdr-form-field",9),s.sc(21,"translate"),s.hc(22,"vdr-affixed-input",10),s.cc(23,"input",11),s.sc(24,"hasPermission"),s.gc(),s.gc(),s.hc(25,"vdr-form-field",12),s.sc(26,"translate"),s.hc(27,"select",13),s.sc(28,"hasPermission"),s.Tc(29,yn,2,2,"option",14),s.sc(30,"async"),s.gc(),s.gc(),s.hc(31,"vdr-form-field",15),s.sc(32,"translate"),s.hc(33,"select",16),s.sc(34,"hasPermission"),s.Tc(35,vn,2,2,"option",14),s.sc(36,"async"),s.gc(),s.gc(),s.gc()),2&e){const e=s.Ic(9);s.Qb(2),s.yc("entity",s.tc(3,16,t.entity$)),s.Qb(4),s.yc("ngIf",s.tc(7,18,t.isNew$))("ngIfElse",e),s.Qb(4),s.yc("formGroup",t.detailForm),s.Qb(1),s.yc("label",s.tc(12,20,"common.name")),s.Qb(2),s.yc("readonly",!s.tc(14,22,t.updatePermission)),s.Qb(2),s.yc("label",s.tc(16,24,"common.enabled")),s.Qb(3),s.yc("vdrDisabled",!s.tc(19,26,t.updatePermission)),s.Qb(2),s.yc("label",s.tc(21,28,"settings.rate")),s.Qb(3),s.yc("readonly",!s.tc(24,30,t.updatePermission)),s.Qb(2),s.yc("label",s.tc(26,32,"settings.tax-category")),s.Qb(2),s.yc("vdrDisabled",!s.tc(28,34,t.updatePermission)),s.Qb(2),s.yc("ngForOf",s.tc(30,36,t.taxCategories$)),s.Qb(2),s.yc("label",s.tc(32,38,"settings.zone")),s.Qb(2),s.yc("vdrDisabled",!s.tc(34,40,t.updatePermission)),s.Qb(2),s.yc("ngForOf",s.tc(36,42,t.zones$))}},directives:[M.a,M.b,$.a,M.c,A.a,l.o,u.E,u.q,u.j,N.a,d.a,u.b,u.p,u.h,b.k,u.a,b.i,pe.a,bn.a,u.v,u.A,b.A,l.n,U.a,u.u,u.D],pipes:[l.b,g.d,p.a],styles:[""],changeDetection:0});const On=function(){return["./create"]};function Qn(e,t){1&e&&(s.hc(0,"a",3),s.cc(1,"clr-icon",4),s.Vc(2),s.sc(3,"translate"),s.gc()),2&e&&(s.yc("routerLink",s.Bc(4,On)),s.Qb(2),s.Xc(" ",s.tc(3,2,"settings.create-new-tax-rate")," "))}const kn=function(e){return["./",e]},Fn=function(){return["DeleteSettings","DeleteTaxRate"]};function Sn(e,t){if(1&e){const e=s.ic();s.hc(0,"td",5),s.Vc(1),s.gc(),s.hc(2,"td",5),s.Vc(3),s.gc(),s.hc(4,"td",5),s.Vc(5),s.gc(),s.hc(6,"td",5),s.Vc(7),s.gc(),s.hc(8,"td",6),s.cc(9,"vdr-table-row-action",7),s.sc(10,"translate"),s.gc(),s.hc(11,"td",6),s.hc(12,"vdr-dropdown"),s.hc(13,"button",8),s.Vc(14),s.sc(15,"translate"),s.cc(16,"clr-icon",9),s.gc(),s.hc(17,"vdr-dropdown-menu",10),s.hc(18,"button",11),s.pc("click",function(){s.Lc(e);const c=t.item;return s.rc().deleteTaxRate(c)}),s.sc(19,"hasPermission"),s.cc(20,"clr-icon",12),s.Vc(21),s.sc(22,"translate"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.item;s.Qb(1),s.Wc(e.name),s.Qb(2),s.Wc(e.category.name),s.Qb(2),s.Wc(e.zone.name),s.Qb(2),s.Xc("",e.value,"%"),s.Qb(2),s.yc("label",s.tc(10,9,"common.edit"))("linkTo",s.Cc(17,kn,e.id)),s.Qb(5),s.Xc(" ",s.tc(15,11,"common.actions")," "),s.Qb(4),s.yc("disabled",!s.tc(19,13,s.Bc(19,Fn))),s.Qb(3),s.Xc(" ",s.tc(22,15,"common.delete")," ")}}const In=function(){return["CreateSettings","CreateTaxRate"]};class Tn extends n.n{constructor(e,t,c,n,i){super(n,i),this.modalService=e,this.notificationService=t,this.dataService=c,super.setQueryFn((...e)=>this.dataService.settings.getTaxRates(...e),e=>e.taxRates)}deleteTaxRate(e){return this.modalService.dialog({title:Object(j.a)("settings.confirm-delete-tax-rate"),body:e.name,buttons:[{type:"secondary",label:Object(j.a)("common.cancel")},{type:"danger",label:Object(j.a)("common.delete"),returnValue:!0}]}).pipe(Object(se.a)(t=>t?this.dataService.settings.deleteTaxRate(e.id):ie.a),Object(i.a)(e=>e.deleteTaxRate)).subscribe(e=>{e.result===n.t.DELETED?(this.notificationService.success(Object(j.a)("common.notify-delete-success"),{entity:"TaxRate"}),this.refresh()):this.notificationService.error(e.message||Object(j.a)("common.notify-delete-error"),{entity:"TaxRate"})},e=>{this.notificationService.error(Object(j.a)("common.notify-delete-error"),{entity:"TaxRate"})})}}function Pn(e,t){1&e&&(s.hc(0,"span"),s.Vc(1),s.sc(2,"translate"),s.gc()),2&e&&(s.Qb(1),s.Wc(s.tc(2,1,"settings.update-zone")))}function Dn(e,t){1&e&&(s.hc(0,"span"),s.Vc(1),s.sc(2,"translate"),s.gc()),2&e&&(s.Qb(1),s.Wc(s.tc(2,1,"settings.create-zone")))}function jn(e,t){if(1&e&&(s.Tc(0,Pn,3,3,"span",4),s.Tc(1,Dn,3,3,"span",4)),2&e){const e=s.rc();s.yc("ngIf",e.zone.id),s.Qb(1),s.yc("ngIf",!e.zone.id)}}function Vn(e,t){1&e&&(s.hc(0,"span"),s.Vc(1),s.sc(2,"translate"),s.gc()),2&e&&(s.Qb(1),s.Wc(s.tc(2,1,"settings.update-zone")))}function wn(e,t){1&e&&(s.hc(0,"span"),s.Vc(1),s.sc(2,"translate"),s.gc()),2&e&&(s.Qb(1),s.Wc(s.tc(2,1,"settings.create-zone")))}function xn(e,t){if(1&e){const e=s.ic();s.hc(0,"button",5),s.pc("click",function(){s.Lc(e);return s.rc().cancel()}),s.Vc(1),s.sc(2,"translate"),s.gc(),s.hc(3,"button",6),s.pc("click",function(){s.Lc(e);return s.rc().save()}),s.Tc(4,Vn,3,3,"span",4),s.Tc(5,wn,3,3,"span",4),s.gc()}if(2&e){const e=s.rc();s.Qb(1),s.Wc(s.tc(2,4,"common.cancel")),s.Qb(2),s.yc("disabled",!e.zone.name),s.Qb(1),s.yc("ngIf",e.zone.id),s.Qb(1),s.yc("ngIf",!e.zone.id)}}Tn.\u0275fac=function(e){return new(e||Tn)(s.bc(n.F),s.bc(n.G),s.bc(n.s),s.bc(L.e),s.bc(L.a))},Tn.\u0275cmp=s.Vb({type:Tn,selectors:[["vdr-tax-rate-list"]],features:[s.Nb],decls:24,vars:26,consts:[["locationId","tax-rate-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.hc(1,"vdr-ab-right"),s.cc(2,"vdr-action-bar-items",0),s.Tc(3,Qn,4,5,"a",1),s.gc(),s.gc(),s.hc(4,"vdr-data-table",2),s.pc("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),s.sc(5,"async"),s.sc(6,"async"),s.sc(7,"async"),s.sc(8,"async"),s.hc(9,"vdr-dt-column"),s.Vc(10),s.sc(11,"translate"),s.gc(),s.hc(12,"vdr-dt-column"),s.Vc(13),s.sc(14,"translate"),s.gc(),s.hc(15,"vdr-dt-column"),s.Vc(16),s.sc(17,"translate"),s.gc(),s.hc(18,"vdr-dt-column"),s.Vc(19),s.sc(20,"translate"),s.gc(),s.cc(21,"vdr-dt-column"),s.cc(22,"vdr-dt-column"),s.Tc(23,Sn,23,20,"ng-template"),s.gc()),2&e&&(s.Qb(3),s.yc("vdrIfPermissions",s.Bc(25,In)),s.Qb(1),s.yc("items",s.tc(5,9,t.items$))("itemsPerPage",s.tc(6,11,t.itemsPerPage$))("totalItems",s.tc(7,13,t.totalItems$))("currentPage",s.tc(8,15,t.currentPage$)),s.Qb(6),s.Wc(s.tc(11,17,"common.name")),s.Qb(3),s.Wc(s.tc(14,19,"settings.tax-category")),s.Qb(3),s.Wc(s.tc(17,21,"settings.zone")),s.Qb(3),s.Wc(s.tc(20,23,"settings.tax-rate")))},directives:[M.a,M.c,A.a,U.a,m.a,h.a,L.h,b.o,re.a,ae.a,oe.a,le.a,de.a],pipes:[l.b,g.d,p.a],styles:[""],changeDetection:0});const Ln=function(){return["UpdateSettings","UpdateZone"]};class Mn{cancel(){this.resolveWith()}save(){this.resolveWith(this.zone.name)}}Mn.\u0275fac=function(e){return new(e||Mn)},Mn.\u0275cmp=s.Vb({type:Mn,selectors:[["vdr-zone-detail-dialog"]],decls:6,vars:8,consts:[["vdrDialogTitle",""],["for","name",3,"label"],["id","name","type","text",3,"ngModel","readonly","ngModelChange"],["vdrDialogButtons",""],[4,"ngIf"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Tc(0,jn,2,2,"ng-template",0),s.hc(1,"vdr-form-field",1),s.sc(2,"translate"),s.hc(3,"input",2),s.pc("ngModelChange",function(e){return t.zone.name=e}),s.sc(4,"hasPermission"),s.gc(),s.gc(),s.Tc(5,xn,6,6,"ng-template",3)),2&e&&(s.Qb(1),s.yc("label",s.tc(2,3,"common.name")),s.Qb(2),s.yc("ngModel",t.zone.name)("readonly",!s.tc(4,5,s.Bc(7,Ln))))},directives:[r.a,N.a,d.a,u.b,u.p,u.s,S.a,l.o],pipes:[g.d,p.a],styles:[""],changeDetection:0});var $n=c("/uUt"),An=c("CqXF");function Nn(e,t){if(1&e){const e=s.ic();s.hc(0,"button",7),s.pc("click",function(){s.Lc(e);return s.rc().create()}),s.cc(1,"clr-icon",8),s.Vc(2),s.sc(3,"translate"),s.gc()}2&e&&(s.Qb(2),s.Xc(" ",s.tc(3,1,"settings.create-new-zone")," "))}const Rn=function(e){return{contents:e}},zn=function(e){return["./",e]},Wn=function(){return["DeleteSettings","DeleteZone"]};function Xn(e,t){if(1&e){const e=s.ic();s.hc(0,"tr"),s.sc(1,"async"),s.hc(2,"td",9),s.cc(3,"vdr-entity-info",10),s.gc(),s.hc(4,"td",9),s.hc(5,"vdr-chip",11),s.Vc(6),s.gc(),s.gc(),s.hc(7,"td",12),s.hc(8,"a",13),s.cc(9,"clr-icon",14),s.Vc(10),s.sc(11,"translate"),s.gc(),s.gc(),s.hc(12,"td",15),s.hc(13,"button",16),s.pc("click",function(){s.Lc(e);const c=t.$implicit;return s.rc().update(c)}),s.cc(14,"clr-icon",17),s.Vc(15),s.sc(16,"translate"),s.gc(),s.gc(),s.hc(17,"td",15),s.hc(18,"vdr-dropdown"),s.hc(19,"button",18),s.Vc(20),s.sc(21,"translate"),s.cc(22,"clr-icon",19),s.gc(),s.hc(23,"vdr-dropdown-menu",20),s.hc(24,"button",21),s.pc("click",function(){s.Lc(e);const c=t.$implicit;return s.rc().delete(c.id)}),s.sc(25,"hasPermission"),s.cc(26,"clr-icon",22),s.Vc(27),s.sc(28,"translate"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.$implicit,c=s.rc();let n=null;s.Tb("active",e.id===(null==(n=s.tc(1,11,c.activeZone$))?null:n.id)),s.Qb(3),s.yc("entity",e),s.Qb(2),s.yc("colorFrom",e.name),s.Qb(1),s.Wc(e.name),s.Qb(2),s.yc("routerLink",s.Cc(25,zn,s.Cc(23,Rn,e.id))),s.Qb(2),s.Xc(" ",s.tc(11,13,"settings.view-zone-members")," "),s.Qb(5),s.Xc(" ",s.tc(16,15,"common.edit")," "),s.Qb(5),s.Xc(" ",s.tc(21,17,"common.actions")," "),s.Qb(4),s.yc("disabled",!s.tc(25,19,s.Bc(27,Wn))),s.Qb(3),s.Xc(" ",s.tc(28,21,"common.delete")," ")}}const Gn=function(){return["UpdateSettings","UpdateZone"]},En=function(e){return{zoneName:e}};function Un(e,t){if(1&e){const e=s.ic();s.hc(0,"div"),s.hc(1,"div",26),s.hc(2,"div",27),s.Vc(3),s.gc(),s.cc(4,"div",28),s.hc(5,"button",29),s.pc("click",function(){s.Lc(e);return s.rc(2).closeMembers()}),s.cc(6,"clr-icon",30),s.gc(),s.gc(),s.hc(7,"div",31),s.hc(8,"vdr-dropdown"),s.hc(9,"button",32),s.Vc(10),s.sc(11,"translate"),s.cc(12,"clr-icon",19),s.gc(),s.hc(13,"vdr-dropdown-menu",20),s.hc(14,"button",33),s.pc("click",function(){s.Lc(e);const t=s.rc().ngIf,c=s.rc();return c.removeFromZone(t,c.selectedMemberIds)}),s.sc(15,"hasPermission"),s.cc(16,"clr-icon",22),s.Vc(17),s.sc(18,"translate"),s.gc(),s.gc(),s.gc(),s.hc(19,"button",34),s.pc("click",function(){s.Lc(e);const t=s.rc().ngIf;return s.rc().addToZone(t)}),s.Vc(20),s.sc(21,"translate"),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.rc().ngIf,t=s.rc();s.Qb(3),s.Yc(" ",e.name," (",e.members.length,") "),s.Qb(6),s.yc("disabled",0===t.selectedMemberIds.length),s.Qb(1),s.Xc(" ",s.tc(11,7,"common.with-selected")," "),s.Qb(4),s.yc("disabled",!s.tc(15,9,s.Bc(16,Gn))),s.Qb(3),s.Xc(" ",s.tc(18,11,"settings.remove-from-zone")," "),s.Qb(3),s.Xc(" ",s.uc(21,13,"settings.add-countries-to-zone",s.Cc(17,En,e.name))," ")}}const _n=function(e){return["/settings","countries",e]};function Zn(e,t){if(1&e){const e=s.ic();s.hc(0,"div"),s.hc(1,"vdr-dropdown"),s.hc(2,"button",18),s.Vc(3),s.sc(4,"translate"),s.cc(5,"clr-icon",19),s.gc(),s.hc(6,"vdr-dropdown-menu",20),s.hc(7,"a",35),s.cc(8,"clr-icon",17),s.Vc(9),s.sc(10,"translate"),s.gc(),s.hc(11,"button",33),s.pc("click",function(){s.Lc(e);const c=t.member,n=s.rc().ngIf;return s.rc().removeFromZone(n,[c.id])}),s.sc(12,"hasPermission"),s.cc(13,"clr-icon",22),s.Vc(14),s.sc(15,"translate"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.member;s.Qb(3),s.Xc(" ",s.tc(4,5,"common.actions")," "),s.Qb(4),s.yc("routerLink",s.Cc(13,_n,e.id)),s.Qb(2),s.Xc(" ",s.tc(10,7,"common.edit")," "),s.Qb(2),s.yc("disabled",!s.tc(12,9,s.Bc(15,Gn))),s.Qb(3),s.Xc(" ",s.tc(15,11,"settings.remove-from-zone")," ")}}function Bn(e,t){if(1&e){const e=s.ic();s.fc(0),s.hc(1,"vdr-zone-member-list",23),s.pc("selectionChange",function(t){s.Lc(e);return s.rc().selectedMemberIds=t}),s.Tc(2,Un,22,19,"div",24),s.Tc(3,Zn,16,16,"div",25),s.gc(),s.ec()}if(2&e){const e=t.ngIf,c=s.rc();s.Qb(1),s.yc("members",e.members)("selectedMemberIds",c.selectedMemberIds)}}const qn=function(){return["CreateSettings","CreateZone"]};class Hn{constructor(e,t,c,n,i){this.dataService=e,this.notificationService=t,this.modalService=c,this.route=n,this.router=i,this.selectedMemberIds=[]}ngOnInit(){this.zones$=this.dataService.settings.getZones().mapStream(e=>e.zones);const e=this.route.paramMap.pipe(Object(i.a)(e=>e.get("contents")),Object($n.a)(),Object(Ze.a)(()=>this.selectedMemberIds=[]));this.activeZone$=Object(We.a)(this.zones$,e).pipe(Object(i.a)(([e,t])=>{if(t)return e.find(e=>e.id===t)}))}create(){this.modalService.fromComponent(Mn,{locals:{zone:{name:""}}}).pipe(Object(se.a)(e=>e?this.dataService.settings.createZone({name:e,memberIds:[]}):ie.a),Object(se.a)(()=>this.dataService.settings.getZones().single$)).subscribe(()=>{this.notificationService.success(Object(j.a)("common.notify-create-success"),{entity:"Zone"})},e=>{this.notificationService.error(Object(j.a)("common.notify-create-error"),{entity:"Zone"})})}delete(e){this.modalService.dialog({title:Object(j.a)("catalog.confirm-delete-zone"),buttons:[{type:"secondary",label:Object(j.a)("common.cancel")},{type:"danger",label:Object(j.a)("common.delete"),returnValue:!0}]}).pipe(Object(se.a)(t=>t?this.dataService.settings.deleteZone(e):ie.a),Object(se.a)(e=>e.deleteZone.result===n.t.DELETED?this.dataService.settings.getZones().mapSingle(()=>({errorMessage:!1})):Object(mc.a)({errorMessage:e.deleteZone.message}))).subscribe(e=>{"string"==typeof e.errorMessage?this.notificationService.error(e.errorMessage):this.notificationService.success(Object(j.a)("common.notify-delete-success"),{entity:"Zone"})},e=>{this.notificationService.error(Object(j.a)("common.notify-delete-error"),{entity:"Zone"})})}update(e){this.modalService.fromComponent(Mn,{locals:{zone:e}}).pipe(Object(se.a)(t=>t?this.dataService.settings.updateZone({id:e.id,name:t}):ie.a)).subscribe(()=>{this.notificationService.success(Object(j.a)("common.notify-update-success"),{entity:"Zone"})},e=>{this.notificationService.error(Object(j.a)("common.notify-update-error"),{entity:"Zone"})})}closeMembers(){const e=Object.assign({},this.route.snapshot.params);delete e.contents,this.router.navigate(["./",e],{relativeTo:this.route,queryParamsHandling:"preserve"})}addToZone(e){this.modalService.fromComponent(D,{locals:{zoneName:e.name,currentMembers:e.members},size:"md"}).pipe(Object(se.a)(t=>t?this.dataService.settings.addMembersToZone(e.id,t).pipe(Object(An.a)(t)):ie.a)).subscribe({next:t=>{this.notificationService.success(Object(j.a)("settings.add-countries-to-zone-success"),{countryCount:t.length,zoneName:e.name})},error:e=>{this.notificationService.error(e)}})}removeFromZone(e,t){this.dataService.settings.removeMembersFromZone(e.id,t).subscribe({complete:()=>{this.notificationService.success(Object(j.a)("settings.remove-countries-from-zone-success"),{countryCount:t.length,zoneName:e.name})}})}}Hn.\u0275fac=function(e){return new(e||Hn)(s.bc(n.s),s.bc(n.G),s.bc(n.F),s.bc(L.a),s.bc(L.e))},Hn.\u0275cmp=s.Vb({type:Hn,selectors:[["vdr-zone-list"]],decls:14,vars:12,consts:[["locationId","zone-list"],["class","btn btn-primary",3,"click",4,"vdrIfPermissions"],[1,"zone-wrapper"],[1,"table","zone-list"],[3,"active",4,"ngFor","ngForOf"],[1,"zone-members"],[4,"ngIf"],[1,"btn","btn-primary",3,"click"],["shape","plus"],[1,"left","align-middle"],[3,"entity"],[3,"colorFrom"],[1,"text-right","align-middle"],["queryParamsHandling","preserve",1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","view-list"],[1,"align-middle"],[1,"btn","btn-link","btn-sm",3,"click"],["shape","edit"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"members","selectedMemberIds","selectionChange"],[4,"vdrZoneMemberListHeader"],[4,"vdrZoneMemberControls"],[1,"flex"],[1,"header-title-row"],[1,"flex-spacer"],["type","button",1,"close-button",3,"click"],["shape","close"],[1,"controls"],["type","button","vdrDropdownTrigger","",1,"btn","btn-secondary","btn-sm",3,"disabled"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],[1,"btn","btn-secondary","btn-sm",3,"click"],["type","button","vdrDropdownItem","",3,"routerLink"]],template:function(e,t){1&e&&(s.hc(0,"vdr-action-bar"),s.cc(1,"vdr-ab-left"),s.hc(2,"vdr-ab-right"),s.cc(3,"vdr-action-bar-items",0),s.Tc(4,Nn,4,3,"button",1),s.gc(),s.gc(),s.hc(5,"div",2),s.hc(6,"table",3),s.hc(7,"tbody"),s.Tc(8,Xn,29,28,"tr",4),s.sc(9,"async"),s.gc(),s.gc(),s.hc(10,"div",5),s.sc(11,"async"),s.Tc(12,Bn,4,2,"ng-container",6),s.sc(13,"async"),s.gc(),s.gc()),2&e&&(s.Qb(4),s.yc("vdrIfPermissions",s.Bc(11,qn)),s.Qb(4),s.yc("ngForOf",s.tc(9,5,t.zones$)),s.Qb(2),s.Tb("expanded",s.tc(11,7,t.activeZone$)),s.Qb(2),s.yc("ngIf",s.tc(13,9,t.activeZone$)))},directives:[M.a,M.b,M.c,A.a,U.a,l.n,l.o,b.o,$.a,Be.a,L.h,ae.a,oe.a,le.a,de.a,F,o,a],pipes:[l.b,g.d,p.a],styles:[".zone-wrapper[_ngcontent-%COMP%]{display:flex;height:calc(100% - 50px)}.zone-wrapper[_ngcontent-%COMP%]   .zone-list[_ngcontent-%COMP%]{flex:1;overflow:auto;margin-top:0}.zone-wrapper[_ngcontent-%COMP%]   .zone-list[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.zone-members[_ngcontent-%COMP%]{height:100%;width:0;opacity:0;visibility:hidden;overflow:auto;transition:width .3s,opacity .2s .3s,visibility 0s .3s}.zone-members.expanded[_ngcontent-%COMP%]{width:40vw;visibility:visible;opacity:1;padding-left:12px}.zone-members[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{margin:0;background:none;border:none;cursor:pointer}.zone-members[_ngcontent-%COMP%]     table.table{margin-top:0}.zone-members[_ngcontent-%COMP%]     table.table th{top:0}.zone-members[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"],changeDetection:0});class Kn extends n.m{constructor(e,t){super(e,{__typename:"Administrator",id:"",createdAt:"",updatedAt:"",emailAddress:"",firstName:"",lastName:"",user:{roles:[]}},e=>t.administrator.getAdministrator(e).mapStream(e=>e.administrator))}}Kn.\u0275fac=function(e){return new(e||Kn)(s.lc(L.e),s.lc(n.s))},Kn.\u0275prov=s.Xb({token:Kn,factory:Kn.\u0275fac,providedIn:"root"});class Yn extends n.m{constructor(e,t){super(e,{__typename:"Channel",id:"",createdAt:"",updatedAt:"",code:"",token:"",pricesIncludeTax:!1,currencyCode:n.q.USD,defaultLanguageCode:Object(n.X)(),defaultShippingZone:{},defaultTaxZone:{}},e=>t.settings.getChannel(e).mapStream(e=>e.channel))}}Yn.\u0275fac=function(e){return new(e||Yn)(s.lc(L.e),s.lc(n.s))},Yn.\u0275prov=s.Xb({token:Yn,factory:Yn.\u0275fac,providedIn:"root"});class Jn extends n.m{constructor(e,t){super(e,{__typename:"Country",id:"",createdAt:"",updatedAt:"",code:"",name:"",enabled:!1,translations:[]},e=>t.settings.getCountry(e).mapStream(e=>e.country))}}Jn.\u0275fac=function(e){return new(e||Jn)(s.lc(L.e),s.lc(n.s))},Jn.\u0275prov=s.Xb({token:Jn,factory:Jn.\u0275fac,providedIn:"root"});class ei extends n.m{constructor(e,t){super(e,{},()=>t.settings.getGlobalSettings().mapStream(e=>e.globalSettings))}}ei.\u0275fac=function(e){return new(e||ei)(s.lc(L.e),s.lc(n.s))},ei.\u0275prov=s.Xb({token:ei,factory:ei.\u0275fac,providedIn:"root"});class ti extends n.m{constructor(e,t){super(e,{__typename:"PaymentMethod",id:"",createdAt:"",updatedAt:"",name:"",code:"",description:"",enabled:!0,checker:void 0,handler:void 0},e=>t.settings.getPaymentMethod(e).mapStream(e=>e.paymentMethod))}}ti.\u0275fac=function(e){return new(e||ti)(s.lc(L.e),s.lc(n.s))},ti.\u0275prov=s.Xb({token:ti,factory:ti.\u0275fac,providedIn:"root"});class ci extends n.m{constructor(e,t){super(e,{__typename:"Administrator",id:"",createdAt:"",updatedAt:"",emailAddress:"",firstName:"",lastName:"",user:{roles:[]}},e=>t.administrator.getActiveAdministrator().mapStream(e=>e.activeAdministrator))}}ci.\u0275fac=function(e){return new(e||ci)(s.lc(L.e),s.lc(n.s))},ci.\u0275prov=s.Xb({token:ci,factory:ci.\u0275fac,providedIn:"root"});class ni extends n.m{constructor(e,t){super(e,{__typename:"Role",id:"",createdAt:"",updatedAt:"",code:"",description:"",permissions:[],channels:[]},e=>t.administrator.getRole(e).mapStream(e=>e.role))}}ni.\u0275fac=function(e){return new(e||ni)(s.lc(L.e),s.lc(n.s))},ni.\u0275prov=s.Xb({token:ni,factory:ni.\u0275fac,providedIn:"root"});class ii extends n.m{constructor(e,t){super(e,{__typename:"ShippingMethod",createdAt:"",updatedAt:"",id:"",code:"",name:"",description:"",fulfillmentHandlerCode:void 0,checker:void 0,calculator:void 0,translations:[]},e=>t.shippingMethod.getShippingMethod(e).mapStream(e=>e.shippingMethod))}}ii.\u0275fac=function(e){return new(e||ii)(s.lc(L.e),s.lc(n.s))},ii.\u0275prov=s.Xb({token:ii,factory:ii.\u0275fac,providedIn:"root"});class si extends n.m{constructor(e,t){super(e,{__typename:"TaxCategory",id:"",createdAt:"",updatedAt:"",name:"",isDefault:!1},e=>t.settings.getTaxCategory(e).mapStream(e=>e.taxCategory))}}si.\u0275fac=function(e){return new(e||si)(s.lc(L.e),s.lc(n.s))},si.\u0275prov=s.Xb({token:si,factory:si.\u0275fac,providedIn:"root"});class ri extends n.m{constructor(e,t){super(e,{__typename:"TaxRate",id:"",createdAt:"",updatedAt:"",name:"",value:0,enabled:!0,category:{},zone:{},customerGroup:null},e=>t.settings.getTaxRate(e).mapStream(e=>e.taxRate))}}ri.\u0275fac=function(e){return new(e||ri)(s.lc(L.e),s.lc(n.s))},ri.\u0275prov=s.Xb({token:ri,factory:ri.\u0275fac,providedIn:"root"});const ai=[{path:"profile",component:At,resolve:Object(n.O)(ci),canDeactivate:[n.o],data:{breadcrumb:Object(j.a)("breadcrumb.profile")}},{path:"administrators",component:ge,data:{breadcrumb:Object(j.a)("breadcrumb.administrators")}},{path:"administrators/:id",component:ne,resolve:Object(n.O)(Kn),canDeactivate:[n.o],data:{breadcrumb:oi}},{path:"channels",component:ze,data:{breadcrumb:Object(j.a)("breadcrumb.channels")}},{path:"channels/:id",component:Ve,resolve:Object(n.O)(Yn),canDeactivate:[n.o],data:{breadcrumb:li}},{path:"roles",component:ic,data:{breadcrumb:Object(j.a)("breadcrumb.roles")}},{path:"roles/:id",component:Gt,resolve:Object(n.O)(ni),canDeactivate:[n.o],data:{breadcrumb:di}},{path:"tax-categories",component:hn,data:{breadcrumb:Object(j.a)("breadcrumb.tax-categories")}},{path:"tax-categories/:id",component:sn,resolve:Object(n.O)(si),canDeactivate:[n.o],data:{breadcrumb:ui}},{path:"tax-rates",component:Tn,data:{breadcrumb:Object(j.a)("breadcrumb.tax-rates")}},{path:"tax-rates/:id",component:Cn,resolve:Object(n.O)(ri),canDeactivate:[n.o],data:{breadcrumb:mi}},{path:"countries",component:it,data:{breadcrumb:Object(j.a)("breadcrumb.countries")}},{path:"countries/:id",component:_e,resolve:Object(n.O)(Jn),canDeactivate:[n.o],data:{breadcrumb:hi}},{path:"zones",component:Hn,data:{breadcrumb:Object(j.a)("breadcrumb.zones")}},{path:"shipping-methods",component:en,data:{breadcrumb:Object(j.a)("breadcrumb.shipping-methods")}},{path:"shipping-methods/:id",component:_c,resolve:Object(n.O)(ii),canDeactivate:[n.o],data:{breadcrumb:bi}},{path:"payment-methods",component:wt,data:{breadcrumb:Object(j.a)("breadcrumb.payment-methods")}},{path:"payment-methods/:id",component:St,resolve:Object(n.O)(ti),canDeactivate:[n.o],data:{breadcrumb:gi}},{path:"global-settings",component:ut,resolve:Object(n.O)(ei),canDeactivate:[n.o],data:{breadcrumb:Object(j.a)("breadcrumb.global-settings")}}];function oi(e,t){return Object(n.Q)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.administrators",getName:e=>`${e.firstName} ${e.lastName}`,route:"administrators"})}function li(e,t){return Object(n.Q)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.channels",getName:e=>e.code,route:"channels"})}function di(e,t){return Object(n.Q)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.roles",getName:e=>e.description,route:"roles"})}function ui(e,t){return Object(n.Q)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.tax-categories",getName:e=>e.name,route:"tax-categories"})}function mi(e,t){return Object(n.Q)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.tax-rates",getName:e=>e.name,route:"tax-rates"})}function hi(e,t){return Object(n.Q)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.countries",getName:e=>e.name,route:"countries"})}function bi(e,t){return Object(n.Q)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.shipping-methods",getName:e=>e.name,route:"shipping-methods"})}function gi(e,t){return Object(n.Q)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.payment-methods",getName:e=>e.code,route:"payment-methods"})}class pi{}pi.\u0275fac=function(e){return new(e||pi)},pi.\u0275mod=s.Zb({type:pi}),pi.\u0275inj=s.Yb({imports:[[n.J,L.i.forChild(ai)]]})}}]);
//# sourceMappingURL=12-es2015.efe3d5dbaaf38fe5ec6c.js.map